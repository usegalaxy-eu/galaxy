define(["exports"],function(t){"use strict";function s(){$("#spinner").remove(),$("#main").children().remove()}function c(){$("#main").append('<div id="ie-loading-spinner"></div>')}function i(t,e,n,i,o,a,r,s){return{type:void 0!==t?t:"GIE spin",ajax_timeout:void 0!==e?e:2e3,ajax_timeout_max:void 0!==n?n:16e3,ajax_timeout_step:void 0!==i?i:500,sleep:void 0!==o?o:500,sleep_max:void 0!==a?a:8e3,sleep_step:void 0!==r?r:100,log_attempts:void 0===s||s,count:0}}function u(t,e,n){console.log(t),n&&s(),"string"==typeof e&&(toastr.clear(),toastr.error(e,"Error",{closeButton:!0,timeOut:0,extendedTimeOut:0,tapToDismiss:!1}))}function l(t){t.sleep<t.sleep_max&&(t.sleep+=t.sleep_step),t.log_attempts&&console.log("".concat(t.type," request ").concat(t.count," request timeout ").concat(t.ajax_timeout,"ms sleeping ").concat(t.sleep/1e3,"s")),window.setTimeout(t.spinner,t.sleep)}function m(e,n,i,o,a,r){var t=function(){var t={url:e,xhrFields:{withCredentials:!0},type:"GET",timeout:r.ajax_timeout,success:function(t,e,n){i(t,e,n)||(r.count++,l(r))},error:function(t,e,n){"timeout"==e?(r.ajax_timeout<r.ajax_timeout_max&&(r.ajax_timeout+=r.ajax_timeout_step),r.count++,o(t,e,n)||l(r)):(r.count++,a(t,e,n)||l(r))}};n&&(t.dataType="json"),$.ajax(t)};console.log("Setting up new spinner for ".concat(r.type," on ").concat(e)),r.spinner=t,window.setTimeout(t,r.sleep)}function o(t,e,i,n,o){var a=function(t,e){1==e.count&&(c(),toastr.info(t,null,{closeButton:!0,timeOut:0,extendedTimeOut:0,tapToDismiss:!1}))},r=function(t,e,n){return a(i.waiting,o),40==o.count&&toastr.warning(i.wait_warn,"Warning",{closeButton:!0,timeOut:0,extendedTimeOut:0,tapToDismiss:!1}),!1};m(t,e,function(t){if(!e||e&&1==t)console.log(i.success),s(),toastr.clear(),n();else{if(e&&0==t)return a(i.not_ready,o),!1;u("Invalid response to ".concat(o.type," request"),i.invalid_response,!0)}return!0},r,r,o)}Object.defineProperty(t,"__esModule",{value:!0}),t.append_notebook=function(t){s(),$("#main").append('<iframe frameBorder="0" seamless="seamless" style="width: 100%; height: 100%; overflow:hidden;" scrolling="no" src="'.concat(t,'"></iframe>'))},t.clear_main_area=s,t.display_spinner=c,t.make_spin_state=i,t.spin_error=u,t.spin=m,t.test_ie_availability=function(t,e){var n=i("IE availability");o(t,!1,{success:"IE connection succeeded, returning",waiting:"Interactive environment container is running, attempting to connect to the IE. Please wait...",wait_warn:"It is taking an usually long time to connect to the interactive environment. Attempts will continue but you may want to report this condition to a Galaxy administrator if it does not succeed soon.",error:"An error was encountered while attempting to connect to the interactive environment, contact your administrator."},e,n)},t.load_when_ready=function(t,e){var n=i("IE container readiness");o(t,!0,{success:"Galaxy reports IE container ready, returning",not_ready:"Galaxy is launching a container in which to run this interactive environment. Please wait...",unknown_response:"Galaxy failed to launch a container in which to run this interactive environment, contact a Galaxy administrator.",waiting:"Galaxy is launching a container in which to run this interactive environment. Please wait...",wait_warn:"It is taking an usually long time to start a container. Attempts will continue but you may want to report this condition to a Galaxy administrator if it does not succeed soon.",error:"Galaxy encountered an error while attempting to determine the readiness of this interactive environment's container, contact a Galaxy administrator."},e,n)}});
define(["exports","utils/utils","mvc/ui/ui-misc"],function(t,i,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=l(i),n=l(e);function l(t){return t&&t.__esModule?t:{default:t}}var a=Backbone.View.extend({initialize:function(t){var i=this;this.options=t,this.name=t.name||"element",this.multiple=t.multiple||!1,this.message=new n.default.Message({cls:"col mb-0"}),this.selections=$("<div/>"),this.select=new n.default.Select.View({optional:t.optional}),this.$button=$('<button class="fa fa-sign-in"/>'),this.$button.on("click",function(){i.add({id:i.select.value(),name:i.select.text()})}),this.setElement(this._template(t)),this.$(".ui-list-message").append(this.message.$el),this.$(".ui-list-selections").append(this.selections),this.$(".ui-list-button").append(this.$button),this.$(".ui-list-select").append(this.select.$el)},value:function(t){if(void 0!==t){if(this.selections.empty(),$.isArray(t))for(var i in t){var e=t[i],s=null,n=null;"string"!=$.type(e)?(s=e.id,n=e.name):s=n=e,null!=s&&this.add({id:s,name:n})}this._refresh()}var l=[];return this.$(".ui-list-id").each(function(){l.push({id:$(this).prop("id"),name:$(this).find(".ui-list-name").html()})}),0==l.length?null:l},add:function(t){var i=this;if(0===this.$('[id="'.concat(t.id,'"]')).length)if(s.default.isEmpty(t.id))this.message.update({message:"Please select a valid ".concat(this.name,"."),status:"danger"});else{var e=$(this._templateRow({id:t.id,name:t.name}));e.find("button").on("click",function(){e.remove(),i._refresh()}),this.selections.append(e),this._refresh()}else this.message.update({message:"This ".concat(this.name," is already in the list.")})},update:function(t){this.select.update(t)},_refresh:function(){0<this.$(".ui-list-id").length?!this.multiple&&this.$button.attr("disabled",!0):this.$button.attr("disabled",!1),this.options.onchange&&this.options.onchange()},_template:function(t){return'<div class="ui-list container">\n                    <div class="row">\n                        <div class="col-1 pl-0 mb-2">\n                            <div class="ui-list-button"/>\n                        </div>\n                        <div class="ui-list-select col pr-0"/>\n                    </div>\n                    <div class="ui-list-message mt-2 row"/>\n                    <div class="ui-list-selections mt-2"/>\n                </div>'},_templateRow:function(t){return'<div id="'.concat(t.id,'" class="ui-list-id row mt-2">\n                    <button class="ui-list-delete fa fa-trash mr-3"/>\n                    <div class="ui-list-name">').concat(t.name,"</span>\n                </div>")}});t.default={View:a}});
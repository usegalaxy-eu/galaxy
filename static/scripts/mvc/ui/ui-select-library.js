define(["exports","backbone","mvc/ui/ui-misc","mvc/ui/ui-list","onload/loadConfig"],function(e,t,i,a,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var l=o(t),s=o(i),r=o(a);function o(e){return e&&e.__esModule?e:{default:e}}var c=l.default.Collection.extend({url:"".concat((0,n.getAppRoot)(),"api/libraries?deleted=false")}),u=l.default.Collection.extend({initialize:function(){var e=this;this.config=new l.default.Model({library_id:null}),this.config.on("change",function(){e.fetch({reset:!0})})},url:function(){return"".concat((0,n.getAppRoot)(),"api/libraries/").concat(this.config.get("library_id"),"/contents")}}),d=l.default.View.extend({initialize:function(e){var i=this;this.libraries=new c,this.datasets=new u,this.options=e,this.library_select=new s.default.Select.View({onchange:function(e){i.datasets.config.set("library_id",e)}}),this.dataset_list=new r.default.View({name:"dataset",optional:e.optional,multiple:e.multiple,onchange:function(){i.trigger("change")}}),this.libraries.on("reset",function(){var t=[];i.libraries.each(function(e){t.push({value:e.id,label:e.get("name")})}),i.library_select.update({data:t})}),this.datasets.on("reset",function(){var t=[];null!==i.library_select.text()&&i.datasets.each(function(e){"file"===e.get("type")&&t.push({value:e.id,label:e.get("name")})}),i.dataset_list.update({data:t})}),this.on("change",function(){e.onchange&&e.onchange(i.value())}),this.setElement(this._template()),this.$(".library-select").append(this.library_select.$el),this.$el.append(this.dataset_list.$el),this.libraries.fetch({reset:!0,success:function(){i.library_select.trigger("change"),void 0!==i.options.value&&i.value(i.options.value)}})},value:function(e){return this.dataset_list.value(e)},_template:function(){return'<div class="ui-select-library">\n                    <div class="library-select mb-2"/>\n                </div>'}});e.default={View:d}});
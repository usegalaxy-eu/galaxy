define(["exports","jquery","backbone","mvc/ui/ui-portlet","mvc/ui/ui-misc","mvc/form/form-section","mvc/form/form-data","app"],function(t,e,i,s,n,a,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=p(e),h=p(i),u=p(s),c=p(n),d=p(a),f=p(r);function p(t){return t&&t.__esModule?t:{default:t}}t.default=h.default.View.extend({initialize:function(t){this.model=new h.default.Model({initial_errors:!1,cls:"ui-portlet",icon:null,always_refresh:!0,status:"warning",hide_operations:!1,onchange:function(){}}).set(t),this.setElement("<div/>"),this.render()},update:function(t){var s=this;this.data.matchModel(t,function(t,e){var i=s.field_list[e];i.update&&(i.update(t),i.trigger("change"),(0,o.getGalaxyInstance)().emit.debug("form-view::update()","Updating input: ".concat(e)))})},wait:function(t){for(var e in this.input_list){var i=this.field_list[e];this.input_list[e].is_dynamic&&i.wait&&i.unwait&&i[t?"wait":"unwait"]()}},highlight:function(t,e,i){var s=this.element_list[t];if(s&&(s.error(e||"Please verify this parameter."),this.portlet.expand(),this.trigger("expand",t),!i)){var n=this.$el.parents().filter(function(){return-1!=["auto","scroll"].indexOf((0,l.default)(this).css("overflow"))}).first();n.animate({scrollTop:n.scrollTop()+s.$el.offset().top-n.position().top-120},500)}},errors:function(t){if(this.trigger("reset"),t&&t.errors){var e=this.data.matchResponse(t.errors);for(var i in this.element_list)e[i]&&this.highlight(i,e[i],!0)}},render:function(){var s=this;this.off("change"),this.off("reset"),this.field_list={},this.input_list={},this.element_list={},this.data=new f.default.Manager(this),this._renderForm(),this.data.create(),this.model.get("initial_errors")&&this.errors(this.model.attributes);var n=this.data.checksum();return this.on("change",function(t){var e=s.input_list[t];if(!e||e.refresh_on_change||s.model.get("always_refresh")){var i=s.data.checksum();i!=n&&(n=i,s.model.get("onchange")())}}),this.on("reset",function(){_.each(s.element_list,function(t){t.reset()})}),this},_renderForm:function(){(0,l.default)(".tooltip").remove();var t=this.model.attributes;this.message=new c.default.UnescapedMessage,this.section=new d.default.View(this,{inputs:t.inputs}),this.portlet=new u.default.View({icon:t.icon,title:t.title,title_id:t.title_id,operations:!t.hide_operations&&t.operations,cls:t.cls,buttons:t.buttons,collapsible:t.collapsible,collapsed:t.collapsed,onchange_title:t.onchange_title}),this.portlet.append(this.message.$el),this.portlet.append(this.section.$el),this.$el.empty(),t.inputs&&this.$el.append(this.portlet.$el),t.message&&this.message.update({persistent:!0,status:t.status,message:t.message}),(0,o.getGalaxyInstance)().emit.debug("form-view::initialize()","Completed")}})});
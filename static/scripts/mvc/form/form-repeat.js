define(["exports","utils/localization","utils/utils","mvc/ui/ui-portlet","mvc/ui/ui-misc"],function(t,e,i,n,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.View=void 0;var o=u(e),s=u(i),a=u(n),d=u(l);function u(t){return t&&t.__esModule?t:{default:t}}var c=t.View=Backbone.View.extend({initialize:function(t){this.list={},this.options=s.default.merge(t,{title:(0,o.default)("Repeat"),empty_text:"Not available.",max:null,min:null}),this.button_new=new d.default.Button({icon:"fa-plus",title:"Insert ".concat(this.options.title),tooltip:"Add new ".concat(this.options.title," block"),cls:"btn btn-secondary float-none form-repeat-add",onclick:function(){t.onnew&&t.onnew()}}),this.setElement($("<div/>").append(this.$list=$("<div/>")).append($("<div/>").append(this.button_new.$el)))},size:function(){return _.size(this.list)},add:function(t){if(t.id&&!this.list[t.id]){var e=new d.default.Button({icon:"fa-trash-o",tooltip:(0,o.default)("Delete this repeat block"),cls:"ui-button-icon-plain form-repeat-delete",onclick:function(){t.ondel&&t.ondel()}}),i=new a.default.View({id:t.id,title:(0,o.default)("placeholder"),cls:t.cls||"ui-portlet-section",operations:{button_delete:e}});i.append(t.$el),i.$el.addClass("section-row").hide(),this.list[t.id]=i,this.$list.append(i.$el.fadeIn("fast")),0<this.options.max&&this.size()>=this.options.max&&this.button_new.disable(),this._refresh()}else Galaxy.emit.debug("form-repeat::add()","Duplicate or invalid repeat block id.")},del:function(t){this.list[t]?(this.$list.find("#".concat(t)).remove(),delete this.list[t],this.button_new.enable(),this._refresh()):Galaxy.emit.debug("form-repeat::del()","Invalid repeat block id.")},delAll:function(){for(var t in this.list)this.del(t)},hideOptions:function(){this.button_new.$el.hide(),_.each(this.list,function(t){t.hideOperation("button_delete")}),_.isEmpty(this.list)&&this.$el.append($("<div/>").addClass("form-text text-muted").html(this.options.empty_text))},_refresh:function(){var t=0;for(var e in this.list){var i=this.list[e];i.title("".concat(++t,": ").concat(this.options.title)),i[this.size()>this.options.min?"showOperation":"hideOperation"]("button_delete")}}});t.default={View:c}});
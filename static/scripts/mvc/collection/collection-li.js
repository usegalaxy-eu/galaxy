define(["exports","underscore","jquery","mvc/list/list-item","mvc/dataset/dataset-li","mvc/base-mvc","utils/localization"],function(e,t,i,l,a,s,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=m(t),d=m(i),c=m(s),r=m(o);function m(e){return e&&e.__esModule?e:{default:e}}var u,p,f,h=l.FoldoutListItemView.extend({className:"".concat(l.FoldoutListItemView.prototype.className," dataset-collection"),id:function(){return["dataset_collection",this.model.get("id")].join("-")},initialize:function(e){this.linkTarget=e.linkTarget||"_blank",this.hasUser=e.hasUser,l.FoldoutListItemView.prototype.initialize.call(this,e)},_setUpListeners:function(){l.FoldoutListItemView.prototype._setUpListeners.call(this),this.listenTo(this.model,"change",function(e,t){n.default.has(e.changed,"deleted")?this.render():n.default.has(e.changed,"element_count")&&this.$("> .title-bar .subtitle").replaceWith(this._renderSubtitle())})},_renderSubtitle:function(){return(0,d.default)(this.templates.subtitle(this.model.toJSON(),this))},_getFoldoutPanelOptions:function(){var e=l.FoldoutListItemView.prototype._getFoldoutPanelOptions.call(this);return n.default.extend(e,{linkTarget:this.linkTarget,hasUser:this.hasUser})},$selector:function(){return this.$("> .selector")},toString:function(){var e=this.model?"".concat(this.model):"(no model)";return"DCListItemView(".concat(e,")")}});h.prototype.templates=(u=n.default.extend({},l.FoldoutListItemView.prototype.templates.warnings,{error:c.default.wrapTemplate(["<% if( model.error ){ %>",'<div class="errormessagesmall">',(0,r.default)("There was an error getting the data for this collection"),": <%- model.error %>","</div>","<% } %>"]),purged:c.default.wrapTemplate(["<% if( model.purged ){ %>",'<div class="purged-msg warningmessagesmall">',(0,r.default)("This collection has been deleted and removed from disk"),"</div>","<% } %>"]),deleted:c.default.wrapTemplate(["<% if( model.deleted && !model.purged ){ %>",'<div class="deleted-msg warningmessagesmall">',(0,r.default)("This collection has been deleted"),"</div>","<% } %>"])}),p=c.default.wrapTemplate(['<div class="title-bar clear" tabindex="0">','<div class="title">','<span class="name"><%- collection.element_identifier || collection.name %></span>',"</div>",'<div class="subtitle"></div>',"</div>"],"collection"),f=c.default.wrapTemplate(['<div class="subtitle">','<% var countText = collection.element_count? ( collection.element_count + " " ) : ""; %>','<%        if( collection.collection_type === "list" ){ %>',(0,r.default)("a list of <%- countText %>datasets"),'<% } else if( collection.collection_type === "paired" ){ %>',(0,r.default)("a pair of datasets"),'<% } else if( collection.collection_type === "list:paired" ){ %>',(0,r.default)("a list of <%- countText %>dataset pairs"),'<% } else if( collection.collection_type === "list:list" ){ %>',(0,r.default)("a list of <%- countText %>dataset lists"),"<% } %>","</div>"],"collection"),n.default.extend({},l.FoldoutListItemView.prototype.templates,{warnings:u,titleBar:p,subtitle:f}));var g,v=l.ListItemView.extend({className:"".concat(l.ListItemView.prototype.className," dataset-collection-element"),initialize:function(e){e.logger&&(this.logger=this.model.logger=e.logger),this.log("DCEListItemView.initialize:",e),l.ListItemView.prototype.initialize.call(this,e)},toString:function(){var e=this.model?"".concat(this.model):"(no model)";return"DCEListItemView(".concat(e,")")}});v.prototype.templates=(g=c.default.wrapTemplate(['<div class="title-bar clear" tabindex="0">','<div class="title">','<span class="name"><%- element.element_identifier %></span>',"</div>",'<div class="subtitle"></div>',"</div>"],"element"),n.default.extend({},l.ListItemView.prototype.templates,{titleBar:g}));var w,L=a.DatasetListItemView.extend({className:"".concat(a.DatasetListItemView.prototype.className," dataset-collection-element"),initialize:function(e){e.logger&&(this.logger=this.model.logger=e.logger),this.log("DatasetDCEListItemView.initialize:",e),a.DatasetListItemView.prototype.initialize.call(this,e)},_fetchModelDetails:function(){var e=this;return e.model.inReadyState()&&!e.model.hasDetails()?e.model.fetch({silent:!0}):d.default.when()},toString:function(){var e=this.model?"".concat(this.model):"(no model)";return"DatasetDCEListItemView(".concat(e,")")}});L.prototype.templates=(w=c.default.wrapTemplate(['<div class="title-bar clear" tabindex="0">','<span class="state-icon"></span>','<div class="title">','<span class="name"><%- element.element_identifier %></span>',"</div>","</div>"],"element"),n.default.extend({},a.DatasetListItemView.prototype.templates,{titleBar:w}));var I=h.extend({className:"".concat(h.prototype.className," dataset-collection-element"),_swapNewRender:function(e){h.prototype._swapNewRender.call(this,e);var t=this.model.get("state")||"ok";return this.$el.addClass("state-".concat(t)),this.$el},toString:function(){var e=this.model?"".concat(this.model):"(no model)";return"NestedDCDCEListItemView(".concat(e,")")}});e.default={DCListItemView:h,DCEListItemView:v,DatasetDCEListItemView:L,NestedDCDCEListItemView:I}});
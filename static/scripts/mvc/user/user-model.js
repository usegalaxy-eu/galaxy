define(["exports","underscore","backbone","onload/loadConfig","mvc/base-mvc","utils/localization"],function(e,t,n,o,i,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});c(t);var a=c(n),r=c(i),u=c(s);function c(e){return e&&e.__esModule?e:{default:e}}var l=a.default.Model.extend(r.default.LoggableMixin).extend({_logNamespace:"user",urlRoot:function(){return"".concat((0,o.getAppRoot)(),"api/users")},defaults:{id:null,username:"(".concat((0,u.default)("anonymous user"),")"),email:"",total_disk_usage:0,nice_total_disk_usage:"",quota_percent:null,is_admin:!1},initialize:function(e){this.log("User.initialize:",e),this.on("loaded",function(e,t){this.log("".concat(this," has loaded:"),e,t)}),this.on("change",function(e,t){this.log("".concat(this," has changed:"),e,t.changes)})},isAnonymous:function(){return!this.get("email")},isAdmin:function(){return this.get("is_admin")},loadFromApi:function(e,t){e=e||l.CURRENT_ID_STR;var n=this,o=(t=t||{}).success;return t.success=function(e,t){n.trigger("loaded",e,t),o&&o(e,t)},e===l.CURRENT_ID_STR&&(t.url="".concat(this.urlRoot,"/").concat(l.CURRENT_ID_STR)),a.default.Model.prototype.fetch.call(this,t)},clearSessionStorage:function(){for(var e in sessionStorage)0===e.indexOf("history:")?sessionStorage.removeItem(e):"history-panel"===e&&sessionStorage.removeItem(e)},toString:function(){var e=[this.get("username")];return this.get("id")&&(e.unshift(this.get("id")),e.push(this.get("email"))),"User(".concat(e.join(":"),")")}});l.CURRENT_ID_STR="current",l.getCurrentUserFromApi=function(e){var t=new l;return t.loadFromApi(l.CURRENT_ID_STR,e),t};a.default.Collection.extend(r.default.LoggableMixin).extend({model:l,urlRoot:function(){return"".concat((0,o.getAppRoot)(),"api/users")}});e.default={User:l}});
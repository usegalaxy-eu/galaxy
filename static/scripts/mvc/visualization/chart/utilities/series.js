define(["exports","underscore","d3"],function(r,e,a){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var g=n(e),d=n(a);function n(r){if(r&&r.__esModule)return r;var e={};if(null!=r)for(var a in r)if(Object.prototype.hasOwnProperty.call(r,a)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(r,a):{};n.get||n.set?Object.defineProperty(e,a,n):e[a]=r[a]}return e.default=r,e}function t(n,r){g.each(r,function(r){g.each(r.values,function(r,e){for(var a in n)r[a]=parseInt(e)})})}r.default={makeCategories:function(r,e){var a={},n=r[0].__data_columns;return g.each(e,function(r){n[r].is_label&&(a[r]=[])}),r&&r[0]&&g.each(r[0].values,function(r){for(var e in a)a[e].push(String(r[e]))}),t(a,r),{array:a}},makeUniqueCategories:function(r,e){var a={},n={},t={},i=r[0].__data_columns;for(var o in g.each(i,function(r,e){r.is_label&&(a[e]={},n[e]=[],t[e]=0)}),r){var u=r[o];for(var c in u.values){var s=u.values[c];for(var f in a){var v=String(s[f]);void 0===a[f][v]&&(a[f][v]=t[f],n[f].push(e?[t[f],v]:v),t[f]++)}}}for(var l in r){var m=r[l];for(var d in m.values){var h=m.values[d];for(var p in a){var y=String(h[p]);h[p]=a[p][y]}}}return{categories:a,array:n,counter:t}},makeSeries:function(r,e){var a=[];for(var n in r){var t=r[n],i=[];for(var o in t.values){var u=[];if(e)for(var c in e){var s=e[c];u.push(t.values[o][s])}else for(var f in t.values[o])u.push(t.values[o][f]);i.push(u)}a.push(i)}return a},getDomains:function(i,r){function e(r,e){var a;for(var n in i){var t=d[r](i[n].values,function(r){return r[e]});a=void 0===a?t:Math[r](a,t)}return a}var a={};for(var n in r){var t=r[n];a[t]={min:e("min",t),max:e("max",t)}}return a},mapCategories:t,makeTickFormat:function(r){var a=r.type,n=r.precision,t=r.categories,e=r.formatter;if("hide"==a)e(function(){return""});else if("auto"==a)t&&e(function(r){return t[r]||""});else{var i=function(r){switch(a){case"s":var e=d.formatPrefix(r);return e.scale(r).toFixed()+e.symbol;default:return d.format("."+n+a)(r)}};e(t?function(r){var e=t[r];if(!e)return"";if(isNaN(e))return e;try{return i(e)}catch(r){return e}}:function(r){return i(r)})}},addZoom:function(r){var a=100,e=r.yAxis,n=r.xAxis,t=r.xDomain||n.scale().domain,i=r.yDomain||e.scale().domain,o=r.redraw,u=r.svg,c=n.scale(),s=e.scale(),f=c.domain().slice(),v=s.domain().slice(),l=d.behavior.zoom();function m(r,e){return r[0]=Math.min(Math.max(r[0],e[0]),e[1]-e[1]/a),r[1]=Math.max(e[0]+e[1]/a,Math.min(r[1],e[1])),r}return c.nice(),s.nice(),l.x(c).y(s).scaleExtent([1,a]).on("zoom",function(){i(m(s.domain(),v)),t(m(c.domain(),f)),o()}),u.call(l).on("dblclick.zoom",function(){t(f),i(v),o(),l.scale(1),l.translate([0,0])}),l}}});
define(["exports"],function(e){"use strict";function n(e,t){var n=document.createElement("a");n.download=t,n.href=e,n.click()}function o(e,t){n(e.replace("image/png","image/octet-stream"),"".concat(t||"GalaxyImage",".png"))}function c(e){var t=e.$el.find("svg");if(0!=t.length||!e.error){var n=t.length,a=parseInt(t.first().css("height")),i=parseInt(t.first().css("width")),r=new XMLSerializer,s=$("<svg/>").attr({version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:i*n,height:a}),o=0;return t.each(function(){var e=$(this).clone();!function(e){for(var t in document.styleSheets){var n=document.styleSheets[t],a=n.cssRules;if(a)for(var i=0,r=a.length;i<r;i++)try{e.find(a[i].selectorText).each(function(e,t){t.style.cssText+=a[i].style.cssText})}catch(e){}}}(e);var t=$('<g transform="translate('+o+', 0)">').attr("xmlns","http://www.w3.org/2000/svg");t.append(e.find("g").first()),s.append(t),o+=i}),{string:r.serializeToString(s[0]),height:a,width:i}}e.error("No SVG found. This visualization type does not support SVG/PDF export.")}Object.defineProperty(e,"__esModule",{value:!0}),e.default={createPNG:function(e){var t,n,a,i,r,s;0<e.$el.find("svg").length?(n=c(t=e),a=document.createElement("canvas"),i=a.getContext("2d"),r=new Image,s=$('<div style="display:none;"/>').append($(a)),$("body").append(s),a.width=5*n.width,a.height=5*n.height,r.src="data:image/svg+xml;base64,"+window.btoa(n.string),r.onload=function(){i.drawImage(r,0,0,a.width,a.height);var e=a.toDataURL("image/png");o(e,t.title),s.remove()}):function(t){var e=t.$el.find(".charts-viewer-canvas");try{if(0!==e.width()&&0!==e.height()){var n=document.createElement("canvas");n.width=e.outerWidth(!0),n.height=e.outerHeight(!0);var a=n.getContext("2d");a.save(),a.fillStyle="rgb(255,255,255)",a.fillRect(0,0,n.width,n.height),a.restore(),a.translate(0,0),a.textAlign="left",a.textBaseline="top",e.children().each(function(){!function e(t,n,a,i){var r=t.prop("tagName").toLowerCase(),s=t.position(),o=n+s.left+parseInt(t.css("marginLeft"),10)+parseInt(t.css("borderLeftWidth"),10)+parseInt(t.css("paddingLeft"),10),c=a+s.top+parseInt(t.css("marginTop"),10)+parseInt(t.css("borderTopWidth"),10)+parseInt(t.css("paddingTop"),10);"div"==r||"span"==r?t.children().each(function(){e($(this),o,c)}):"canvas"==r&&i.drawImage(t[0],o,c)}($(this),0,0,a)});var i=n.toDataURL("image/png");i&&o(i,t.title)}}catch(e){console.debug("FAILED - screenshot::_canvas2png() - "+e),t.error&&t.error("Please reduce your visualization to a single panel and try again.")}}(e)},createSVG:function(e){n("data:none/none;base64,".concat(window.btoa(c(e).string)),"".concat(e.title||"GalaxyImage",".svg"))},createPDF:function(e){var t=c(e),n={filename:"visualization",type:"application/pdf",height:t.height,width:t.width,scale:2,svg:t.string},a=$("body"),i=a.find("#viewer-form");for(var r in 0===i.length&&(i=$("<form>",{id:"viewer-form",method:"post",action:"http://export.highcharts.com/",display:"none"}),a.append(i)),i.empty(),n){var s=$("<input/>",{type:"hidden",name:r,value:n[r]});i.append(s)}try{i.submit()}catch(e){console.log(e)}}}});
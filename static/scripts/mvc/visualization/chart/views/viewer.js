define(["exports","utils/utils"],function(e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a,n=(a=t)&&a.__esModule?a:{default:a};e.default=Backbone.View.extend({initialize:function(e,t){var i=this;this.app=e,this.chart=this.app.chart,this.options=t,this.setElement($("<div/>").addClass("charts-viewer").append($("<div/>").addClass("info").append($("<span/>").addClass("icon")).append($("<span/>").addClass("text")))),this.$info=this.$(".info"),this.$icon=this.$(".icon"),this.$text=this.$(".text"),this._fullscreen(this.$el,20),this._createContainer("div"),this.chart.on("redraw",function(e){i.chart.get("modified")&&i.chart.plugin.specs.confirm&&!e?i.chart.state("info","Please confirm the settings before rendering the results."):i.app.deferred.execute(function(e){console.debug("viewer:redraw() - Redrawing..."),i._draw(e,i.chart)})}),this.chart.on("set:state",function(){var e=i.$(".charts-viewer-container"),t=i.$info,a=i.$icon,s=i.$text;switch(a.removeClass(),t.show(),s.html(i.chart.get("state_info")),i.chart.get("state")){case"ok":t.hide(),e.show();break;case"failed":a.addClass("icon fa fa-warning"),e.hide();break;case"info":a.addClass("icon fa fa-info"),e.hide();break;default:a.addClass("icon fa fa-spinner fa-spin"),e.show()}})},_fullscreen:function(e,t){e.css("height",$(window).height()-t),$(window).resize(function(){e.css("height",$(window).height()-t)})},_createContainer:function(e,t){e=e||"div",t=t||1,this.$(".charts-viewer-container").remove(),this.targets=[];for(var a=0;a<t;a++){var s=n.default.uid(),i=$("<div/>").addClass("charts-viewer-container").width(parseInt(100/t)+"%").append($("<"+e+" class='charts-viewer-canvas' />").attr("id",s));this.$el.append(i),this.targets.push(s)}},_draw:function(e,t){var a="true"==t.settings.get("__use_panels")?t.groups.length:1;this._createContainer(t.plugin.specs.tag,a),t.set("date",n.default.time()),t.state("wait","Please wait..."),this.app.chart_load({process:e,chart:t,dataset:this.app.dataset,targets:this.targets})}})});
define(["exports"],function(e){"use strict";function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var r in t)if(t.hasOwnProperty(r)&&(!e.hasOwnProperty(r)||e[r]!==t[r]))return!1;return!0}function s(e,t){var r="function"==typeof t?t:void 0,n="object"===a(t)?t:void 0,o=[],s=0;for(var c in e)if(e.hasOwnProperty(c)){var i=e[c];r?o.push(r.call(i,i,c,s)):n?"object"===a(i)&&u(i,n)&&o.push(i):o.push(i),s+=1}return o}function h(e,t,r){var n=this;return n.source=void 0!==e?e:null,n.target=void 0!==t?t:null,n.data=r||null,n}function r(e,t){var r=this;return r.name=void 0!==e?e:"(unnamed)",r.data=t||null,r.edges={},r.degree=0,r}Object.defineProperty(e,"__esModule",{value:!0}),h.prototype.toString=function(){return"".concat(this.source,"->").concat(this.target)},h.prototype.toJSON=function(){var e={source:this.source,target:this.target};return this.data&&(e.data=this.data),e},r.prototype.toString=function(){return"Vertex(".concat(this.name,")")},r.prototype.eachEdge=function(e){return s(this.edges,e)},r.prototype.toJSON=function(){return{name:this.name,data:this.data}};var n=function(e,t){var r=this;return r.graph=e,r.processFns=t||{vertexEarly:function(e,t){},edge:function(e,t,r){},vertexLate:function(e,t){}},r._cache={},r};n.prototype.search=function(e){var t=this;return e in t._cache?t._cache[e]:(e instanceof r||(e=t.graph.vertices[e]),t._cache[e.name]=t._search(e))},n.prototype._search=function(e,t){return t=t||{discovered:{},edges:[]}},n.prototype.searchTree=function(e){return this._searchTree(this.search(e))},n.prototype._searchTree=function(e){var t=this;return new i(!0,{edges:e.edges,vertices:Object.keys(e.discovered).map(function(e){return t.graph.vertices[e].toJSON()})})};var o=function(e,t){return n.call(this,e,t),this};((o.prototype=new n).constructor=o).prototype._search=function(e,r){var n=this,o=[];function t(e,t){n.processFns.edge&&n.processFns.edge.call(n,this,t,r),r.discovered[e.name]||(r.discovered[e.name]=!0,r.edges.push({source:this.name,target:e.name}),o.push(e))}for((r=r||{discovered:{},edges:[]}).discovered[e.name]=!0,o.push(e);o.length;){var s=o.shift();n.processFns.vertexEarly&&n.processFns.vertexEarly.call(n,s,r),n.graph.eachAdjacent(s,t),n.processFns.vertexLate&&n.processFns.vertexLate.call(n,s,r)}return r};var c=function(e,t){return n.call(this,e,t),this};function i(e,t,r){return this.directed=e||!1,this.init(r).read(t)}((c.prototype=new n).constructor=c).prototype._search=function(e,r){r=r||{discovered:{},edges:[],entryTimes:{},exitTimes:{}};var n=this,t=0;function o(e,t){n.processFns.edge&&n.processFns.edge.call(n,this,t,r),r.discovered[e.name]||(r.edges.push({source:this.name,target:e.name}),s(e))}function s(e){r.discovered[e.name]=!0,n.processFns.vertexEarly&&n.processFns.vertexEarly.call(n,e,r),r.entryTimes[e.name]=t++,n.graph.eachAdjacent(e,o),n.processFns.vertexLate&&n.processFns.vertexLate.call(n,e,r),r.exitTimes[e.name]=t++}return s(e),r},(window.Graph=i).prototype.init=function(e){e=e||{};return this.allowReflexiveEdges=e.allowReflexiveEdges||!1,this.vertices={},this.numEdges=0,this},i.prototype.read=function(e){if(!e)return this;return e.hasOwnProperty("nodes")?this.readNodesAndLinks(e):e.hasOwnProperty("vertices")?this.readVerticesAndEdges(e):this},i.prototype.readNodesAndLinks=function(o){if(!o||!o.hasOwnProperty("nodes"))return this;var s=this;return o.nodes.forEach(function(e){s.createVertex(e.name,e.data)}),(o.links||[]).forEach(function(e,t){var r=o.nodes[e.source].name,n=o.nodes[e.target].name;s.createEdge(r,n,s.directed)}),s},i.prototype.readVerticesAndEdges=function(e){if(!e||!e.hasOwnProperty("vertices"))return this;var r=this;return e.vertices.forEach(function(e){r.createVertex(e.name,e.data)}),(e.edges||[]).forEach(function(e,t){r.createEdge(e.source,e.target,r.directed)}),r},i.prototype.createVertex=function(e,t){return this.vertices[e]?this.vertices[e]:this.vertices[e]=new r(e,t)},i.prototype.createEdge=function(e,t,r,n){var o=e===t;if(!this.allowReflexiveEdges&&o)return null;var s=this.vertices[e],c=this.vertices[t];if(!s||!c)return null;var i=new h(e,t,n);return s.edges[t]=i,s.degree+=1,this.numEdges+=1,o||r||this.createEdge(t,e,!0),i},i.prototype.edges=function(t){return Array.prototype.concat.apply([],this.eachVertex(function(e){return e.eachEdge(t)}))},i.prototype.eachVertex=function(e){return s(this.vertices,e)},i.prototype.adjacent=function(e){var t=this;return s(e.edges,function(e){return t.vertices[e.target]})},i.prototype.eachAdjacent=function(r,n){var o=this;return s(r.edges,function(e){var t=o.vertices[e.target];return n.call(r,t,e)})},i.prototype.print=function(){return console.log("Graph has ".concat(Object.keys(this.vertices).length," vertices")),this.eachVertex(function(e){console.log(e.toString()),e.eachEdge(function(e){console.log("\t ".concat(e))})}),this},i.prototype.toDOT=function(){var t=[];return t.push("graph bler {"),this.edges(function(e){t.push("\t".concat(e.from," -- ").concat(e.to,";"))}),t.push("}"),t.join("\n")},i.prototype.toNodesAndLinks=function(){var n={};return{nodes:this.eachVertex(function(e,t,r){return n[e.name]=r,e.toJSON()}),links:this.edges(function(e){var t=e.toJSON();return t.source=n[e.source],t.target=n[e.target],t})}},i.prototype.toVerticesAndEdges=function(){return{vertices:this.eachVertex(function(e,t){return e.toJSON()}),edges:this.edges(function(e){return e.toJSON()})}},i.prototype.breadthFirstSearch=function(e,t){return new o(this).search(e)},i.prototype.breadthFirstSearchTree=function(e,t){return new o(this).searchTree(e)},i.prototype.depthFirstSearch=function(e,t){return new c(this).search(e)},i.prototype.depthFirstSearchTree=function(e,t){return new c(this).searchTree(e)},i.prototype.weakComponents=function(){var r,n=this,o=this,e=[];function t(e){var t=new c(o)._search(e);return r=r.filter(function(e){return!(e in t.discovered)}),{vertices:Object.keys(t.discovered).map(function(e){return n.vertices[e].toJSON()}),edges:t.edges.map(function(e){var t=void 0!==n.vertices[e.target].edges[e.source];if(n.directed&&t){var r=e.source;e.source=e.target,e.target=r}return e})}}for(n.directed&&(o=new i(!1,n.toNodesAndLinks())),r=Object.keys(o.vertices);r.length;){var s=o.vertices[r.shift()];e.push(t(s))}return e},i.prototype.weakComponentGraph=function(){var e=this.weakComponents();return new i(this.directed,{vertices:e.reduce(function(e,t){return e.concat(t.vertices)},[]),edges:e.reduce(function(e,t){return e.concat(t.edges)},[])})},i.prototype.weakComponentGraphArray=function(){var t=this;return this.weakComponents().map(function(e){return new i(t.directed,e)})},e.default={Vertex:r,Edge:h,BreadthFirstSearch:o,DepthFirstSearch:c,Graph:i,randGraph:function(e,t,r){var n={nodes:[],links:[]};function o(e){return Math.floor(Math.random()*e)}for(var s=0;s<t;s++)n.nodes.push({name:s});for(s=0;s<r;s++)n.links.push({source:o(t),target:o(t)});return new i(e,n)}}});
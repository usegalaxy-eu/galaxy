define(["exports","jquery","underscore","backbone","app"],function(e,t,n,i,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var l=o(t),s=o(n),d=o(i);function o(e){return e&&e.__esModule?e:{default:e}}var h=d.default.View.extend({initialize:function(e){this.view=e.view,this.hidden=!1,this.saved_size=null,this.hiddenByTool=!1},$center:function(){return this.$el.siblings("#center")},$toggleButton:function(){return this.$(".unified-panel-footer > .panel-collapse")},render:function(){var t=this,e=this.view,n=this.view.model.attributes||{};this.$el.html(this._templatePanel(this.id)),s.default.each(n.buttons,function(e){t.$(".panel-header-buttons").append(e.$el)}),this.$el.addClass(n.cls),this.$(".panel-header-text").html(s.default.escape(n.title)),this.$(".unified-panel-body").append(e.$el),e.render()},_templatePanel:function(){return[this._templateHeader(),this._templateBody(),this._templateFooter()].join("")},_templateHeader:function(e){return'<div class="unified-panel-header" unselectable="on">\n                    <div class="unified-panel-header-inner">\n                        <div class="panel-header-buttons"/>\n                        <div class="panel-header-text"/>\n                    </div>\n                </div>\n                <div class="unified-panel-controls"/>'},_templateBody:function(e){return'<div class="unified-panel-body"/>'},_templateFooter:function(e){return['<div class="unified-panel-footer">','<div class="panel-collapse ',s.default.escape(this.id),'"/>','<div class="drag"/>',"</div>"].join("")},events:{"mousedown .unified-panel-footer > .drag":"_mousedownDragHandler","click .unified-panel-footer > .panel-collapse":"toggle"},_mousedownDragHandler:function(e){var i=this,a="left"===this.id,s=e.pageX,d=i.$el.width();function t(e){var t=e.pageX-s,n=a?d+t:d-t;n=Math.min(800,Math.max(160,n)),i.resize(n)}(0,l.default)("#dd-helper").show().on("mousemove",t).one("mouseup",function(e){(0,l.default)(this).hide().off("mousemove",t)})},resize:function(e){return this.$el.css("width",e),this.$center().css(this.id,e),this},show:function(){if(this.hidden){var e=this,t={},n=this.id;return t[n]=0,e.$el.css(n,-this.saved_size).show().animate(t,"fast",function(){e.resize(e.saved_size)}),e.hidden=!1,e.$toggleButton().removeClass("hidden"),this}},hide:function(){if(!this.hidden){var e={},t=this.id;return this.saved_size=this.$el.width(),e[t]=-this.saved_size,this.$el.animate(e,"fast"),this.$center().css(t,0),this.hidden=!0,this.$toggleButton().addClass("hidden"),this}},toggle:function(e){return this.hidden?this.show():this.hide(),this.hiddenByTool=!1,this},handle_minwidth_hint:function(e){return this.$center().width()-(this.hidden?this.saved_size:0)<e?this.hidden||(this.toggle(),this.hiddenByTool=!0):this.hiddenByTool&&(this.toggle(),this.hiddenByTool=!1),self},force_panel:function(e){return"show"==e?this.show():"hide"==e?this.hide():self},toString:function(){return"SidePanel(".concat(this.id,")")}}),r=h.extend({id:"left"}),c=h.extend({id:"right"}),u=d.default.View.extend({initialize:function(e){this.setElement((0,l.default)(this.template())),this.$frame=this.$(".center-frame"),this.$panel=this.$(".center-panel"),this.$frame.on("load",this._iframeChangeHandler.bind(this))},_iframeChangeHandler:function(t){var e=t.currentTarget,n=e.contentWindow&&e.contentWindow.location,i=(0,a.getGalaxyInstance)();try{n&&n.host&&((0,l.default)(e).show(),this.$panel.empty().hide(),i.trigger("center-frame:load",{fullpath:n.pathname+n.search+n.hash,pathname:n.pathname,search:n.search,hash:n.hash}))}catch(e){console.warn("_iframeChangeHandler error",t,n,i)}},display:function(e){var t,n=(0,a.getGalaxyInstance)(),i=this.$frame[0].contentWindow||{};try{t=i.onbeforeunload&&i.onbeforeunload()}catch(e){i={},console.warn("Iframe unload exception.  This can happen when external content is displayed in the page iframe and causes a CORS violation -- likely harmless.")}t&&!confirm(t)||(i.onbeforeunload=void 0,this.$frame.attr("src","about:blank").hide(),this.$panel.empty().scrollTop(0).append(e.$el||e).show(),n.trigger("center-panel:load",e))},template:function(){return'<div class="center-container"><iframe id="galaxy_main" name="galaxy_main" frameborder="0" class="center-frame" /><div class="center-panel" /></div>'},toString:function(){return"CenterPanel"}});e.default={SidePanel:h,LeftPanel:r,RightPanel:c,CenterPanel:u}});
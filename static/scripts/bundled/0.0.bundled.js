webpackJsonp([0,1],[,,,,,function(t,e,i){var a,n;(function(s,r,o){a=[i(4),i(15),i(42),i(14),i(37),i(11),i(8)],n=function(t,e,i,a,n,l,h){var d=s.View.extend({tagName:"label",initialize:function(t){this.model=t&&t.model||new s.Model(t),this.tagName=t.tagName||this.tagName,this.setElement(r("<"+this.tagName+"/>")),this.listenTo(this.model,"change",this.render,this),this.render()},title:function(t){this.model.set("title",t)},value:function(){return this.model.get("title")},render:function(){return this.$el.removeClass().addClass("ui-label").addClass(this.model.get("cls")).html(this.model.get("title")),this}}),c=s.View.extend({initialize:function(t){this.model=t&&t.model||new s.Model({message:null,status:"info",cls:"",persistent:!1,fade:!0}).set(t),this.listenTo(this.model,"change",this.render,this),this.render()},update:function(t){this.model.set(t)},render:function(){this.$el.removeClass().addClass("ui-message").addClass(this.model.get("cls"));var t=this.model.get("status");if(this.model.get("large")?this.$el.addClass(("success"==t&&"done"||"danger"==t&&"error"||t)+"messagelarge"):this.$el.addClass("alert").addClass("alert-"+t),this.model.get("message")){if(this.$el.html(this.messageForDisplay()),this.$el[this.model.get("fade")?"fadeIn":"show"](),this.timeout&&window.clearTimeout(this.timeout),!this.model.get("persistent")){var e=this;this.timeout=window.setTimeout(function(){e.model.set("message","")},3e3)}}else this.$el.fadeOut();return this},messageForDisplay:function(){return o.escape(this.model.get("message"))}}),u=c.extend({messageForDisplay:function(){return this.model.get("message")}}),g=s.View.extend({initialize:function(t){this.model=t&&t.model||new s.Model({type:"text",placeholder:"",disabled:!1,readonly:!1,visible:!0,cls:"",area:!1,color:null,style:null}).set(t),this.tagName=this.model.get("area")?"textarea":"input",this.setElement(r("<"+this.tagName+"/>")),this.listenTo(this.model,"change",this.render,this),this.render()},events:{input:"_onchange"},value:function(t){return void 0!==t&&this.model.set("value","string"==typeof t?t:""),this.model.get("value")},render:function(){var t=this;this.$el.removeClass().addClass("ui-"+this.tagName).addClass(this.model.get("cls")).addClass(this.model.get("style")).attr("id",this.model.id).attr("type",this.model.get("type")).attr("placeholder",this.model.get("placeholder")).css("color",this.model.get("color")||"").css("border-color",this.model.get("color")||"");var e=this.model.get("datalist");return r.isArray(e)&&e.length>0&&this.$el.autocomplete({source:function(e,i){i(t.model.get("datalist"))},change:function(){t._onchange()}}),this.model.get("value")!==this.$el.val()&&this.$el.val(this.model.get("value")),o.each(["readonly","disabled"],function(e){t.model.get(e)?t.$el.attr(e,!0):t.$el.removeAttr(e)}),this.$el[this.model.get("visible")?"show":"hide"](),this},_onchange:function(){this.value(this.$el.val()),this.model.get("onchange")&&this.model.get("onchange")(this.model.get("value"))}}),f=s.View.extend({initialize:function(t){this.model=t&&t.model||new s.Model(t),this.setElement(r("<div/>").append(this.$info=r("<div/>")).append(this.$hidden=r("<div/>"))),this.listenTo(this.model,"change",this.render,this),this.render()},value:function(t){return void 0!==t&&this.model.set("value",t),this.model.get("value")},render:function(){return this.$el.attr("id",this.model.id),this.$hidden.val(this.model.get("value")),this.model.get("info")?this.$info.show().text(this.model.get("info")):this.$info.hide(),this}}),_=s.View.extend({initialize:function(t){var e=this;this.model=t&&t.model||new s.Model(t),this.setElement(r("<div/>").append(this.$info=r("<div/>")).append(this.$file=r("<input/>").attr("type","file").addClass("ui-margin-bottom")).append(this.$text=r("<textarea/>").addClass("ui-textarea").attr("disabled",!0)).append(this.$wait=r("<i/>").addClass("fa fa-spinner fa-spin"))),this.listenTo(this.model,"change",this.render,this),this.$file.on("change",function(t){e._readFile(t)}),this.render()},value:function(t){return void 0!==t&&this.model.set("value",t),this.model.get("value")},render:function(){return this.$el.attr("id",this.model.id),this.model.get("info")?this.$info.show().text(this.model.get("info")):this.$info.hide(),this.model.get("value")?this.$text.text(this.model.get("value")).show():this.$text.hide(),this.model.get("wait")?this.$wait.show():this.$wait.hide(),this},_readFile:function(t){var e=this,i=t.target.files&&t.target.files[0];if(i){var a=new FileReader;a.onload=function(){e.model.set({wait:!1,value:this.result})},this.model.set({wait:!0,value:null}),a.readAsText(i)}}});return{Button:l.ButtonDefault,ButtonIcon:l.ButtonIcon,ButtonCheck:l.ButtonCheck,ButtonMenu:l.ButtonMenu,ButtonLink:l.ButtonLink,Input:g,Label:d,Message:c,UnescapedMessage:u,Upload:_,Modal:h,RadioButton:a.RadioButton,Checkbox:a.Checkbox,Radio:a.Radio,Select:e,Hidden:f,Slider:i,Drilldown:n}}.apply(e,a),!(void 0!==n&&(t.exports=n))}).call(e,i(2),i(1),i(3))},,,,function(t,e,i){var a,n;(function(s,r,o){a=[i(4),i(5)],n=function(t,e){var i=s.View.extend({visible:!1,initialize:function(i){var a=this;this.model=i&&i.model||new s.Model({id:t.uid(),cls:"ui-portlet",title:"",icon:"",buttons:null,body:null,scrollable:!0,nopadding:!1,operations:null,collapsible:!1,collapsible_button:!1,collapsed:!1,onchange_title:null}).set(i),this.setElement(this._template()),this.$body=this.$(".portlet-body"),this.$title_text=this.$(".portlet-title-text"),this.$title_icon=this.$(".portlet-title-icon"),this.$header=this.$(".portlet-header"),this.$content=this.$(".portlet-content"),this.$backdrop=this.$(".portlet-backdrop"),this.$buttons=this.$(".portlet-buttons"),this.$operations=this.$(".portlet-operations"),this.model.get("body")&&this.append(this.model.get("body")),this.collapsible_button=new e.ButtonIcon({icon:"fa-eye",tooltip:"Collapse/Expand",cls:"ui-button-icon-plain",onclick:function(){a[a.collapsed?"expand":"collapse"]()}}),this.render()},render:function(){var t=this,e=this.model.attributes;return this.$el.removeClass().addClass(e.cls).attr("id",e.id),this.$header[e.title?"show":"hide"](),this.$title_text.html(e.title),r.each([this.$content,this.$body],function(t){t[e.nopadding?"addClass":"removeClass"]("no-padding")}),e.icon?this.$title_icon.removeClass().addClass("portlet-title-icon fa").addClass(e.icon).show():this.$title_icon.hide(),this.$title_text[e.collapsible?"addClass":"removeClass"]("no-highlight collapsible").off(),e.collapsible&&(this.$title_text.on("click",function(){t[t.collapsed?"expand":"collapse"]()}),e.collapsed?this.collapse():this.expand()),this.$title_text.prop("disabled",!e.onchange_title),e.onchange_title&&this.$title_text.make_text_editable({on_finish:function(t){e.onchange_title(t)}}),e.buttons?(this.$buttons.empty().show(),o.each(this.model.get("buttons"),function(e,i){i.$el.prop("id",e),t.$buttons.append(i.$el)})):this.$buttons.hide(),this.$operations.empty,e.collapsible_button&&this.$operations.append(this.collapsible_button.$el),e.operations&&o.each(e.operations,function(e,i){i.$el.prop("id",e),t.$operations.append(i.$el)}),this},append:function(t){this.$body.append(t)},empty:function(){this.$body.empty()},header:function(){return this.$header},body:function(){return this.$body},show:function(){this.visible=!0,this.$el.fadeIn("fast")},hide:function(){this.visible=!1,this.$el.hide()},enableButton:function(t){this.$buttons.find("#"+t).prop("disabled",!1)},disableButton:function(t){this.$buttons.find("#"+t).prop("disabled",!0)},hideOperation:function(t){this.$operations.find("#"+t).hide()},showOperation:function(t){this.$operations.find("#"+t).show()},setOperation:function(t,e){this.$operations.find("#"+t).off("click").on("click",e)},title:function(t){return t&&this.$title_text.html(t),this.$title_text.html()},collapse:function(){this.collapsed=!0,this.$content.height("0%"),this.$body.hide(),this.collapsible_button.setIcon("fa-eye-slash")},expand:function(){this.collapsed=!1,this.$content.height("100%"),this.$body.fadeIn("fast"),this.collapsible_button.setIcon("fa-eye")},disable:function(){this.$backdrop.show()},enable:function(){this.$backdrop.hide()},_template:function(){return o("<div/>").append(o("<div/>").addClass("portlet-header").append(o("<div/>").addClass("portlet-operations")).append(o("<div/>").addClass("portlet-title").append(o("<i/>").addClass("portlet-title-icon")).append(o("<span/>").addClass("portlet-title-text")))).append(o("<div/>").addClass("portlet-content").append(o("<div/>").addClass("portlet-body")).append(o("<div/>").addClass("portlet-buttons"))).append(o("<div/>").addClass("portlet-backdrop"))}});return{View:i}}.apply(e,a),!(void 0!==n&&(t.exports=n))}).call(e,i(2),i(3),i(1))},function(t,e,i){var a,n;(function(s,r,o){a=[i(4),i(9),i(5),i(32),i(19)],n=function(t,e,i,a,n){return s.View.extend({initialize:function(t){this.model=new s.Model({initial_errors:!1,cls:"ui-portlet-limited",icon:null,always_refresh:!0,status:"warning",onchange:function(){}}).set(t),this.setElement("<div/>"),this.render()},update:function(t){var e=this;this.data.matchModel(t,function(t,i){var a=e.input_list[i];if(a&&a.options&&!r.isEqual(a.options,t.options)){a.options=t.options;var n=e.field_list[i];if(n.update){var s=[];if(["data","data_collection","drill_down"].indexOf(a.type)!=-1)s=a.options;else for(var o in t.options){var l=t.options[o];l.length>2&&s.push({label:l[0],value:l[1]})}n.update(s),n.trigger("change"),Galaxy.emit.debug("form-view::update()","Updating options for "+i)}}})},wait:function(t){for(var e in this.input_list){var i=this.field_list[e],a=this.input_list[e];a.is_dynamic&&i.wait&&i.unwait&&i[t?"wait":"unwait"]()}},highlight:function(t,e,i){var a=this.element_list[t];if(a&&(a.error(e||"Please verify this parameter."),this.portlet.expand(),this.trigger("expand",t),!i)){var n=this.$el.parents().filter(function(){return["auto","scroll"].indexOf(o(this).css("overflow"))!=-1}).first();n.animate({scrollTop:n.scrollTop()+a.$el.offset().top-120},500)}},errors:function(t){if(this.trigger("reset"),t&&t.errors){var e=this.data.matchResponse(t.errors);for(var i in this.element_list){this.element_list[i];e[i]&&this.highlight(i,e[i],!0)}}},render:function(){var t=this;this.off("change"),this.off("reset"),this.field_list={},this.input_list={},this.element_list={},this.data=new n.Manager(this),this._renderForm(),this.data.create(),this.model.get("initial_errors")&&this.errors(this.model.attributes);var e=this.data.checksum();return this.on("change",function(i){var a=t.input_list[i];if(!a||a.refresh_on_change||t.model.get("always_refresh")){var n=t.data.checksum();n!=e&&(e=n,t.model.get("onchange")())}}),this.on("reset",function(){r.each(t.element_list,function(t){t.reset()})}),this},_renderForm:function(){o(".tooltip").remove();var t=this.model.attributes;this.message=new i.UnescapedMessage,this.section=new a.View(this,{inputs:t.inputs}),this.portlet=new e.View({icon:t.icon,title:t.title,cls:t.cls,operations:t.operations,buttons:t.buttons,collapsible:t.collapsible,collapsed:t.collapsed,onchange_title:t.onchange_title}),this.portlet.append(this.message.$el),this.portlet.append(this.section.$el),this.$el.empty(),t.inputs&&this.$el.append(this.portlet.$el),t.message&&this.message.update({persistent:!0,status:t.status,message:t.message}),Galaxy.emit.debug("form-view::initialize()","Completed")}})}.apply(e,a),!(void 0!==n&&(t.exports=n))}).call(e,i(2),i(3),i(1))},function(t,e,i){var a,n;(function(s,r){a=[i(4)],n=function(t){var e=s.View.extend({initialize:function(e){this.model=e&&e.model||new s.Model({id:t.uid(),title:"",icon:"",cls:"btn btn-default",wait:!1,wait_text:"Sending...",wait_cls:"btn btn-info",disabled:!1,percentage:-1}).set(e),this.setElement(r("<button/>").attr("type","button").append(this.$icon=r("<i/>")).append(this.$title=r("<span/>")).append(this.$progress=r("<div/>").append(this.$progress_bar=r("<div/>")))),this.listenTo(this.model,"change",this.render,this),this.render()},render:function(){var t=this,e=this.model.attributes;this.$el.removeClass().addClass("ui-button-default").addClass(e.disabled&&"disabled").attr("id",e.id).attr("disabled",e.disabled).off("click").on("click",function(){r(".tooltip").hide(),e.onclick&&!t.disabled&&e.onclick()}).tooltip({title:e.tooltip,placement:"bottom"}),this.$progress.addClass("progress").css("display",e.percentage!==-1?"block":"none"),this.$progress_bar.addClass("progress-bar").css({width:e.percentage+"%"}),this.$icon.removeClass().addClass("icon fa"),this.$title.removeClass().addClass("title"),e.wait?(this.$el.addClass(e.wait_cls).prop("disabled",!0),this.$icon.addClass("fa-spinner fa-spin ui-margin-right"),this.$title.html(e.wait_text)):(this.$el.addClass(e.cls),this.$icon.addClass(e.icon),this.$title.html(e.title),e.icon&&e.title&&this.$icon.addClass("ui-margin-right"))},show:function(){this.$el.show()},hide:function(){this.$el.hide()},disable:function(){this.model.set("disabled",!0)},enable:function(){this.model.set("disabled",!1)},wait:function(){this.model.set("wait",!0)},unwait:function(){this.model.set("wait",!1)},setIcon:function(t){this.model.set("icon",t)}}),i=e.extend({initialize:function(e){this.model=e&&e.model||new s.Model({id:t.uid(),title:"",icon:"",cls:""}).set(e),this.setElement(r("<a/>").append(this.$icon=r("<span/>"))),this.listenTo(this.model,"change",this.render,this),this.render()},render:function(){var t=this.model.attributes;this.$el.removeClass().addClass(t.cls).attr({id:t.id,href:t.href||"javascript:void(0)",title:t.title,target:t.target||"_top",disabled:t.disabled}).tooltip({placement:"bottom"}).off("click").on("click",function(){t.onclick&&!t.disabled&&t.onclick()}),this.$icon.removeClass().addClass(t.icon)}}),a=s.View.extend({initialize:function(e){this.model=e&&e.model||new s.Model({id:t.uid(),title:"Select/Unselect all",icons:["fa-square-o","fa-minus-square-o","fa-check-square-o"],value:0,onchange:function(){}}).set(e),this.setElement(r("<div/>").append(this.$icon=r("<span/>")).append(this.$title=r("<span/>"))),this.listenTo(this.model,"change",this.render,this),this.render()},render:function(t){var e=this,t=this.model.attributes;this.$el.addClass("ui-button-check").off("click").on("click",function(){e.model.set("value",0===e.model.get("value")&&2||0),t.onclick&&t.onclick()}),this.$title.html(t.title),this.$icon.removeClass().addClass("icon fa ui-margin-right").addClass(t.icons[t.value])},value:function(t,e){return void 0!==t&&(e&&0!==t&&(t=t!==e&&1||2),this.model.set("value",t),this.model.get("onchange")(this.model.get("value"))),this.model.get("value")}}),n=e.extend({initialize:function(e){this.model=e&&e.model||new s.Model({id:t.uid(),title:"",icon:"",cls:"ui-button-icon",disabled:!1}).set(e),this.setElement(r("<div/>").append(this.$button=r("<div/>").append(this.$icon=r("<i/>")).append(this.$title=r("<span/>")))),this.listenTo(this.model,"change",this.render,this),this.render()},render:function(t){var t=this.model.attributes;this.$el.removeClass().addClass(t.cls).addClass(t.disabled&&"disabled").attr("disabled",t.disabled).attr("id",t.id).off("click").on("click",function(){r(".tooltip").hide(),!t.disabled&&t.onclick&&t.onclick()}),this.$button.addClass("button").tooltip({title:t.tooltip,placement:"bottom"}),this.$icon.removeClass().addClass("icon fa").addClass(t.icon),this.$title.addClass("title").html(t.title),t.icon&&t.title&&this.$icon.addClass("ui-margin-right")}}),o=e.extend({$menu:null,initialize:function(t){this.model=t&&t.model||new s.Model({id:"",title:"",pull:"right",icon:null,onclick:null,cls:"ui-button-icon ui-button-menu",tooltip:"",target:"",href:"",onunload:null,visible:!0,tag:""}).set(t),this.collection=new s.Collection,this.setElement(r("<div/>").append(this.$root=r("<div/>").append(this.$icon=r("<i/>")).append(this.$title=r("<span/>")))),this.listenTo(this.model,"change",this.render,this),this.listenTo(this.collection,"change add remove reset",this.render,this),this.render()},render:function(){var t=this,e=this.model.attributes;this.$el.removeClass().addClass("dropdown").addClass(e.cls).attr("id",e.id).css({display:e.visible&&this.collection.where({visible:!0}).length>0?"block":"none"}),this.$root.addClass("root button dropdown-toggle").attr("data-toggle","dropdown").tooltip({title:e.tooltip,placement:"bottom"}).off("click").on("click",function(t){r(".tooltip").hide(),t.preventDefault(),e.onclick&&e.onclick()}),this.$icon.removeClass().addClass("icon fa").addClass(e.icon),this.$title.removeClass().addClass("title").html(e.title),e.icon&&e.title&&this.$icon.addClass("ui-margin-right"),this.$menu&&this.$menu.remove(),this.collection.length>0&&(this.$menu=r("<ul/>").addClass("menu dropdown-menu").addClass("pull-"+t.model.get("pull")).attr("role","menu"),this.$el.append(this.$menu)),this.collection.each(function(e){var i=e.attributes;if(i.visible){var a=r("<a/>").addClass("dropdown-item").attr({href:i.href,target:i.target}).append(r("<i/>").addClass("fa").addClass(i.icon).css("display",i.icon?"inline-block":"none")).append(i.title).on("click",function(t){i.onclick&&(t.preventDefault(),i.onclick())});t.$menu.append(r("<li/>").append(a)),i.divider&&t.$menu.append(r("<li/>").addClass("divider"))}})},addMenu:function(e){this.collection.add(t.merge(e,{title:"",target:"",href:"",onclick:null,divider:!1,visible:!0,icon:null,cls:"button-menu btn-group"}))}});return{ButtonDefault:e,ButtonLink:i,ButtonIcon:n,ButtonCheck:a,ButtonMenu:o}}.apply(e,a),!(void 0!==n&&(t.exports=n))}).call(e,i(2),i(1))},function(t,e,i){var a,n;(function(s,r,o,l){s.ajaxSettings.traditional=!0,a=[i(4),i(33),i(34),i(18)],n=function(t,e,i,a){return r.View.extend({grid:null,initialize:function(t){this.grid=new e,this.dict_format=t.dict_format,this.title=t.title;var i=this;if(window.add_tag_to_grid_filter=function(t,e){var a=t+(void 0!==e&&""!==e?":"+e:""),n=o("#advanced-search").is(":visible");n||(o("#standard-search").slideToggle("fast"),o("#advanced-search").slideToggle("fast")),i.add_filter_condition("tags",a)},this.dict_format)if(this.setElement("<div/>"),t.url_base&&!t.items){var a=t.url_data||{};l.each(t.filters,function(t,e){a["f-"+e]=t}),o.ajax({url:t.url_base+"?"+o.param(a),success:function(e){e.embedded=t.embedded,e.filters=t.filters||{},i.init_grid(e)}})}else this.init_grid(t);else this.setElement("#grid-container"),this.init_grid(t);t.use_panels&&o("#center").css({padding:"10px",overflow:"auto"})},handle_refresh:function(t){t&&o.inArray("history",t)>-1&&top.Galaxy&&top.Galaxy.currHistoryPanel&&top.Galaxy.currHistoryPanel.loadCurrentHistory()},init_grid:function(e){this.grid.set(e);var a=this.grid.attributes;this.allow_title_display&&a.title&&t.setWindowTitle(a.title),this.handle_refresh(a.refresh_frames);var n=this.grid.get("url_base");if(n=n.replace(/^.*\/\/[^\/]+/,""),this.grid.set("url_base",n),this.$el.html(i.grid(a)),this.$el.find("#grid-table-header").html(i.header(a)),this.$el.find("#grid-table-body").html(i.body(a)),this.$el.find("#grid-table-footer").html(i.footer(a)),a.message){this.$el.find("#grid-message").html(i.message(a));var s=this;a.use_hide_message&&setTimeout(function(){s.$el.find("#grid-message").html("")},5e3)}this.init_grid_elements(),this.init_grid_controls(),init_refresh_on_change()},init_grid_controls:function(){var t=this;this.$el.find(".operation-button").each(function(){o(this).off(),o(this).click(function(){return t.submit_operation(this),!1})}),this.$el.find("input[type=text]").each(function(){o(this).off(),o(this).click(function(){o(this).select()}).keyup(function(){o(this).css("font-style","normal")})}),this.$el.find(".sort-link").each(function(){o(this).off(),o(this).click(function(){return t.set_sort_condition(o(this).attr("sort_key")),!1})}),this.$el.find(".text-filter-form").each(function(){o(this).off(),o(this).submit(function(){var e=o(this).attr("column_key"),i=o("#input-"+e+"-filter"),a=i.val();return i.val(""),t.add_filter_condition(e,a),!1})}),this.$el.find(".text-filter-val > a").each(function(){o(this).off(),o(this).click(function(){return o(this).parent().remove(),t.remove_filter_condition(o(this).attr("filter_key"),o(this).attr("filter_val")),!1})}),this.$el.find(".categorical-filter > a").each(function(){o(this).off(),o(this).click(function(){return t.set_categorical_filter(o(this).attr("filter_key"),o(this).attr("filter_val")),!1})}),this.$el.find(".advanced-search-toggle").each(function(){o(this).off(),o(this).click(function(){return t.$el.find("#standard-search").slideToggle("fast"),t.$el.find("#advanced-search").slideToggle("fast"),!1})}),this.$el.find("#check_all").off(),this.$el.find("#check_all").on("click",function(){t.check_all_items()})},init_grid_elements:function(){this.$el.find(".grid").each(function(){var t=o(this).find("input.grid-row-select-checkbox"),e=o(this).find("span.grid-selected-count"),i=function(){e.text(o(t).filter(":checked").length)};o(t).each(function(){o(this).change(i)}),i()}),0!==this.$el.find(".community_rating_star").length&&this.$el.find(".community_rating_star").rating({});var t=this.grid.attributes,e=this;this.$el.find(".page-link > a").each(function(){o(this).click(function(){return e.set_page(o(this).attr("page_num")),!1})}),this.$el.find(".use-target").each(function(){o(this).click(function(t){return e.execute({href:o(this).attr("href"),target:o(this).attr("target")}),!1})});var i=t.items.length;0!=i&&l.each(t.items,function(i,n){var s=e.$("#grid-"+n+"-popup").off(),r=new a(s);l.each(t.operations,function(t){e._add_operation(r,t,i)})})},_add_operation:function(t,e,i){var a=this,n=i.operation_config[e.label];n.allowed&&e.allow_popup&&t.addItem({html:e.label,href:n.url_args,target:n.target,confirmation_text:e.confirm,func:function(t){t.preventDefault();var n=o(t.target).html();e.onclick?e.onclick(i.encode_id):a.execute(this.findItemByHtml(n))}})},add_filter_condition:function(t,e){if(""===e)return!1;this.grid.add_filter(t,e,!0);var a=o(i.filter_element(t,e)),n=this;a.click(function(){o(this).remove(),n.remove_filter_condition(t,e)});var s=this.$el.find("#"+t+"-filtering-criteria");s.append(a),this.go_page_one(),this.execute()},remove_filter_condition:function(t,e){this.grid.remove_filter(t,e),this.go_page_one(),this.execute()},set_sort_condition:function(t){var e=this.grid.get("sort_key"),i=t;e.indexOf(t)!==-1&&"-"!==e.substring(0,1)&&(i="-"+t),this.$el.find(".sort-arrow").remove();var a="-"==i.substring(0,1)?"&uarr;":"&darr;",n=o("<span>"+a+"</span>").addClass("sort-arrow");this.$el.find("#"+t+"-header").append(n),this.grid.set("sort_key",i),this.go_page_one(),this.execute()},set_categorical_filter:function(t,e){var i=this.grid.get("categorical_filters")[t],a=this.grid.get("filters")[t],n=this;this.$el.find("."+t+"-filter").each(function(){var s=o.trim(o(this).text()),r=i[s],l=r[t];if(l==e)o(this).empty(),o(this).addClass("current-filter"),o(this).append(s);else if(l==a){o(this).empty();var h=o('<a href="#">'+s+"</a>");h.click(function(){n.set_categorical_filter(t,l)}),o(this).removeClass("current-filter"),o(this).append(h)}}),this.grid.add_filter(t,e),this.go_page_one(),this.execute()},set_page:function(t){var e=this;this.$el.find(".page-link").each(function(){var i,a=o(this).attr("id"),n=parseInt(a.split("-")[2],10),s=e.grid.get("cur_page");if(n===t)i=o(this).children().text(),o(this).empty(),o(this).addClass("inactive-link"),o(this).text(i);else if(n===s){i=o(this).text(),o(this).empty(),o(this).removeClass("inactive-link");var r=o('<a href="#">'+i+"</a>");r.click(function(){e.set_page(n)}),o(this).append(r)}}),"all"===t?this.grid.set("cur_page",t):this.grid.set("cur_page",parseInt(t,10)),this.execute()},submit_operation:function(t,e){var i=o(t).val(),a=this.$el.find('input[name="id"]:checked').length;if(!a>0)return!1;var n=l.findWhere(this.grid.attributes.operations,{label:i});n&&!e&&(e=n.confirm||"");var s=[];this.$el.find("input[name=id]:checked").each(function(){s.push(o(this).val())});var r={operation:i,id:s,confirmation_text:e};return"top"==n.target&&(r=l.extend(r,{href:n.href,target:n.target})),this.execute(r),!0},check_all_items:function(){var t=this.$(".grid-row-select-checkbox"),e=this.$("#check_all").prop("checked");l.each(t,function(t){o(t).prop("checked",e)}),this.init_grid_elements()},go_page_one:function(){var t=this.grid.get("cur_page");null!==t&&void 0!==t&&"all"!==t&&this.grid.set("cur_page",1)},execute:function(t){var e=null,i=null,a=null,n=null,s=null;if(t&&(i=t.href,a=t.operation,e=t.id,n=t.confirmation_text,s=t.target,void 0!==i&&i.indexOf("operation=")!=-1)){var r=i.split("?");if(r.length>1)for(var l=r[1],h=l.split("&"),d=0;d<h.length;d++)h[d].indexOf("operation")!=-1?(a=h[d].split("=")[1],a=a.replace(/\+/g," ")):h[d].indexOf("id")!=-1&&(e=h[d].split("=")[1])}return a&&e?!(n&&""!=n&&"None"!=n&&"null"!=n&&!confirm(n))&&(a=a.toLowerCase(),this.grid.set({operation:a,item_ids:e}),"top"==s?window.top.location=i+"?"+o.param(this.grid.get_url_data()):this.grid.can_async_op(a)||this.dict_format?this.update_grid():this.go_to(s,i),!1):i?(this.go_to(s,i),!1):(this.grid.get("async")||this.dict_format?this.update_grid():this.go_to(s,i),!1)},go_to:function(t,e){var i=this.grid.get("async");this.grid.set("async",!1);var a=this.$el.find("#advanced-search").is(":visible");switch(this.grid.set("advanced_search",a),e||(e=this.grid.get("url_base")+"?"+o.param(this.grid.get_url_data())),this.grid.set({operation:void 0,item_ids:void 0,async:i}),t){case"inbound":var n=o(".grid-header").closest(".inbound");if(0!==n.length)return void n.load(e);break;case"top":window.top.location=e;break;default:window.location=e}},update_grid:function(){var t=this.grid.get("operation")?"POST":"GET";this.$el.find(".loading-elt-overlay").show();var e=this;o.ajax({type:t,url:e.grid.get("url_base"),data:e.grid.get_url_data(),error:function(t){alert("Grid refresh failed")},success:function(t){var i=e.grid.get("embedded"),a=e.grid.get("insert"),n=e.$el.find("#advanced-search").is(":visible"),s=e.dict_format?t:o.parseJSON(t);s.embedded=i,s.insert=a,s.advanced_search=n,e.init_grid(s),e.$el.find(".loading-elt-overlay").hide()},complete:function(){e.grid.set({operation:void 0,item_ids:void 0})}})}})}.apply(e,a),!(void 0!==n&&(t.exports=n))}).call(e,i(1),i(2),i(1),i(3))},function(t,e,i){var a,n;(function(s,r){a=[i(4),i(9),i(5)],n=function(t,e,i){var a=s.View.extend({initialize:function(t){var a=this;this.options=t,this.name=t.name||"element",this.multiple=t.multiple||!1,this.message=new i.Message,this.portlet=new e.View({cls:"ui-portlet-section"}),this.select=new i.Select.View({optional:t.optional}),this.button=new i.ButtonIcon({icon:"fa fa-sign-in",tooltip:"Insert new "+this.name,onclick:function(){a.add({id:a.select.value(),name:a.select.text()})}}),this.setElement(this._template(t)),this.$(".ui-list-message").append(this.message.$el),this.$(".ui-list-portlet").append(this.portlet.$el),this.$(".ui-list-button").append(this.button.$el),this.$(".ui-list-select").append(this.select.$el)},value:function(t){if(void 0!==t){if(this.portlet.empty(),r.isArray(t))for(var e in t){var i=t[e],a=null,n=null;"string"!=r.type(i)?(a=i.id,n=i.name):a=n=i,null!=a&&this.add({id:a,name:n})}this._refresh()}var s=[];return this.$(".ui-list-id").each(function(){s.push({id:r(this).prop("id"),name:r(this).find(".ui-list-name").html()})}),0==s.length?null:s},add:function(e){var i=this;if(0===this.$('[id="'+e.id+'"]').length)if(t.isEmpty(e.id))this.message.update({message:"Please select a valid "+this.name+".",status:"danger"});else{var a=r(this._templateRow({id:e.id,name:e.name}));a.on("click",function(){a.remove(),i._refresh()}),a.on("mouseover",function(){a.addClass("portlet-highlight")}),a.on("mouseout",function(){a.removeClass("portlet-highlight")}),this.portlet.append(a),this._refresh()}else this.message.update({message:"This "+this.name+" is already in the list."})},update:function(t){this.select.update(t)},_refresh:function(){this.$(".ui-list-id").length>0?(!this.multiple&&this.button.disable(),this.$(".ui-list-portlet").show()):(this.button.enable(),this.$(".ui-list-portlet").hide()),this.options.onchange&&this.options.onchange()},_template:function(t){return'<div class="ui-list"><div class="ui-margin-top"><span class="ui-list-button"/><span class="ui-list-select"/></div><div class="ui-list-message"/><div class="ui-list-portlet"/></div>'},_templateRow:function(t){return'<div id="'+t.id+'" class="ui-list-id"><span class="ui-list-delete fa fa-trash"/><span class="ui-list-name">'+t.name+"</span></div>"}});return{View:a}}.apply(e,a),!(void 0!==n&&(t.exports=n))}).call(e,i(2),i(1))},function(t,e,i){var a,n;(function(s,r,o){a=[i(4),i(11)],n=function(t,e){var i=s.View.extend({initialize:function(e){var i=this;this.model=e&&e.model||new s.Model({visible:!0,data:[],id:t.uid(),error_text:"No options available.",wait_text:"Please wait...",multiple:!1,optional:!1,onchange:function(){}}).set(e),this.listenTo(this.model,"change:value",this._changeValue,this),this.listenTo(this.model,"change:wait",this._changeWait,this),this.listenTo(this.model,"change:data",this._changeData,this),this.listenTo(this.model,"change:visible",this._changeVisible,this),this.on("change",function(){i.model.get("onchange")(i.value())}),this.render()},render:function(){var t=this;this.$el.empty().removeClass().addClass("ui-options").append(this.$message=r("<div/>")).append(this.$menu=r("<div/>").addClass("ui-options-menu")).append(this.$options=r(this._template())),this.all_button=null,this.model.get("multiple")&&(this.all_button=new e.ButtonCheck({onclick:function(){t.$("input").prop("checked",0!==t.all_button.value()),t.value(t._getValue()),t.trigger("change")}}),this.$menu.append(this.all_button.$el)),this._changeData(),this._changeWait(),this._changeVisible()},update:function(t){this.model.set("data",t)},_changeData:function(){var t=this;this.$options.empty(),this._templateOptions?this.$options.append(this._templateOptions(this.model.get("data"))):o.each(this.model.get("data"),function(e){t.$options.append(r(t._templateOption(e)).addClass("ui-option").tooltip({title:e.tooltip,placement:"bottom"}))});var t=this;this.$("input").on("change",function(){t.value(t._getValue()),t.trigger("change")}),this._changeValue(),this._changeWait()},_changeVisible:function(){this.$el[this.model.get("visible")?"show":"hide"]()},_changeWait:function(){this.model.get("wait")?0===this.length()&&(this._messageShow(this.model.get("wait_text"),"info"),this.$options.hide(),this.$menu.hide()):0===this.length()?(this._messageShow(this.model.get("error_text"),"danger"),this.$options.hide(),this.$menu.hide()):(this.$message.hide(),this.$options.css("display","inline-block"),this.$menu.show())},_changeValue:function(){this._setValue(this.model.get("value")),null!==this._getValue()||this.model.get("multiple")||this.model.get("optional")||this._setValue(this.first()),this.all_button&&this.all_button.value(r.isArray(this._getValue())?this._getValue().length:0,this.length())},value:function(t){return void 0!==t&&this.model.set("value",t),this._getValue()},first:function(){var t=this.$("input").first();return t.length>0?t.val():null},wait:function(){this.model.set("wait",!0)},unwait:function(){this.model.set("wait",!1)},length:function(){return this.$(".ui-option").length},_setValue:function(t){var e=this;if(void 0!==t&&(this.$("input").prop("checked",!1),null!==t)){var i=r.isArray(t)?t:[t];o.each(i,function(t){e.$('input[value="'+t+'"]').first().prop("checked",!0)})}},_getValue:function(){var e=[];return this.$(":checked").each(function(){e.push(r(this).val())}),t.isEmpty(e)?null:this.model.get("multiple")?e:e[0]},_messageShow:function(t,e){this.$message.show().removeClass().addClass("ui-message alert alert-"+e).html(t)},_template:function(){return r("<div/>").addClass("ui-options-list")}}),a=i.extend({_templateOption:function(e){var i=t.uid();return r("<div/>").addClass("ui-option").append(r("<input/>").attr({id:i,type:this.model.get("type"),name:this.model.id,value:e.value})).append(r("<label/>").addClass("ui-options-label").attr("for",i).html(e.label))}}),n={};n.View=a.extend({initialize:function(t){t.type="radio",
a.prototype.initialize.call(this,t)}});var l={};l.View=a.extend({initialize:function(t){t.type="checkbox",t.multiple=!0,a.prototype.initialize.call(this,t)}});var h={};return h.View=i.extend({initialize:function(t){i.prototype.initialize.call(this,t)},_setValue:function(t){void 0!==t&&(this.$("input").prop("checked",!1),this.$("label").removeClass("active"),this.$('[value="'+t+'"]').prop("checked",!0).closest("label").addClass("active"))},_templateOption:function(t){var e=r("<label/>").addClass("btn btn-default");return t.icon&&e.append(r("<i/>").addClass("fa").addClass(t.icon).addClass(!t.label&&"no-padding")),e.append(r("<input/>").attr({type:"radio",name:this.model.id,value:t.value})),t.label&&e.append(t.label),e},_template:function(){return r("<div/>").addClass("btn-group ui-radiobutton").attr("data-toggle","buttons")}}),{Base:i,BaseIcons:a,Radio:n,RadioButton:h,Checkbox:l}}.apply(e,a),!(void 0!==n&&(t.exports=n))}).call(e,i(2),i(1),i(3))},function(t,e,i){var a,n;(function(s,r,o){a=[i(4),i(11)],n=function(t,e){var i=s.View.extend({initialize:function(e){var i=this;this.data=[],this.data2=[],this.model=e&&e.model||new s.Model({id:t.uid(),cls:"ui-select",error_text:"No options available",empty_text:"Nothing selected",visible:!0,wait:!1,multiple:!1,searchable:!0,optional:!1,disabled:!1,onchange:function(){},value:null,individual:!1,pagesize:20}).set(e),this.on("change",function(){i.model.get("onchange")&&i.model.get("onchange")(i.value())}),this.listenTo(this.model,"change:data",this._changeData,this),this.listenTo(this.model,"change:disabled",this._changeDisabled,this),this.listenTo(this.model,"change:wait",this._changeWait,this),this.listenTo(this.model,"change:visible",this._changeVisible,this),this.listenTo(this.model,"change:value",this._changeValue,this),this.listenTo(this.model,"change:multiple change:searchable change:cls change:id",this.render,this),this.render()},render:function(){var t=this;this.model.get("searchable")?this._renderSearchable():this._renderClassic(),this.$el.addClass(this.model.get("cls")).attr("id",this.model.get("id")),this.$select.empty().addClass("select").attr("id",this.model.get("id")+"_select").prop("multiple",this.model.get("multiple")).on("change",function(){t.value(t._getValue()),t.trigger("change")}),this._changeData(),this._changeWait(),this._changeVisible(),this._changeDisabled()},_renderClassic:function(){var t=this;this.$el.addClass(this.model.get("multiple")?"ui-select-multiple":"ui-select").append(this.$select=r("<select/>")).append(this.$dropdown=r("<div/>")).append(this.$resize=r("<div/>").append(this.$resize_icon=r("<i/>"))),this.model.get("multiple")?(this.$dropdown.hide(),this.$resize_icon.addClass("fa fa-angle-double-right fa-rotate-45").show(),this.$resize.removeClass().addClass("icon-resize").show().off("mousedown").on("mousedown",function(e){var i=e.pageY,a=t.$select.height();t.minHeight=t.minHeight||a,r("#dd-helper").show().on("mousemove",function(e){t.$select.height(Math.max(a+(e.pageY-i),t.minHeight))}).on("mouseup mouseleave",function(){r("#dd-helper").hide().off()})})):(this.$dropdown.show(),this.$resize.hide(),this.$resize_icon.hide())},_renderSearchable:function(){var t=this;this.$el.append(this.$select=r("<div/>")).append(this.$dropdown=r("<div/>")),this.$dropdown.hide(),this.model.get("multiple")||this.$dropdown.show().on("click",function(){t.$select.select2&&t.$select.select2("open")}),this.all_button=null,this.model.get("multiple")&&!this.model.get("individual")&&(this.all_button=new e.ButtonCheck({onclick:function(){var e=[];0!==t.all_button.value()&&o.each(t.model.get("data"),function(t){e.push(t.value)}),t.value(e),t.trigger("change")}}),this.$el.prepend(this.all_button.$el))},_match:function(t,e){return!t||""==t||String(e).toUpperCase().indexOf(t.toUpperCase())>=0},_changeData:function(){var t=this;this.data=[],!this.model.get("multiple")&&this.model.get("optional")&&this.data.push({value:"__null__",label:t.model.get("empty_text")}),o.each(this.model.get("data"),function(e){t.data.push(e)}),0==this.length()&&this.data.push({value:"__null__",label:this.model.get("error_text")}),this.model.get("searchable")?(this.data2=[],o.each(this.data,function(e,i){t.data2.push({order:i,id:e.value,text:e.label,tags:e.tags})}),this.$select.data("select2")&&this.$select.select2("destroy"),this.matched_tags={},this.$select.select2({data:t.data2,closeOnSelect:!this.model.get("multiple"),multiple:this.model.get("multiple"),query:function(e){t.matched_tags={};var i=t.model.get("pagesize"),a=o.filter(t.data2,function(i){var a=!1;return o.each(i.tags,function(i){t._match(e.term,i)&&(a=t.matched_tags[i]=!0)}),a||t._match(e.term,i.text)});e.callback({results:a.slice((e.page-1)*i,e.page*i),more:a.length>=e.page*i})},formatResult:function(e){return o.escape(e.text)+'<div class="ui-tags">'+o.reduce(e.tags,function(e,i){return t.matched_tags[i]?e+'&nbsp;<div class="label label-info">'+o.escape(i)+"</div>":e},"")+"</div>"}}),this.$(".select2-container .select2-search input").off("blur")):(this.$select.find("option").remove(),o.each(this.data,function(e){t.$select.append(r("<option/>").attr("value",e.value).html(o.escape(e.label)))})),this.model.set("disabled",0==this.length()),this._changeValue()},_changeDisabled:function(){this.model.get("searchable")?this.$select.select2(this.model.get("disabled")?"disable":"enable"):this.$select.prop("disabled",this.model.get("disabled"))},_changeWait:function(){this.$dropdown.removeClass().addClass("icon-dropdown fa").addClass(this.model.get("wait")?"fa-spinner fa-spin":"fa-caret-down")},_changeVisible:function(){this.$el[this.model.get("visible")?"show":"hide"](),this.$select[this.model.get("visible")?"show":"hide"]()},_changeValue:function(){if(this._setValue(this.model.get("value")),this.model.get("multiple")){if(this.all_button){var t=this._getValue();this.all_button.value(r.isArray(t)?t.length:0,this.length())}}else null!==this._getValue()||this.model.get("optional")||this._setValue(this.first())},value:function(t){return void 0!==t&&this.model.set("value",t),this._getValue()},first:function(){return this.data.length>0?this.data[0].value:null},exists:function(t){return o.findWhere(this.data,{value:t})},text:function(){var t=this._getValue(),e=this.exists(r.isArray(t)?t[0]:t);return e?e.label:""},show:function(){this.model.set("visible",!0)},hide:function(){this.model.set("visible",!1)},wait:function(){this.model.set("wait",!0)},unwait:function(){this.model.set("wait",!1)},disabled:function(){return this.model.get("disabled")},enable:function(){this.model.set("disabled",!1)},disable:function(){this.model.set("disabled",!0)},add:function(t,e){o.each(this.model.get("data"),function(e){e.keep&&!o.findWhere(t,{value:e.value})&&t.push(e)}),e&&t&&t.sort(e),this.model.set("data",t)},update:function(t){this.model.set("data",t)},setOnChange:function(t){this.model.set("onchange",t)},length:function(){return r.isArray(this.model.get("data"))?this.model.get("data").length:0},_setValue:function(t){var e=this;if(null!==t&&void 0!==t||(t="__null__"),this.model.get("multiple")?t=r.isArray(t)?t:[t]:r.isArray(t)&&(t=t.length>0?t[0]:"__null__"),this.model.get("searchable")){if(r.isArray(t)){var i=[];o.each(t,function(t){var a=o.findWhere(e.data2,{id:t});a&&i.push(a)}),t=i}else{var a=o.findWhere(this.data2,{id:t});t=a}this.$select.select2("data",t)}else this.$select.val(t)},_getValue:function(){var e=null;if(this.model.get("searchable")){var i=this.$select.select2("data");i&&(r.isArray(i)?(e=[],i.sort(function(t,e){return t.order-e.order}),o.each(i,function(t){e.push(t.id)})):e=i.id)}else e=this.$select.val();return t.isEmpty(e)?null:e}});return{View:i}}.apply(e,a),!(void 0!==n&&(t.exports=n))}).call(e,i(2),i(1),i(3))},function(t,e,i){var a,n;(function(s,r,o){a=[i(8),i(48),i(20)],n=function(t,e,i){var a=s.Model.extend({}),n=s.Model.extend({defaults:{id:"",type:"",name:"",hda_ldda:"hda",metadata:null},initialize:function(){this.get("metadata")||this._set_metadata(),this.on("change",this._set_metadata,this)},_set_metadata:function(){var t=new a;r.each(r.keys(this.attributes),function(e){if(0===e.indexOf("metadata_")){var i=e.split("metadata_")[1];t.set(i,this.attributes[e]),delete this.attributes[e]}},this),this.set("metadata",t,{silent:!0})},get_metadata:function(t){return this.attributes.metadata.get(t)},urlRoot:Galaxy.root+"api/datasets"}),l=n.extend({defaults:r.extend({},n.prototype.defaults,{chunk_url:null,first_data_chunk:null,offset:0,at_eof:!1}),initialize:function(t){n.prototype.initialize.call(this),this.attributes.first_data_chunk&&(this.attributes.offset=this.attributes.first_data_chunk.offset),this.attributes.chunk_url=Galaxy.root+"dataset/display?dataset_id="+this.id,this.attributes.url_viz=Galaxy.root+"visualization"},get_next_chunk:function(){if(this.attributes.at_eof)return null;var t=this,e=o.Deferred();return o.getJSON(this.attributes.chunk_url,{offset:t.attributes.offset}).success(function(i){var a;""!==i.ck_data?(a=i,t.attributes.offset=i.offset):(t.attributes.at_eof=!0,a=null),e.resolve(a)}),e}}),h=s.Collection.extend({model:n}),d=s.View.extend({initialize:function(t){this.row_count=0,this.loading_chunk=!1,new g({model:t.model,$el:this.$el})},expand_to_container:function(){this.$el.height()<this.scroll_elt.height()&&this.attempt_to_fetch()},attempt_to_fetch:function(t){var e=this;!this.loading_chunk&&this.scrolled_to_bottom()&&(this.loading_chunk=!0,this.loading_indicator.show(),o.when(e.model.get_next_chunk()).then(function(t){t&&(e._renderChunk(t),e.loading_chunk=!1),e.loading_indicator.hide(),e.expand_to_container()}))},render:function(){this.loading_indicator=o("<div/>").attr("id","loading_indicator"),this.$el.append(this.loading_indicator);var t=o("<table/>").attr({id:"content_table",cellpadding:0});this.$el.append(t);var e=this.model.get_metadata("column_names"),i=o("<thead/>").appendTo(t),a=o("<tr/>").appendTo(i);if(e)a.append("<th>"+e.join("</th><th>")+"</th>");else for(var n=1;n<=this.model.get_metadata("columns");n++)a.append("<th>"+n+"</th>");var s=this,r=this.model.get("first_data_chunk");r?this._renderChunk(r):o.when(s.model.get_next_chunk()).then(function(t){s._renderChunk(t)}),this.scroll_elt.scroll(function(){s.attempt_to_fetch()})},scrolled_to_bottom:function(){return!1},_renderCell:function(t,e,i){var a=o("<td>").text(t),n=this.model.get_metadata("column_types");return void 0!==i?a.attr("colspan",i).addClass("stringalign"):n&&e<n.length&&("str"!==n[e]&&"list"!==n[e]||a.addClass("stringalign")),a},_renderRow:function(t){var e=t.split("\t"),i=o("<tr>"),a=this.model.get_metadata("columns");return this.row_count%2!==0&&i.addClass("dark_row"),e.length===a?r.each(e,function(t,e){i.append(this._renderCell(t,e))},this):e.length>a?(r.each(e.slice(0,a-1),function(t,e){i.append(this._renderCell(t,e))},this),i.append(this._renderCell(e.slice(a-1).join("\t"),a-1))):1===e.length?i.append(this._renderCell(t,0,a)):(r.each(e,function(t,e){i.append(this._renderCell(t,e))},this),r.each(r.range(a-e.length),function(){i.append(o("<td>"))})),this.row_count++,i},_renderChunk:function(t){var e=this.$el.find("table");r.each(t.ck_data.split("\n"),function(t,i){""!==t&&e.append(this._renderRow(t))},this)}}),c=d.extend({initialize:function(t){d.prototype.initialize.call(this,t);var e=r.find(this.$el.parents(),function(t){return"auto"===o(t).css("overflow")});e||(e=window),this.scroll_elt=o(e)},scrolled_to_bottom:function(){return this.$el.height()-this.scroll_elt.scrollTop()-this.scroll_elt.height()<=0}}),u=d.extend({initialize:function(t){d.prototype.initialize.call(this,t),this.scroll_elt=this.$el.css({position:"relative",overflow:"scroll",height:t.height||"500px"})},scrolled_to_bottom:function(){return this.$el.scrollTop()+this.$el.innerHeight()>=this.el.scrollHeight}}),g=s.View.extend({col:{chrom:null,start:null,end:null},url_viz:null,dataset_id:null,genome_build:null,file_ext:null,initialize:function(t){function e(t,e){for(var i=0;i<e.length;i++)if(e[i].match(t))return i;return-1}var a=parent.Galaxy;if(a&&a.modal&&(this.modal=a.modal),a&&a.frame&&(this.frame=a.frame),this.modal&&this.frame){var n=t.model,s=n.get("metadata");if(n.get("file_ext")){if(this.file_ext=n.get("file_ext"),"bed"==this.file_ext){if(!(s.get("chromCol")&&s.get("startCol")&&s.get("endCol")))return void console.log("TabularButtonTrackster : Bed-file metadata incomplete.");this.col.chrom=s.get("chromCol")-1,this.col.start=s.get("startCol")-1,this.col.end=s.get("endCol")-1}if("vcf"==this.file_ext&&(this.col.chrom=e("Chrom",s.get("column_names")),this.col.start=e("Pos",s.get("column_names")),this.col.end=null,this.col.chrom==-1||this.col.start==-1))return void console.log("TabularButtonTrackster : VCF-file metadata incomplete.");if(void 0!==this.col.chrom){if(!n.id)return void console.log("TabularButtonTrackster : Dataset identification is missing.");if(this.dataset_id=n.id,!n.get("url_viz"))return void console.log("TabularButtonTrackster : Url for visualization controller is missing.");this.url_viz=n.get("url_viz"),n.get("genome_build")&&(this.genome_build=n.get("genome_build"));var r=new i.IconButtonView({model:new i.IconButton({title:"Visualize",icon_class:"chart_curve",id:"btn_viz"})});this.setElement(t.$el),this.$el.append(r.render().$el),this.hide()}}}},events:{"mouseover tr":"show",mouseleave:"hide"},show:function(t){function e(t){return!isNaN(parseFloat(t))&&isFinite(t)}var i=this;if(null!==this.col.chrom){var a=o(t.target).parent(),n=a.children().eq(this.col.chrom).html(),s=a.children().eq(this.col.start).html(),r=this.col.end?a.children().eq(this.col.end).html():s;if(!n.match("^#")&&""!==n&&e(s)){var l={dataset_id:this.dataset_id,gene_region:n+":"+s+"-"+r},h=a.offset(),d=h.left-10,c=h.top-o(window).scrollTop()+3;o("#btn_viz").css({position:"fixed",top:c+"px",left:d+"px"}),o("#btn_viz").off("click"),o("#btn_viz").click(function(){i.frame.add({title:"Trackster",url:i.url_viz+"/trackster?"+o.param(l)})}),o("#btn_viz").show()}else o("#btn_viz").hide()}},hide:function(){this.$("#btn_viz").hide()}}),f=function(t){t.model||(t.model=new l(t.dataset_config));var e=t.parent_elt,i=t.embedded;delete t.embedded,delete t.parent_elt,delete t.dataset_config;var a=i?new u(t):new c(t);return a.render(),e&&(e.append(a.$el),a.expand_to_container()),a};return{Dataset:n,TabularDataset:l,DatasetCollection:h,TabularDatasetChunkedView:d,createTabularDatasetChunkedView:f}}.apply(e,a),!(void 0!==n&&(t.exports=n))}).call(e,i(2),i(3),i(1))},,function(t,e,i){var a,n;(function(i,s,r,o){a=[],n=function(){var t=i.View.extend({initialize:function(t,e){this.$button=t,this.$button.length||(this.$button=s("<div/>")),this.options=e||[],this.$button.data("popupmenu",this);var i=this;this.$button.click(function(t){return s(".popmenu-wrapper").remove(),i._renderAndShow(t),!1})},_renderAndShow:function(t){this.render(),this.$el.appendTo("body").css(this._getShownPosition(t)).show(),this._setUpCloseBehavior()},render:function(){if(this.$el.addClass("popmenu-wrapper").hide().css({position:"absolute"}).html(this.template(this.$button.attr("id"),this.options)),this.options.length){var t=this;this.$el.find("li").each(function(e,i){var a=t.options[e];a.func&&s(this).children("a.popupmenu-option").click(function(e){a.func.call(t,e,a),e.preventDefault()})})}return this},template:function(t,e){return['<ul id="',t,'-menu" class="dropdown-menu">',this._templateOptions(e),"</ul>"].join("")},_templateOptions:function(t){return t.length?r.map(t,function(t){if(t.divider)return'<li class="divider"></li>';if(t.header)return['<li class="head"><a href="javascript:void(0);">',t.html,"</a></li>"].join("");var e=t.href||"javascript:void(0);",i=t.target?' target="'+t.target+'"':"",a=t.checked?'<span class="fa fa-check"></span>':"";return['<li><a class="popupmenu-option" href="',e,'"',i,">",a,t.html,"</a></li>"].join("")}).join(""):"<li>(no options)</li>"},_getShownPosition:function(t){var e=this.$el.width(),i=t.pageX-e/2;return i=Math.min(i,s(document).scrollLeft()+s(window).width()-e-5),i=Math.max(i,s(document).scrollLeft()+5),{top:t.pageY,left:i}},_setUpCloseBehavior:function(){function t(t){if(s(document).off("click.close_popup"),window&&window.parent!==window)try{s(window.parent.document).off("click.close_popup")}catch(t){}else try{s("iframe#galaxy_main").contents().off("click.close_popup")}catch(t){}e.remove()}var e=this;if(s("html").one("click.close_popup",t),window&&window.parent!==window)try{s(window.parent.document).find("html").one("click.close_popup",t)}catch(t){}else try{s("iframe#galaxy_main").contents().one("click.close_popup",t)}catch(t){}},addItem:function(t,e){return e=e>=0?e:this.options.length,this.options.splice(e,0,t),this},removeItem:function(t){return t>=0&&this.options.splice(t,1),this},findIndexByHtml:function(t){for(var e=0;e<this.options.length;e++)if(r.has(this.options[e],"html")&&this.options[e].html===t)return e;return null},findItemByHtml:function(t){return this.options[this.findIndexByHtml(t)]},toString:function(){return"PopupMenu"}});return t.create=function(e,i){return new t(e,i)},t.make_popupmenu=function(e,i){var a=[];return r.each(i,function(t,e){var i={html:e};null===t?i.header=!0:"function"===o.type(t)&&(i.func=t),a.push(i)}),new t(s(e),a)},t.convertLinksToOptions=function(t,e){t=s(t),e=e||"a";var i=[];return t.find(e).each(function(t,e){var a={},n=s(t);if(a.html=n.text(),n.attr("href")){var r=n.attr("href"),o=n.attr("target"),l=n.attr("confirm");a.func=function(){if(!l||confirm(l))switch(o){case"_parent":window.parent.location=r;break;case"_top":window.top.location=r;break;default:window.location=r}}}i.push(a)}),i},t.fromExistingDom=function(e,i,a){e=s(e),i=s(i);var n=t.convertLinksToOptions(i,a);return i.remove(),new t(e,n)},t.make_popup_menus=function(e,i,a){e=e||document,i=i||"div[popupmenu]",a=a||function(t,e){return"#"+t.attr("popupmenu")};var n=[];return s(e).find(i).each(function(){var i=s(this),r=s(e).find(a(i,e));n.push(t.fromDom(r,i)),r.addClass("popup")}),n},t}.apply(e,a),!(void 0!==n&&(t.exports=n))}).call(e,i(2),i(1),i(3),i(1))},function(t,e,i){var a,n;(function(s,r,o){a=[i(4)],n=function(t){var e=s.Model.extend({initialize:function(t){this.app=t},checksum:function(){var t="",e=this;return this.app.section.$el.find(".section-row").each(function(){var i=r(this).attr("id"),a=e.app.field_list[i];a&&(t+=i+":"+JSON.stringify(a.value&&a.value())+":"+a.collapsed+";")}),t},create:function(){function t(t,e,i){a.flat_dict[t]=e,s[t]=i,a.app.element_list[e]&&a.app.element_list[e].$el.attr("tour_id",t)}function e(n,s){for(var r in s){var o=s[r];if(o.input){var l=o.input,h=n;switch(""!=n&&(h+="|"),h+=l.name,l.type){case"repeat":var d="section-",c=[],u=null;for(var g in o){var f=g.indexOf(d);f!=-1&&(f+=d.length,c.push(parseInt(g.substr(f))),u||(u=g.substr(0,f)))}c.sort(function(t,e){return t-e});var r=0;for(var _ in c)e(h+"_"+r++,o[u+c[_]]);break;case"conditional":var p=a.app.field_list[l.id].value();t(h+"|"+l.test_param.name,l.id,p);var v=i(l,p);v!=-1&&e(h,s[l.id+"-section-"+v]);break;case"section":e(!l.flat&&h||"",o);break;default:var m=a.app.field_list[l.id];if(m&&m.value){var p=m.value();if((void 0===l.ignore||l.ignore!=p)&&(m.collapsed&&l.collapsible_value&&(p=l.collapsible_value),t(h,l.id,p),l.payload))for(var b in l.payload)t(b,l.id,l.payload[b])}}}}}var a=this,n={};this._iterate(this.app.section.$el,n);var s={};return this.flat_dict={},e("",n),s},match:function(t){return this.flat_dict&&this.flat_dict[t]},matchCase:function(t,e){return i(t,e)},matchModel:function(t,e){var i=this;a(t.inputs,function(t,a){i.flat_dict[a]&&e(t,i.flat_dict[a])})},matchResponse:function(t){function e(t,n){if("string"==typeof n){var s=a.flat_dict[t];s&&(i[s]=n)}else for(var r in n){var o=r;if(""!==t){var l="|";n instanceof Array&&(l="_"),o=t+l+o}e(o,n[r])}}var i={},a=this;return e("",t),i},_iterate:function(t,e){var i=this,a=r(t).children();a.each(function(){var t=this,a=r(t).attr("id");if(r(t).hasClass("section-row")){var n=i.app.input_list[a];e[a]=n&&{input:n}||{},i._iterate(t,e[a])}else i._iterate(t,e)})}}),i=function(t,e){"boolean"==t.test_param.type&&(e="true"==e?t.test_param.truevalue||"true":t.test_param.falsevalue||"false");for(var i in t.cases)if(t.cases[i].value==e)return i;return-1},a=function(t,e,n,s){s=r.extend(!0,{},s),o.each(t,function(t){t&&t.type&&t.name&&(s[t.name]=t)});for(var l in t){var h=t[l];h.name=h.name||l;var d=n?n+"|"+h.name:h.name;switch(h.type){case"repeat":o.each(h.cache,function(t,i){a(t,e,d+"_"+i,s)});break;case"conditional":if(h.test_param){e(h.test_param,d+"|"+h.test_param.name,s);var c=i(h,h.test_param.value);c!=-1?a(h.cases[c].inputs,e,d,s):Galaxy.emit.debug("form-data::visitInputs() - Invalid case for "+d+".")}else Galaxy.emit.debug("form-data::visitInputs() - Conditional test parameter missing for "+d+".");break;case"section":a(h.inputs,e,d,s);break;default:e(h,d,s)}}};return{Manager:e,visitInputs:a}}.apply(e,a),!(void 0!==n&&(t.exports=n))}).call(e,i(2),i(1),i(3))},function(t,e,i){var a,n;(function(i,s,r){a=[],n=function(){var t=i.Model.extend({defaults:{title:"",icon_class:"",on_click:null,menu_options:null,is_menu_button:!0,id:null,href:null,target:null,enabled:!0,visible:!0,tooltip_config:{}}}),e=i.View.extend({initialize:function(){this.model.attributes.tooltip_config={placement:"bottom"},this.model.bind("change",this.render,this)},render:function(){this.$el.tooltip("hide");var t=this.template(this.model.toJSON());return t.tooltip(this.model.get("tooltip_config")),this.$el.replaceWith(t),this.setElement(t),this},events:{click:"click"},click:function(t){return!s.isFunction(this.model.get("on_click"))||(this.model.get("on_click")(t),!1)},template:function(t){var e='title="'+t.title+'" class="icon-button';return t.is_menu_button&&(e+=" menu-button"),e+=" "+t.icon_class,t.enabled||(e+="_disabled"),e+='"',t.id&&(e+=' id="'+t.id+'"'),e+=' href="'+t.href+'"',t.target&&(e+=' target="'+t.target+'"'),t.visible||(e+=' style="display: none;"'),e=t.enabled?"<a "+e+"/>":"<span "+e+"/>",r(e)}}),a=i.Collection.extend({model:t}),n=i.View.extend({tagName:"div",initialize:function(){this.render()},render:function(){var t=this;return this.collection.each(function(e){var i=r("<a/>").attr("href","javascript:void(0)").attr("title",e.attributes.title).addClass("icon-button menu-button").addClass(e.attributes.icon_class).appendTo(t.$el).click(e.attributes.on_click);e.attributes.tooltip_config&&i.tooltip(e.attributes.tooltip_config);var a=e.get("options");a&&make_popupmenu(i,a)}),this}}),o=function(e,i){i||(i={});var r=new a(s.map(e,function(e){return new t(s.extend(e,i))}));return new n({collection:r})};return{IconButton:t,IconButtonView:e,IconButtonCollection:a,IconButtonMenuView:n,create_icon_buttons_menu:o}}.apply(e,a),!(void 0!==n&&(t.exports=n))}).call(e,i(2),i(3),i(1))},,,function(t,e,i){var a,n;(function(s,r){a=[i(4)],n=function(t){var e=s.View.extend({initialize:function(e){this.options=t.merge(e,{content:"No content available.",onchange:null,ondblclick:null,onconfirm:null,cls:"ui-table",selectable:!0,cls_tr:""}),this.setElement(this._template()),this.$thead=this.$("thead"),this.$tbody=this.$("tbody"),this.$tmessage=this.$("tmessage"),this.row=this._row(),this.row_count=0},events:{click:"_onclick",dblclick:"_ondblclick"},addHeader:function(t){this.row.append(r("<th/>").append(t))},appendHeader:function(){this.$thead.append(this.row),this.row=r("<tr/>")},add:function(t,e,i){var a=r("<td/>");e&&a.css("width",e),i&&a.css("text-align",i),this.row.append(a.append(t))},append:function(t,e){this._commit(t,e,!1)},prepend:function(t,e){this._commit(t,e,!0)},get:function(t){return this.$("#"+t)},del:function(t){var e=this.$tbody.find("#"+t);e.length>0&&(e.remove(),this.row_count--,this._refresh())},delAll:function(){this.$tbody.empty(),this.row_count=0,this._refresh()},value:function(t){if(this.options.selectable){this.before=this.$tbody.find(".current").attr("id"),void 0!==t&&(this.$tbody.find("tr").removeClass("current"),t&&this.$tbody.find("#"+t).addClass("current"));var e=this.$tbody.find(".current").attr("id");return void 0===e?null:(e!=this.before&&this.options.onchange&&this.options.onchange(t),e)}},size:function(){return this.$tbody.find("tr").length},_commit:function(t,e,i){this.del(t),this.row.attr("id",t),i?this.$tbody.prepend(this.row):this.$tbody.append(this.row),e&&(this.row.hide(),this.row.fadeIn()),this.row=this._row(),this.row_count++,this._refresh()},_row:function(){return r('<tr class="'+this.options.cls_tr+'"></tr>')},_onclick:function(t){var e=this.value(),i=r(t.target).closest("tr").attr("id");""!=i&&i&&e!=i&&(this.options.onconfirm?this.options.onconfirm(i):this.value(i))},_ondblclick:function(t){var e=this.value();e&&this.options.ondblclick&&this.options.ondblclick(e)},_refresh:function(){0==this.row_count?this.$tmessage.show():this.$tmessage.hide()},_template:function(){return'<div><table class="'+this.options.cls+'"><thead/><tbody/></table><tmessage>'+this.options.content+"</tmessage><div>"}});return{View:e}}.apply(e,a),!(void 0!==n&&(t.exports=n))}).call(e,i(2),i(1))},function(t,e,i){var a,n,s;!function(r){n=[i(1)],a=r,s="function"==typeof a?a.apply(e,n):a,!(void 0!==s&&(t.exports=s))}(function(t){"use_strict";var e=t;e.fn.make_text_editable=function(t){var i="num_cols"in t?t.num_cols:30,a="num_rows"in t?t.num_rows:4,n="use_textarea"in t&&t.use_textarea,s="on_finish"in t?t.on_finish:null,r="help_text"in t?t.help_text:null,o=e(this);return o.addClass("editable-text").click(function(r){if(!(e(this).children(":input").length>0)){o.removeClass("editable-text");var l,h,d=function(t){o.find(":input").remove(),""!==t?o.text(t):o.html("<br>"),o.addClass("editable-text"),s&&s(t)},c="cur_text"in t?t.cur_text:o.text();n?(l=e("<textarea/>").attr({rows:a,cols:i}).text(e.trim(c)).keyup(function(t){27===t.keyCode&&d(c)}),h=e("<button/>").text("Done").click(function(){return d(l.val()),!1})):l=e("<input type='text'/>").attr({value:e.trim(c),size:i}).blur(function(){d(c)}).keyup(function(t){27===t.keyCode?e(this).trigger("blur"):13===t.keyCode&&d(e(this).val()),t.stopPropagation()}),o.text(""),o.append(l),h&&o.append(h),l.focus(),l.select(),r.stopPropagation()}}),r&&o.attr("title",r).tooltip(),o}})},,,function(t,e,i){var a;(function(n,s){a=function(){function t(t){t+="";for(var e=/(\d+)(\d{3})/;e.test(t);)t=t.replace(e,"$1,$2");return t}var e=function(t){return"promise"in t},i=n.Model.extend({defaults:{ajax_settings:{},interval:1e3,success_fn:function(t){return!0}},go:function(){var t=s.Deferred(),e=this,i=e.get("ajax_settings"),a=e.get("success_fn"),n=e.get("interval"),r=function(){s.ajax(i).success(function(e){a(e)?t.resolve(e):setTimeout(r,n)})};return r(),t}}),a=function(t){t||(t="#ffffff"),"string"==typeof t&&(t=[t]);for(var e=0;e<t.length;e++)t[e]=parseInt(t[e].slice(1),16);var i,a,n,s,r,o,l,h,d,c,u,g=function(t,e,i){return(299*t+587*e+114*i)/1e3},f=function(t,e,i,a,n,s){return Math.max(t,a)-Math.min(t,a)+(Math.max(e,n)-Math.min(e,n))+(Math.max(i,s)-Math.min(i,s))},_=!1,p=0;do{for(i=Math.round(16777215*Math.random()),a=(16711680&i)>>16,n=(65280&i)>>8,s=255&i,d=g(a,n,s),_=!0,e=0;e<t.length;e++)if(r=t[e],o=(16711680&r)>>16,l=(65280&r)>>8,h=255&r,c=g(o,l,h),u=f(a,n,s,o,l,h),Math.abs(d-c)<40||u<200){_=!1;break}p++}while(!_&&p<=10);return"#"+(16777216+i).toString(16).substr(1,6)};return{commatize:t,is_deferred:e,ServerStateDeferred:i,get_random_color:a}}.call(e,i,e,t),!(void 0!==a&&(t.exports=a))}).call(e,i(2),i(1))},function(t,e,i){var a,n;(function(s,r){a=[i(56),i(7),i(6)],n=function(t,e,i){t=t||window.BibtexParser;var a="citation",n=s.Model.extend(e.LoggableMixin).extend({_logNamespace:a,defaults:{content:""},initialize:function(){var e;try{e=t(this.attributes.content)}catch(t){return}if(e.errors.length){var i=e.errors.reduce(function(t,e){return t+"; "+e});this.log("Error parsing bibtex: "+i)}if(this._fields={},this.entry=r.first(e.entries),this.entry){var a=this.entry.Fields;for(var n in a){var s=a[n],o=n.toLowerCase();this._fields[o]=s}}},entryType:function(){return this.entry?this.entry.EntryType:void 0},fields:function(){return this._fields}}),o=s.Collection.extend(e.LoggableMixin).extend({_logNamespace:a,urlRoot:Galaxy.root+"api",partial:!0,model:n}),l=o.extend({url:function(){return this.urlRoot+"/histories/"+this.history_id+"/citations"}}),h=o.extend({url:function(){return this.urlRoot+"/tools/"+this.tool_id+"/citations"},partial:!1});return{Citation:n,HistoryCitationCollection:l,ToolCitationCollection:h}}.apply(e,a),!(void 0!==n&&(t.exports=n))}).call(e,i(2),i(3))},function(t,e,i){var a,n;(function(i,s,r){a=[],n=function(){return i.View.extend({initialize:function(t,e){this.app=t,this.app_options=t.model?t.model.attributes:{},this.field=e&&e.field||new i.View,this.model=e&&e.model||new i.Model({text_enable:this.app_options.text_enable||"Enable",text_disable:this.app_options.text_disable||"Disable",cls_enable:this.app_options.cls_enable||"fa fa-caret-square-o-down",cls_disable:this.app_options.cls_disable||"fa fa-caret-square-o-up",always_refresh:this.app_options.always_refresh}).set(e),this.setElement(this._template()),this.$field=this.$(".ui-form-field"),this.$info=this.$(".ui-form-info"),this.$preview=this.$(".ui-form-preview"),this.$collapsible=this.$(".ui-form-collapsible"),this.$collapsible_text=this.$(".ui-form-collapsible-text"),this.$collapsible_icon=this.$(".ui-form-collapsible-icon"),this.$title=this.$(".ui-form-title"),this.$title_text=this.$(".ui-form-title-text"),this.$error_text=this.$(".ui-form-error-text"),this.$error=this.$(".ui-form-error"),this.$backdrop=this.$(".ui-form-backdrop"),this.$field.prepend(this.field.$el);var a=this.model.get("collapsible_value");this.field.collapsed=void 0!==a&&JSON.stringify(this.model.get("value"))==JSON.stringify(a),this.listenTo(this.model,"change",this.render,this),this.render();var n=this;this.$collapsible.on("click",function(){n.field.collapsed=!n.field.collapsed,t.trigger&&t.trigger("change"),n.render()}),this.field.model&&!this.model.get("always_refresh")&&this.listenTo(this.field.model,"change:value",function(){n.reset()})},backdrop:function(){this.model.set("backdrop",!0)},error:function(t){this.model.set("error_text",t)},reset:function(){!this.model.get("fixed")&&this.model.set("error_text",null)},render:function(){s(".tooltip").hide();var t=this.model.get("help",""),e=this.model.get("argument");e&&t.indexOf("("+e+")")==-1&&(t+=" ("+e+")"),this.$info.html(t),this.$el[this.model.get("hidden")?"hide":"show"](),this.$preview[this.field.collapsed&&this.model.get("collapsible_preview")||this.model.get("disabled")?"show":"hide"]().html(r.escape(this.model.get("text_value")));var i=this.model.get("error_text");if(this.$error[i?"show":"hide"](),this.$el[i?"addClass":"removeClass"]("ui-error"),this.$error_text.html(i),this.$backdrop[this.model.get("backdrop")?"show":"hide"](),this.field.collapsed||this.model.get("disabled")?this.$field.hide():this.$field.show(),this.field.model&&this.field.model.set({color:this.model.get("color"),style:this.model.get("style")}),this.model.get("disabled")||void 0===this.model.get("collapsible_value"))this.$title_text.show().text(this.model.get("label")),this.$collapsible.hide();else{var a=this.field.collapsed?"enable":"disable";this.$title_text.hide(),this.$collapsible.show(),this.$collapsible_text.text(this.model.get("label")),this.$collapsible_icon.removeClass().addClass("icon").addClass(this.model.get("cls_"+a)).attr("data-original-title",this.model.get("text_"+a)).tooltip({placement:"bottom"})}},_template:function(){return s("<div/>").addClass("ui-form-element").append(s("<div/>").addClass("ui-form-error ui-error").append(s("<span/>").addClass("fa fa-arrow-down")).append(s("<span/>").addClass("ui-form-error-text"))).append(s("<div/>").addClass("ui-form-title").append(s("<div/>").addClass("ui-form-collapsible").append(s("<i/>").addClass("ui-form-collapsible-icon")).append(s("<span/>").addClass("ui-form-collapsible-text"))).append(s("<span/>").addClass("ui-form-title-text"))).append(s("<div/>").addClass("ui-form-field").append(s("<span/>").addClass("ui-form-info")).append(s("<div/>").addClass("ui-form-backdrop"))).append(s("<div/>").addClass("ui-form-preview"));
}})}.apply(e,a),!(void 0!==n&&(t.exports=n))}).call(e,i(2),i(1),i(3))},function(t,e,i){var a,n;(function(s,r,o){a=[i(4),i(5),i(38),i(41),i(39),i(40),i(36)],n=function(t,e,i,a,n,l,h){return s.Model.extend({types:{text:"_fieldText",password:"_fieldText",select:"_fieldSelect",data_column:"_fieldSelect",genomebuild:"_fieldSelect",data:"_fieldData",data_collection:"_fieldData",integer:"_fieldSlider",float:"_fieldSlider",boolean:"_fieldBoolean",drill_down:"_fieldDrilldown",color:"_fieldColor",hidden:"_fieldHidden",hidden_data:"_fieldHidden",baseurl:"_fieldHidden",library_data:"_fieldLibrary",ftpfile:"_fieldFtp",upload:"_fieldUpload",genomespacefile:"_fieldGenomeSpace"},create:function(t){var e=this.types[t.type],i="function"==typeof this[e]?this[e].call(this,t):null;return i||(i=t.options?this._fieldSelect(t):this._fieldText(t),Galaxy.emit.debug("form-parameters::_addRow()","Auto matched field type ("+t.type+").")),void 0===t.value&&(t.value=null),i.value(t.value),i},_fieldData:function(t){return new i.View({id:"field-"+t.id,extensions:t.extensions,optional:t.optional,multiple:t.multiple,type:t.type,flavor:t.flavor,data:t.options,onchange:t.onchange})},_fieldSelect:function(t){if(t.is_workflow)return this._fieldText(t);"data_column"==t.type&&(t.error_text="Missing columns in referenced dataset.");var i=t.data;i||(i=[],r.each(t.options,function(t){i.push({label:t[0],value:t[1]})}));var a=e.Select;switch(t.display){case"checkboxes":a=e.Checkbox;break;case"radio":a=e.Radio;break;case"radiobutton":a=e.RadioButton}return new a.View({id:"field-"+t.id,data:i,error_text:t.error_text||"No options available",multiple:t.multiple,optional:t.optional,onchange:t.onchange,individual:t.individual,searchable:"workflow"!==t.flavor})},_fieldDrilldown:function(t){return t.is_workflow?this._fieldText(t):new e.Drilldown.View({id:"field-"+t.id,data:t.options,display:t.display,optional:t.optional,onchange:t.onchange})},_fieldText:function(i){if(i.options&&i.data)if(i.area=i.multiple,t.isEmpty(i.value))i.value=null;else if(o.isArray(i.value)){var a="";for(var n in i.value){if(a+=String(i.value[n]),!i.multiple)break;a+="\n"}i.value=a}return new e.Input({id:"field-"+i.id,type:i.type,area:i.area,readonly:i.readonly,placeholder:i.placeholder,datalist:i.datalist,onchange:i.onchange})},_fieldSlider:function(t){return new e.Slider.View({id:"field-"+t.id,precise:"float"==t.type,is_workflow:t.is_workflow,min:t.min,max:t.max,onchange:t.onchange})},_fieldHidden:function(t){return new e.Hidden({id:"field-"+t.id,info:t.info})},_fieldBoolean:function(t){return new e.RadioButton.View({id:"field-"+t.id,data:[{label:"Yes",value:"true"},{label:"No",value:"false"}],onchange:t.onchange})},_fieldColor:function(t){return new h({id:"field-"+t.id,onchange:t.onchange})},_fieldLibrary:function(t){return new a.View({id:"field-"+t.id,optional:t.optional,multiple:t.multiple,onchange:t.onchange})},_fieldFtp:function(t){return new n.View({id:"field-"+t.id,optional:t.optional,multiple:t.multiple,onchange:t.onchange})},_fieldGenomeSpace:function(t){var e=this;return new l.View({id:"field-"+t.id,onchange:function(){e.app.trigger("change")}})},_fieldUpload:function(t){return new e.Upload({id:"field-"+t.id,onchange:t.onchange})}})}.apply(e,a),!(void 0!==n&&(t.exports=n))}).call(e,i(2),i(3),i(1))},function(t,e,i){var a,n;(function(s,r,o){a=[i(4),i(9),i(5)],n=function(t,e,i){var a=s.View.extend({initialize:function(e){this.list={},this.options=t.merge(e,{title:"Repeat",empty_text:"Not available.",max:null,min:null}),this.button_new=new i.ButtonIcon({icon:"fa-plus",title:"Insert "+this.options.title,tooltip:"Add new "+this.options.title+" block",cls:"ui-button-icon ui-clear-float form-repeat-add",onclick:function(){e.onnew&&e.onnew()}}),this.setElement(r("<div/>").append(this.$list=r("<div/>")).append(r("<div/>").append(this.button_new.$el)))},size:function(){return o.size(this.list)},add:function(t){if(!t.id||this.list[t.id])return void Galaxy.emit.debug("form-repeat::add()","Duplicate or invalid repeat block id.");var a=new i.ButtonIcon({icon:"fa-trash-o",tooltip:"Delete this repeat block",cls:"ui-button-icon-plain form-repeat-delete",onclick:function(){t.ondel&&t.ondel()}}),n=new e.View({id:t.id,title:"placeholder",cls:t.cls||"ui-portlet-repeat",operations:{button_delete:a}});n.append(t.$el),n.$el.addClass("section-row").hide(),this.list[t.id]=n,this.$list.append(n.$el.fadeIn("fast")),this.options.max>0&&this.size()>=this.options.max&&this.button_new.disable(),this._refresh()},del:function(t){return this.list[t]?(this.$list.find("#"+t).remove(),delete this.list[t],this.button_new.enable(),void this._refresh()):void Galaxy.emit.debug("form-repeat::del()","Invalid repeat block id.")},delAll:function(){for(var t in this.list)this.del(t)},hideOptions:function(){this.button_new.$el.hide(),o.each(this.list,function(t){t.hideOperation("button_delete")}),o.isEmpty(this.list)&&this.$el.append(r("<div/>").addClass("ui-form-info").html(this.options.empty_text))},_refresh:function(){var t=0;for(var e in this.list){var i=this.list[e];i.title(++t+": "+this.options.title),i[this.size()>this.options.min?"showOperation":"hideOperation"]("button_delete")}}});return{View:a}}.apply(e,a),!(void 0!==n&&(t.exports=n))}).call(e,i(2),i(1),i(3))},function(t,e,i){var a,n;(function(s,r,o,l){a=[i(4),i(5),i(9),i(31),i(29),i(30)],n=function(t,e,i,a,n,h){var d=s.View.extend({initialize:function(t,e){this.app=t,this.inputs=e.inputs,this.parameters=new h,this.setElement(r("<div/>")),this.render()},render:function(){var t=this;this.$el.empty(),o.each(this.inputs,function(e){t.add(e)})},add:function(e){var i=l.extend(!0,{},e);switch(i.id=e.id=t.uid(),this.app.input_list[i.id]=i,i.type){case"conditional":this._addConditional(i);break;case"repeat":this._addRepeat(i);break;case"section":this._addSection(i);break;default:this._addRow(i)}},_addConditional:function(t){var e=this;t.test_param.id=t.id,this.app.model.get("sustain_conditionals")&&(t.test_param.disabled=!0);var i=this._addRow(t.test_param);i.model&&i.model.set("onchange",function(i){var a=e.app.data.matchCase(t,i);for(var n in t.cases){var s=t.cases[n],r=e.$("#"+t.id+"-section-"+n),o=!1;for(var l in s.inputs)if(!s.inputs[l].hidden){o=!0;break}n==a&&o?r.fadeIn("fast"):r.hide()}e.app.trigger("change")});for(var a in t.cases){var n=new d(this.app,{inputs:t.cases[a].inputs});this._append(n.$el.addClass("ui-form-section"),t.id+"-section-"+a)}i.trigger("change")},_addRepeat:function(t){function e(e){var a=t.id+"-section-"+s++,n=new d(i.app,{inputs:e});r.add({id:a,$el:n.$el,ondel:function(){r.del(a),i.app.trigger("change")}})}for(var i=this,s=0,r=new a.View({title:t.title||"Repeat",min:t.min,max:t.max,onnew:function(){e(t.inputs),i.app.trigger("change")}}),l=o.size(t.cache),h=0;h<Math.max(Math.max(l,t.min||0),t.default||0);h++)e(h<l?t.cache[h]:t.inputs);this.app.model.get("sustain_repeats")&&r.hideOptions();var c=new n(this.app,{label:t.title||t.name,help:t.help,field:r});this._append(c.$el,t.id)},_addSection:function(t){var e=new i.View({title:t.title||t.name,cls:"ui-portlet-section",collapsible:!0,collapsible_button:!0,collapsed:!t.expanded});e.append(new d(this.app,{inputs:t.inputs}).$el),e.append(r("<div/>").addClass("ui-form-info").html(t.help)),this.app.on("expand",function(t){e.$("#"+t).length>0&&e.expand()}),this._append(e.$el,t.id)},_addRow:function(t){var e=this,i=t.id;t.onchange=t.onchange||function(){e.app.trigger("change",i)};var a=this.parameters.create(t);this.app.field_list[i]=a;var s=new n(this.app,{name:t.name,label:t.hide_label?"":t.label||t.name,value:t.value,text_value:t.text_value,collapsible_value:t.collapsible_value,collapsible_preview:t.collapsible_preview,help:t.help,argument:t.argument,disabled:t.disabled,color:t.color,style:t.style,backdrop:t.backdrop,hidden:t.hidden,fixed:t.fixed,field:a});return this.app.element_list[i]=s,this._append(s.$el,t.id),a},_append:function(t,e){this.$el.append(t.addClass("section-row").attr("id",e))}});return{View:d}}.apply(e,a),!(void 0!==n&&(t.exports=n))}).call(e,i(2),i(1),i(3),i(1))},function(t,e,i){var a,n;(function(i,s,r){a=[],n=function(){return i.Model.extend({defaults:{url_base:"",async:!1,async_ops:[],categorical_filters:[],filters:{},sort_key:null,show_item_checkboxes:!1,advanced_search:!1,cur_page:1,num_pages:1,operation:void 0,item_ids:void 0},can_async_op:function(t){return s.indexOf(this.attributes.async_ops,t)!==-1},add_filter:function(t,e,i){if(i){var a,n=this.attributes.filters[t];if(null===n||void 0===n)a=e;else if("string"==typeof n)if("All"==n||n==e)a=e;else{var s=[];s[0]=n,s[1]=e,a=s}else a=n,a.indexOf(e)===-1&&a.push(e);this.attributes.filters[t]=a}else this.attributes.filters[t]=e},remove_filter:function(t,e){var i=this.attributes.filters[t];if(null===i||void 0===i)return!1;if("string"==typeof i)this.attributes.filters[t]="";else{var a=s.indexOf(i,e);a!==-1&&(i[a]="")}},get_url_data:function(){var t={async:this.attributes.async,sort:this.attributes.sort_key,page:this.attributes.cur_page,show_item_checkboxes:this.attributes.show_item_checkboxes,advanced_search:this.attributes.advanced_search};this.attributes.operation&&(t.operation=this.attributes.operation),this.attributes.item_ids&&(t.id=this.attributes.item_ids);var e=this;return s.each(s.pairs(e.attributes.filters),function(e){t["f-"+e[0]]=e[1]}),t},get_url:function(t){return this.get("url_base")+"?"+r.param(this.get_url_data())+"&"+r.param(t)}})}.apply(e,a),!(void 0!==n&&(t.exports=n))}).call(e,i(2),i(3),i(1))},function(t,e,i){var a,n;(function(s,r){a=[i(4)],n=function(t){return{grid:function(t){var e="";return e=t.embedded?this.grid_header(t)+this.grid_table(t):'<div class="loading-elt-overlay"></div><table><tr><td width="75%">'+this.grid_header(t)+'</td><td></td><td></td></tr><tr><td width="100%" id="grid-message" valign="top"></td><td></td><td></td></tr></table>'+this.grid_table(t),t.info_text&&(e+='<br><div class="toolParamHelp" style="clear: both;">'+t.info_text+"</div>"),e},grid_table:function(t){return'<form method="post" onsubmit="return false;"><table id="grid-table" class="grid"><thead id="grid-table-header"></thead><tbody id="grid-table-body"></tbody><tfoot id="grid-table-footer"></tfoot></table></form>'},grid_header:function(t){var e='<div class="grid-header">';if(t.embedded||(e+="<h2>"+t.title+"</h2>"),t.global_actions){e+='<ul class="manage-table-actions">';var i=t.global_actions.length>=3;i&&(e+='<li><a class="action-button" id="popup-global-actions" class="menubutton">Actions</a></li><div popupmenu="popup-global-actions">');for(var a in t.global_actions){var n=t.global_actions[a];e+='<li><a class="action-button use-target" target="'+n.target+'" href="'+n.url_args+'" onclick="return false;" >'+n.label+"</a></li>"}i&&(e+="</div>"),e+="</ul>"}return t.insert&&(e+=t.insert),e+=this.grid_filters(t),e+="</div>"},header:function(t){var e="<tr>";t.show_item_checkboxes&&(e+="<th>",t.items.length>0&&(e+='<input type="checkbox" id="check_all" name=select_all_checkbox value="true"><input type="hidden" name=select_all_checkbox value="true">'),e+="</th>");for(var i in t.columns){var a=t.columns[i];a.visible&&(e+='<th id="'+a.key+'-header">',e+=a.href?'<a href="'+a.href+'" class="sort-link" sort_key="'+a.key+'">'+a.label+"</a>":a.label,e+='<span class="sort-arrow">'+a.extra+"</span></th>")}return e+="</tr>"},body:function(t){var e="",i=0,a=t.items.length;0==a&&(e+='<tr><td colspan="100"><em>No Items</em></td></tr>',i=1);for(var n in t.items){var r=t.items[n],o=r.encode_id;e+="<tr ",t.current_item_id==r.id&&(e+='class="current"'),e+=">",t.show_item_checkboxes&&(e+='<td style="width: 1.5em;"><input type="checkbox" name="id" value="'+o+'" id="'+o+'" class="grid-row-select-checkbox" /></td>');for(var l in t.columns){var h=t.columns[l];if(h.visible){var d="";h.nowrap&&(d='style="white-space:nowrap;"');var c=r.column_config[h.label],u=c.link,g=c.value,f=c.target;"string"===s.type(g)&&(g=g.replace(/\/\//g,"/"));var _="",p="";h.attach_popup&&(_="grid-"+n+"-popup",p="menubutton",""!=u&&(p+=" split"),p+=" popup"),e+="<td "+d+">",u?(0!=t.operations.length&&(e+='<div id="'+_+'" class="'+p+'" style="float: left;">'),e+='<a class="menubutton-label use-target" target="'+f+'" href="'+u+'" onclick="return false;">'+g+"</a>",0!=t.operations.length&&(e+="</div>")):e+='<div id="'+_+'" class="'+p+'"><label id="'+h.label_id_prefix+o+'" for="'+o+'">'+(g||"")+"</label></div>",e+="</td>"}}e+="</tr>",i++}return e},footer:function(t){var e="";if(t.use_paging&&t.num_pages>1){var i=t.num_page_links,a=t.cur_page_num,n=t.num_pages,s=i/2,r=a-s,o=0;r<=0&&(r=1,o=s-(a-r));var l,h=s+o,d=a+h;d<=n?l=0:(d=n,l=h-(d+1-a)),0!=l&&(r-=l,r<1&&(r=1)),e+='<tr id="page-links-row">',t.show_item_checkboxes&&(e+="<td></td>"),e+='<td colspan="100"><span id="page-link-container">Page:',r>1&&(e+='<span class="page-link" id="page-link-1"><a href="javascript:void(0);" page_num="1" onclick="return false;">1</a></span> ...');for(var c=r;c<d+1;c++)e+=c==t.cur_page_num?'<span class="page-link inactive-link" id="page-link-'+c+'">'+c+"</span>":'<span class="page-link" id="page-link-'+c+'"><a href="javascript:void(0);" onclick="return false;" page_num="'+c+'">'+c+"</a></span>";d<n&&(e+='...<span class="page-link" id="page-link-'+n+'"><a href="javascript:void(0);" onclick="return false;" page_num="'+n+'">'+n+"</a></span>"),e+="</span>",e+='<span class="page-link" id="show-all-link-span"> | <a href="javascript:void(0);" onclick="return false;" page_num="all">Show All</a></span></td></tr>'}if(t.show_item_checkboxes){e+='<tr><input type="hidden" id="operation" name="operation" value=""><td></td><td colspan="100">For <span class="grid-selected-count"></span> selected items: ';for(var u in t.operations){var g=t.operations[u];g.allow_multiple&&(e+='<input type="button" value="'+g.label+'" class="operation-button action-button">&nbsp;')}e+="</td></tr>"}var f=!1;for(u in t.operations)if(t.operations[u].global_operation){f=!0;break}if(f){e+='<tr><td colspan="100">';for(u in t.operations){var g=t.operations[u];g.global_operation&&(e+='<a class="action-button" href="'+g.global_operation+'">'+g.label+"</a>")}e+="</td></tr>"}return t.legend&&(e+='<tr><td colspan="100">'+t.legend+"</td></tr>"),e},message:function(t){var e="success"==t.status?"done":t.status;return'<p><div class="'+e+'message transient-message">'+r.escape(t.message)+'</div><div style="clear: both"></div></p>'},grid_filters:function(t){var e=t.default_filter_dict,i=t.filters,a="none";t.advanced_search&&(a="block");var n=!1;for(var s in t.columns){var r=t.columns[s];if("advanced"==r.filterable){var o=r.key,l=i[o],h=e[o];l&&h&&l!=h&&(a="block"),n=!0}}var d="block";"block"==a&&(d="none");var c='<div id="standard-search" style="display: '+d+';"><table><tr><td style="padding: 0;"><table>';for(var s in t.columns){var r=t.columns[s];"standard"==r.filterable&&(c+=this.grid_column_filter(t,r))}c+="</table></td></tr><tr><td>",n&&(c+='<a href="" class="advanced-search-toggle">Advanced Search</a>'),c+="</td></tr></table></div>",c+='<div id="advanced-search" style="display: '+a+'; margin-top: 5px; border: 1px solid #ccc;"><table><tr><td style="text-align: left" colspan="100"><a href="" class="advanced-search-toggle">Close Advanced Search</a></td></tr>';for(var s in t.columns){var r=t.columns[s];"advanced"==r.filterable&&(c+=this.grid_column_filter(t,r))}return c+="</table></div>"},grid_column_filter:function(t,e){var i=(t.default_filter_dict,t.filters),a=e.label,n=e.key;"advanced"==e.filterable&&(a=a.toLowerCase());var r="<tr>";if("advanced"==e.filterable&&(r+='<td align="left" style="padding-left: 10px">'+a+":</td>"),r+='<td style="padding-bottom: 1px;">',e.is_text){r+='<form class="text-filter-form" column_key="'+n+'" action="'+t.url+'" method="get" >';for(c in t.columns){var o=t.columns[c],l=i[o.key];l&&"All"!=l&&(o.is_text&&(l=JSON.stringify(l)),r+='<input type="hidden" id="'+o.key+'" name="f-'+o.key+'" value="'+l+'"/>')}r+='<span id="'+n+'-filtering-criteria">';var h=i[n];if(h){var d=s.type(h);if("string"==d&&"All"!=h&&(r+=this.filter_element(n,h)),"array"==d)for(var c in h){var u=h[c],g=h;g=g.slice(c),r+=this.filter_element(n,u)}}r+="</span>";var f="";if("standard"==e.filterable){f=e.label.toLowerCase();var _=f.length;_<20&&(_=20),_+=4}r+='<span class="search-box"><input class="search-box-input" id="input-'+n+'-filter" name="f-'+n+'" type="text" placeholder="'+f+'" size="'+_+'"/><button type="submit" style="background: transparent; border: none; padding: 4px; margin: 0px;"><i class="fa fa-search"></i></button></span></form>'}else{r+='<span id="'+n+'-filtering-criteria">';var p=!1;for(var v in t.categorical_filters[n]){var m=t.categorical_filters[n][v],b="",w="";for(var y in m)b=y,w=m[y];p&&(r+=" | "),p=!0;var u=i[n];r+=u&&m[n]&&u==w?'<span class="categorical-filter '+n+'-filter current-filter">'+v+"</span>":'<span class="categorical-filter '+n+'-filter"><a href="javascript:void(0);" filter_key="'+b+'" filter_val="'+w+'">'+v+"</a></span>"}r+="</span>"}return r+="</td></tr>"},filter_element:function(e,i){return i=t.sanitize(i),'<span class="text-filter-val">'+i+'<a href="javascript:void(0);" filter_key="'+e+'" filter_val="'+i+'"><i class="fa fa-times" style="padding-left: 5px; padding-bottom: 6px;"/></a></span>'}}}.apply(e,a),!(void 0!==n&&(t.exports=n))}).call(e,i(1),i(3))},function(t,e,i){var a,n;a=[],n=function(){return{openFileBrowser:function(t){var e=window.Galaxy.config.genomespace_ui_url,i=e+"upload/loadUrlToGenomespace.html?getLocation=true",a=window.open(i,"GenomeSpace File Browser","height=360px,width=600px");successCalBack=t.successCallback,window.addEventListener("message",function(t){successCalBack(t.data)},!1),a.focus(),null!=t.errorCallback&&(a.setCallbackOnGSUploadError=config.errorCallback)}}}.apply(e,a),!(void 0!==n&&(t.exports=n))},function(t,e,i){var a,n;(function(s,r){a=[i(4)],n=function(t){return s.View.extend({colors:{standard:["c00000","ff0000","ffc000","ffff00","92d050","00b050","00b0f0","0070c0","002060","7030a0"],base:["ffffff","000000","eeece1","1f497d","4f81bd","c0504d","9bbb59","8064a2","4bacc6","f79646"],theme:[["f2f2f2","7f7f7f","ddd9c3","c6d9f0","dbe5f1","f2dcdb","ebf1dd","e5e0ec","dbeef3","fdeada"],["d8d8d8","595959","c4bd97","8db3e2","b8cce4","e5b9b7","d7e3bc","ccc1d9","b7dde8","fbd5b5"],["bfbfbf","3f3f3f","938953","548dd4","95b3d7","d99694","c3d69b","b2a2c7","92cddc","fac08f"],["a5a5a5","262626","494429","17365d","366092","953734","76923c","5f497a","31859b","e36c09"],["7f7f7e","0c0c0c","1d1b10","0f243e","244061","632423","4f6128","3f3151","205867","974806"]]},initialize:function(e){this.options=t.merge(e,{}),this.setElement(this._template()),this.$panel=this.$(".ui-color-picker-panel"),this.$view=this.$(".ui-color-picker-view"),this.$value=this.$(".ui-color-picker-value"),this.$header=this.$(".ui-color-picker-header"),this._build(),this.visible=!1,this.value(this.options.value),this.$boxes=this.$(".ui-color-picker-box");var i=this;this.$boxes.on("click",function(){i.value(r(this).css("background-color")),i.$header.trigger("click")}),this.$header.on("click",function(){i.visible=!i.visible,i.visible?i.$view.fadeIn("fast"):i.$view.fadeOut("fast")})},value:function(t){return void 0!==t&&null!==t&&(this.$value.css("background-color",t),this.$(".ui-color-picker-box").empty(),this.$(this._getValue()).html(this._templateCheck()),this.options.onchange&&this.options.onchange(t)),this._getValue()},_getValue:function(){function t(t){return("0"+parseInt(t).toString(16)).slice(-2)}var e=this.$value.css("background-color");return e=e.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/),e?"#"+t(e[1])+t(e[2])+t(e[3]):null},_build:function(){this._content({colors:this.colors.base});for(var t in this.colors.theme){var e={};0==t?e.bottom=!0:t!=this.colors.theme.length-1?(e.top=!0,e.bottom=!0):e.top=!0,e.colors=this.colors.theme[t],this._content(e)}this._content({colors:this.colors.standard})},_content:function(t){var e=t.colors,i=r(this._templateContent()),a=i.find(".line");this.$panel.append(i);for(var n in e){var s=r(this._templateBox(e[n]));t.top&&(s.css("border-top","none"),s.css("border-top-left-radius","0px"),s.css("border-top-right-radius","0px")),t.bottom&&(s.css("border-bottom","none"),s.css("border-bottom-left-radius","0px"),s.css("border-bottom-right-radius","0px")),a.append(s)}return i},_templateCheck:function(){return'<div class="ui-color-picker-check fa fa-check"/>'},_templateContent:function(){return'<div class="ui-color-picker-content"><div class="line"/></div>'},_templateBox:function(t){return'<div id="'+t+'" class="ui-color-picker-box" style="background-color: #'+t+';"/>'},_template:function(){return'<div class="ui-color-picker"><div class="ui-color-picker-header"><div class="ui-color-picker-value"/><div class="ui-color-picker-label">Select a color</div></div><div class="ui-color-picker-view ui-input"><div class="ui-color-picker-panel"/></div>'}})}.apply(e,a),!(void 0!==n&&(t.exports=n))}).call(e,i(2),i(1))},function(t,e,i){var a,n;(function(s,r){a=[i(4),i(14)],n=function(t,e){var i=e.BaseIcons.extend({initialize:function(t){t.type=t.display||"checkbox",t.multiple="checkbox"==t.type,e.BaseIcons.prototype.initialize.call(this,t)},_setValue:function(t){if(e.BaseIcons.prototype._setValue.call(this,t),void 0!==t&&null!==t&&this.header_index){var i=this,a=s.isArray(t)?t:[t];r.each(a,function(t){var e=i.header_index[t];r.each(e,function(t){i._setState(t,!0)})})}},_setState:function(t,e){var i=this.$(".button-"+t),a=this.$(".subgroup-"+t);i.data("is_expanded",e),e?(a.show(),i.removeClass("fa-plus-square").addClass("fa-minus-square")):(a.hide(),i.removeClass("fa-minus-square").addClass("fa-plus-square"))},_templateOptions:function(){function e(t,e){var i=t.find(".button-"+e);i.on("click",function(){a._setState(e,!i.data("is_expanded"))})}function i(n,r,o){o=o||[];for(var l in r){var h=r[l],d=h.options&&h.options.length>0,c=o.slice(0);a.header_index[h.value]=c.slice(0);var u=s("<div/>");if(d){var g=t.uid(),f=s("<span/>").addClass("button-"+g).addClass("ui-drilldown-button fa fa-plus-square"),_=s("<div/>").addClass("subgroup-"+g).addClass("ui-drilldown-subgroup");u.append(s("<div/>").append(f).append(a._templateOption({label:h.name,value:h.value}))),c.push(g),i(_,h.options,c),u.append(_),e(u,g)}else u.append(a._templateOption({label:h.name,value:h.value}));n.append(u)}}var a=this;this.header_index={};var n=s("<div/>");return i(n,this.model.get("data")),n},_template:function(){return s("<div/>").addClass("ui-options-list drilldown-container").attr("id",this.model.id)}});return{View:i}}.apply(e,a),!(void 0!==n&&(t.exports=n))}).call(e,i(1),i(3))},function(t,e,i){var a,n;(function(s,r,o){a=[i(4),i(5),i(15)],n=function(t,e,i){var a={DISABLED:"disabled",ENABLED:"enabled",LINKED:"linked"},n={data:[{src:"hda",icon:"fa-file-o",tooltip:"Single dataset",multiple:!1,batch:a.DISABLED},{src:"hda",icon:"fa-files-o",tooltip:"Multiple datasets",multiple:!0,batch:a.LINKED},{src:"hdca",icon:"fa-folder-o",tooltip:"Dataset collection",multiple:!1,batch:a.LINKED}],data_multiple:[{src:"hda",icon:"fa-files-o",tooltip:"Multiple datasets",multiple:!0,batch:a.DISABLED},{src:"hdca",icon:"fa-folder-o",tooltip:"Dataset collections",multiple:!0,batch:a.DISABLED}],data_collection:[{src:"hdca",icon:"fa-folder-o",tooltip:"Dataset collection",multiple:!1,batch:a.DISABLED}],workflow_data:[{src:"hda",icon:"fa-file-o",tooltip:"Single dataset",multiple:!1,batch:a.DISABLED}],workflow_data_multiple:[{src:"hda",icon:"fa-files-o",tooltip:"Multiple datasets",multiple:!0,batch:a.DISABLED}],workflow_data_collection:[{src:"hdca",icon:"fa-folder-o",tooltip:"Dataset collection",multiple:!1,batch:a.DISABLED}],module_data:[{src:"hda",icon:"fa-file-o",tooltip:"Single dataset",multiple:!1,batch:a.DISABLED},{src:"hda",icon:"fa-files-o",tooltip:"Multiple datasets",multiple:!0,batch:a.ENABLED}],module_data_collection:[{src:"hdca",icon:"fa-folder-o",tooltip:"Dataset collection",multiple:!1,batch:a.DISABLED},{src:"hdca",icon:"fa-folder",tooltip:"Multiple collections",multiple:!0,batch:a.ENABLED}]},l=s.View.extend({initialize:function(t){var i=this;this.model=t&&t.model||new s.Model({src_labels:{hda:"dataset",hdca:"dataset collection"},pagelimit:100,statustimer:1e3}).set(t),this.setElement(r("<div/>").addClass("ui-select-content")),this.button_product=new e.RadioButton.View({value:"false",data:[{icon:"fa fa-chain",value:"false",tooltip:"Linked inputs will be run in matched order with other datasets e.g. use this for matching forward and reverse reads."},{icon:"fa fa-chain-broken",value:"true",tooltip:"Unlinked dataset inputs will be run against *all* other inputs."}]});var a=r("<div/>").addClass("ui-form-info").append(r("<i/>").addClass("fa fa-sitemap")).append(r("<span/>").html("This is a batch mode input field. Separate jobs will be triggered for each dataset selection."));this.$batch={linked:a.clone(),enabled:a.clone().append(r("<div/>").append(r("<div/>").addClass("ui-form-title").html("Batch options:")).append(this.button_product.$el)).append(r("<div/>").css("clear","both"))},this.$el.on("dragenter",function(t){this.lastenter=t.target,i.$el.addClass("ui-dragover")}).on("dragover",function(t){t.preventDefault()}).on("dragleave",function(t){this.lastenter===t.target&&i.$el.removeClass("ui-dragover")}).on("drop",function(t){i._handleDrop(t)}),this.history={},this.listenTo(this.model,"change:data",this._changeData,this),this.listenTo(this.model,"change:wait",this._changeWait,this),this.listenTo(this.model,"change:current",this._changeCurrent,this),this.listenTo(this.model,"change:value",this._changeValue,this),this.listenTo(this.model,"change:type change:optional change:multiple change:extensions",this._changeType,this),this.render(),this.on("change",function(){t.onchange&&t.onchange(i.value())})},render:function(){this._changeType(),this._changeValue(),this._changeWait()},wait:function(){this.model.set("wait",!0)},unwait:function(){this.model.set("wait",!1)},update:function(t){this.model.set("data",t)},value:function(t){void 0!==t&&this.model.set("value",t);var e=this.model.get("current");if(this.config[e]){var i=this.fields[e].value();if(null!==i&&(i=r.isArray(i)?i:[i],i.length>0)){var a=this._batch({values:[]});for(var n in i){var s=this.history[i[n]+"_"+this.config[e].src];if(!s)return Galaxy.emit.debug("ui-select-content::value()","Requested details not found for '"+i[n]+"'."),null;a.values.push(s)}return a.values.sort(function(t,e){return t.hid-e.hid}),a}}else Galaxy.emit.debug("ui-select-content::value()","Invalid value/source '"+t+"'.");return null},_changeCurrent:function(){var t=this;o.each(this.fields,function(e,i){t.model.get("current")==i?(e.$el.show(),o.each(t.$batch,function(e,a){e[t.config[i].batch==a?"show":"hide"]()}),t.button_type.value(i)):e.$el.hide()})},_changeType:function(){var a=this,s=(this.model.get("flavor")?this.model.get("flavor")+"_":"")+String(this.model.get("type"))+(this.model.get("multiple")?"_multiple":"");n[s]?this.config=n[s]:(this.config=n.data,Galaxy.emit.debug("ui-select-content::_changeType()","Invalid configuration/type id '"+s+"'."));var r=a.model.get("data"),l=t.textify(this.model.get("extensions")),h=this.model.get("src_labels");this.fields=[],this.button_data=[],o.each(this.config,function(t,e){a.button_data.push({value:e,icon:t.icon,tooltip:t.tooltip}),a.fields.push(new i.View({optional:a.model.get("optional"),multiple:t.multiple,searchable:!t.multiple||r&&r[t.src]&&r[t.src].length>a.model.get("pagelimit"),individual:!0,error_text:"No "+(l?l+" ":"")+(h[t.src]||"content")+" available.",onchange:function(){a.trigger("change")}}))}),this.button_type=new e.RadioButton.View({value:this.model.get("current"),data:this.button_data,onchange:function(t){a.model.set("current",t),a.trigger("change")}}),this.$el.empty();var d=0;this.fields.length>1&&(this.$el.append(this.button_type.$el),d=Math.max(0,36*this.fields.length)+"px"),o.each(this.fields,function(t){a.$el.append(t.$el.css({"margin-left":d}))}),o.each(this.$batch,function(t,e){a.$el.append(t.css({"margin-left":d}))}),this.model.set("current",0),this._changeCurrent(),this._changeData()},_changeWait:function(){var t=this;o.each(this.fields,function(e){e[t.model.get("wait")?"wait":"unwait"]()})},_changeData:function(){var t=this.model.get("data"),e=this,i={};o.each(t,function(t,a){i[a]=[],o.each(t,function(t){i[a].push({hid:t.hid,keep:t.keep,label:t.hid+": "+t.name,value:t.id,tags:t.tags}),e.history[t.id+"_"+a]=t})}),o.each(this.config,function(t,a){i[t.src]&&e.fields[a].add(i[t.src],function(t,e){return e.hid-t.hid})})},_changeValue:function(){var t=this.model.get("value");if(t&&t.values&&t.values.length>0){var e=[];o.each(t.values,function(t){e.push(t.id)});for(var i=t.values[0].src,a=t.values.length>1,n=0;n<this.config.length;n++){var s=this.fields[n],r=this.config[n];if(r.src==i&&[a,!0].indexOf(r.multiple)!==-1){this.model.set("current",n),s.value(e);break}}}else o.each(this.fields,function(t){t.value(null)})},_handleDrop:function(t){try{var e=this.model.get("data"),i=this.model.get("current"),a=this.config[i],n=this.fields[i],s=JSON.parse(t.originalEvent.dataTransfer.getData("text"))[0],r=s.id,l="dataset"==s.history_content_type?"hda":"hdca",h={id:r,src:l};if(e&&o.findWhere(e[l],h)){if(a.src==l){var d=n.value();d&&a.multiple?d.indexOf(r)==-1&&d.push(r):d=r,n.value(d)}else this.model.set("value",{values:[h]}),this.model.trigger("change:value");this.trigger("change"),this._handleDropStatus("success")}else this._handleDropStatus("danger")}catch(t){this._handleDropStatus("danger")}t.preventDefault()},_handleDropStatus:function(t){var e=this;this.$el.removeClass("ui-dragover").addClass("ui-dragover-"+t),setTimeout(function(){e.$el.removeClass("ui-dragover-"+t)},this.model.get("statustimer"))},_batch:function(t){t.batch=!1;var e=this.model.get("current"),i=this.config[e];if("hdca"==i.src&&!i.multiple){var n=this.history[this.fields[e].value()+"_hdca"];n&&n.map_over_type&&(t.batch=!0)}return i.batch!=a.LINKED&&i.batch!=a.ENABLED||(t.batch=!0,i.batch==a.ENABLED&&"true"===this.button_product.value()&&(t.product=!0)),t}});return{View:l}}.apply(e,a),!(void 0!==n&&(t.exports=n))}).call(e,i(2),i(1),i(3))},function(t,e,i){var a,n;(function(s){a=[i(4),i(13)],n=function(t,e){var i=s.View.extend({initialize:function(i){var a=this;this.ftpfile_list=new e.View({name:"file",optional:i.optional,multiple:i.multiple,onchange:function(){i.onchange&&i.onchange(a.value())}}),this.setElement(this.ftpfile_list.$el),t.get({url:Galaxy.root+"api/remote_files",success:function(t){var e=[];for(var i in t)e.push({value:t[i].path,label:t[i].path});a.ftpfile_list.update(e)}})},value:function(t){return this.ftpfile_list.value(t)}});return{View:i}}.apply(e,a),!(void 0!==n&&(t.exports=n))}).call(e,i(2))},function(t,e,i){var a,n;(function(s){a=[i(4),i(5),i(35)],n=function(t,e,i){var a=s.View.extend({initialize:function(t){var i=this;this.browse_button=new e.ButtonIcon({title:"Browse",icon:"fa fa-sign-in",tooltip:"Browse GenomeSpace",onclick:function(){i.browseGenomeSpace()}}),this.filename_textbox=new e.Input,this.token_textbox=new e.Input({type:"password"}),this.setElement(this._template(t)),this.$(".ui-gs-browse-button").append(this.browse_button.$el),this.$(".ui-gs-filename-textbox").append(this.filename_textbox.$el),this.$(".ui-gs-token-textbox").append(this.token_textbox.$el)},browseGenomeSpace:function(t){var e=this;i.openFileBrowser({successCallback:function(t){e.value(t.destination+"^"+t.token)}})},_template:function(t){return'<div class="ui-gs-select-file"><div class="ui-gs-browse-field"><span class="ui-gs-browse-button" /><span class="ui-gs-filename-textbox" /></div><div class="ui-gs-token-field"><span class=ui-gs-label"><div class="ui-gs-token-label">Token</div></span><span class="ui-gs-token-textbox" /></div></div>'},value:function(t){return void 0===t?this._getValue():void this._setValue(t)},_getValue:function(){return this.filename_textbox.value()+"^"+this.token_textbox.value()},_setValue:function(t){t&&(values=t.split("^"),this.filename_textbox.value(values[0]),this.token_textbox.value(values[1]));
}});return{View:a}}.apply(e,a),!(void 0!==n&&(t.exports=n))}).call(e,i(2))},function(t,e,i){var a,n;(function(s){a=[i(4),i(5),i(23),i(13)],n=function(t,e,i,a){var n=s.Collection.extend({url:Galaxy.root+"api/libraries?deleted=false"}),r=s.Collection.extend({initialize:function(){var t=this;this.config=new s.Model({library_id:null}),this.config.on("change",function(){t.fetch({reset:!0})})},url:function(){return Galaxy.root+"api/libraries/"+this.config.get("library_id")+"/contents"}}),o=s.View.extend({initialize:function(t){var i=this;this.libraries=new n,this.datasets=new r,this.options=t,this.library_select=new e.Select.View({onchange:function(t){i.datasets.config.set("library_id",t)}}),this.dataset_list=new a.View({name:"dataset",optional:t.optional,multiple:t.multiple,onchange:function(){i.trigger("change")}}),this.libraries.on("reset",function(){var t=[];i.libraries.each(function(e){t.push({value:e.id,label:e.get("name")})}),i.library_select.update(t)}),this.datasets.on("reset",function(){var t=[],e=i.library_select.text();null!==e&&i.datasets.each(function(e){"file"===e.get("type")&&t.push({value:e.id,label:e.get("name")})}),i.dataset_list.update(t)}),this.on("change",function(){t.onchange&&t.onchange(i.value())}),this.setElement(this._template()),this.$(".library-select").append(this.library_select.$el),this.$el.append(this.dataset_list.$el),this.libraries.fetch({reset:!0,success:function(){i.library_select.trigger("change"),void 0!==i.options.value&&i.value(i.options.value)}})},value:function(t){return this.dataset_list.value(t)},_template:function(){return'<div class="ui-select-library"><div class="library ui-margin-bottom"><span class="library-title">Select Library</span><span class="library-select"/></div></div>'}});return{View:o}}.apply(e,a),!(void 0!==n&&(t.exports=n))}).call(e,i(2))},function(t,e,i){var a,n;(function(s,r){a=[i(4)],n=function(t){var e=s.View.extend({initialize:function(e){var i=this;this.model=e&&e.model||new s.Model({id:t.uid(),min:null,max:null,step:null,precise:!1,split:1e4,value:null,onchange:function(){}}).set(e),this.setElement(this._template()),this.$el.attr("id",this.model.id),this.$text=this.$(".ui-form-slider-text"),this.$slider=this.$(".ui-form-slider-element");var a=[];this.$text.on("change",function(){i.value(r(this).val())}).on("keyup",function(t){a[t.which]=!1}).on("keydown",function(t){var e=t.which;a[e]=!0,i.model.get("is_workflow")&&a[16]&&52==e?(i.value("$"),event.preventDefault()):8==e||9==e||13==e||37==e||39==e||e>=48&&e<=57&&!a[16]||e>=96&&e<=105||(190==e||110==e)&&r(this).val().indexOf(".")==-1&&i.model.get("precise")||(189==e||109==e)&&r(this).val().indexOf("-")==-1||i._isParameter(r(this).val())||a[91]||a[17]||event.preventDefault()});var n=this.model.attributes;this.has_slider=null!==n.max&&null!==n.min&&n.max>n.min;var o=n.step;o||(o=n.precise&&this.has_slider?(n.max-n.min)/n.split:1),this.has_slider?(this.$text.addClass("ui-form-slider-left"),this.$slider.slider({min:n.min,max:n.max,step:o}).on("slide",function(t,e){i.value(e.value)})):this.$slider.hide(),this.listenTo(this.model,"change",this.render,this),this.render()},render:function(){var t=this.model.get("value");this.has_slider&&this.$slider.slider("value",t),t!==this.$text.val()&&this.$text.val(t)},value:function(t){var e=this.model.attributes;return void 0!==t&&(null===t||""===t||this._isParameter(t)||(isNaN(t)&&(t=0),!e.precise&&(t=Math.round(t)),null!==e.max&&(t=Math.min(t,e.max)),null!==e.min&&(t=Math.max(t,e.min))),this.model.set("value",t),this.model.trigger("change"),e.onchange(t)),this.model.get("value")},_isParameter:function(t){return this.model.get("is_workflow")&&"$"===String(t).substring(0,1)},_template:function(){return'<div class="ui-form-slider"><input class="ui-form-slider-text" type="text"/><div class="ui-form-slider-element"/></div>'}});return{View:e}}.apply(e,a),!(void 0!==n&&(t.exports=n))}).call(e,i(2),i(1))},,,,function(t,e,i){var a,n;(function(s,r){a=[i(4),i(50),i(5),i(10),i(28),i(57)],n=function(t,e,i,a,n,o){return a.extend({initialize:function(t){var i=this;this.deferred=new e,a.prototype.initialize.call(this,t),this._update(this.model.get("initialmodel")),this.model.get("listen_to_history")&&parent.Galaxy&&parent.Galaxy.currHistoryPanel&&this.listenTo(parent.Galaxy.currHistoryPanel.collection,"change",function(){i.model.get("onchange")()}),this.$el.on("remove",function(){i._destroy()})},_update:function(t){var e=this;t=t||this.model.get("buildmodel"),t?(this.deferred.reset(),this.deferred.execute(function(i){t(i,e),i.then(function(){e._render()})})):this._render()},_destroy:function(){var t=this;this.$el.off().hide(),this.deferred.execute(function(){a.prototype.remove.call(t),Galaxy.emit.debug("tool-form-base::_destroy()","Destroy view.")})},_render:function(){var t=this,e=this.model.attributes;this.model.set({title:e.fixed_title||"<b>"+e.name+"</b> "+e.description+" (Galaxy Version "+e.version+")",operations:!e.hide_operations&&this._operations(),onchange:function(){t.deferred.reset(),t.deferred.execute(function(e){t.model.get("postchange")(e,t)})}}),this.render(),this.model.get("collapsible")||this.$el.append(s("<div/>").addClass("ui-margin-top-large").append(this._footer())),this.show_message&&this.message.update({status:"success",message:"Now you are using '"+e.name+"' version "+e.version+", id '"+e.id+"'.",persistent:!1}),this.show_message=!0},_operations:function(){var e=this,a=this.model.attributes,n=new i.ButtonMenu({icon:"fa-cubes",title:!a.narrow&&"Versions"||null,tooltip:"Select another tool version"});if(!a.sustain_version&&a.versions&&a.versions.length>1)for(var o in a.versions){var l=a.versions[o];l!=a.version&&n.addMenu({title:"Switch to "+l,version:l,icon:"fa-cube",onclick:function(){e.model.set("id",a.id.replace(a.version,this.version)),e.model.set("version",this.version),e._update()}})}else n.$el.hide();var h=new i.ButtonMenu({icon:"fa-caret-down",title:!a.narrow&&"Options"||null,tooltip:"View available options"});return a.biostar_url&&(h.addMenu({icon:"fa-question-circle",title:"Question?",onclick:function(){window.open(a.biostar_url+"/p/new/post/")}}),h.addMenu({icon:"fa-search",title:"Search",onclick:function(){window.open(a.biostar_url+"/local/search/page/?q="+a.name)}})),h.addMenu({icon:"fa-share",title:"Share",onclick:function(){prompt("Copy to clipboard: Ctrl+C, Enter",window.location.origin+Galaxy.root+"root?tool_id="+a.id)}}),Galaxy.user&&Galaxy.user.get("is_admin")&&(h.addMenu({icon:"fa-download",title:"Download",onclick:function(){window.location.href=Galaxy.root+"api/tools/"+a.id+"/download"}}),h.addMenu({icon:"fa-refresh",title:"Reload XML",onclick:function(){t.get({url:Galaxy.root+"api/tools/"+a.id+"/reload",success:function(t){e.message.update({persistent:!1,message:"Tool XML has been reloaded.",status:"success"})},error:function(t){e.message.update({persistent:!1,message:t.err_msg,status:"danger"})}})}})),a.requirements&&a.requirements.length>0&&h.addMenu({icon:"fa-info-circle",title:"Requirements",onclick:function(){!this.requirements_visible||e.portlet.collapsed?(this.requirements_visible=!0,e.portlet.expand(),e.message.update({persistent:!0,message:e._templateRequirements(a),status:"info"})):(this.requirements_visible=!1,e.message.update({message:""}))}}),a.sharable_url&&h.addMenu({icon:"fa-external-link",title:"See in Tool Shed",onclick:function(){window.open(a.sharable_url)}}),s.getJSON("/api/webhooks/tool-menu/all",function(t){r.each(t,function(t){t.activate&&t.config.function&&h.addMenu({icon:t.config.icon,title:t.config.title,onclick:function(){var e=new Function("options",t.config.function);e(a)}})})}),{menu:h,versions:n}},_footer:function(){var t=this.model.attributes,e=s("<div/>").append(this._templateHelp(t));if(t.citations){var i=s("<div/>"),a=new n.ToolCitationCollection;a.tool_id=t.id;var r=new o.CitationListView({el:i,collection:a});r.render(),a.fetch(),e.append(i)}return e},_templateHelp:function(t){var e=s("<div/>").addClass("ui-form-help").append(t.help);return e.find("a").attr("target","_blank"),e},_templateRequirements:function(t){var e=t.requirements.length;if(e>0){var i="This tool requires ";r.each(t.requirements,function(t,a){i+=t.name+(t.version?" (Version "+t.version+")":"")+(a<e-2?", ":a==e-2?" and ":"")});var a=s("<a/>").attr("target","_blank").attr("href","https://galaxyproject.org/tools/requirements/").text("here");return s("<span/>").append(i+". Click ").append(a).append(" for more information.")}return"No requirements found."}})}.apply(e,a),!(void 0!==n&&(t.exports=n))}).call(e,i(1),i(3))},function(t,e,i){var a,n;(function(s,r,o){a=[i(4),i(5),i(8),i(46),i(44)],n=function(t,e,i,a,n){var l=s.View.extend({initialize:function(n){var s=this;this.modal=parent.Galaxy.modal||new i.View,this.form=new a(t.merge({listen_to_history:!0,always_refresh:!1,buildmodel:function(i,a){var n=a.model.attributes,o="",l={},h=n.job_id;h?o=Galaxy.root+"api/jobs/"+h+"/build_for_rerun":(o=Galaxy.root+"api/tools/"+n.id+"/build",l=r.extend({},Galaxy.params),l.tool_id&&delete l.tool_id),n.version&&(l.tool_version=n.version),t.get({url:o,data:l,success:function(t){return t.display?(a.model.set(t),s._customize(a),Galaxy.emit.debug("tool-form-base::_buildModel()","Initial tool model ready.",t),void i.resolve()):void(window.location=Galaxy.root)},error:function(t,s){var o=t&&t.err_msg||"Uncaught error.";401==s?window.location=Galaxy.root+"user/login?"+r.param({redirect:Galaxy.root+"?tool_id="+n.id}):a.$el.is(":empty")?a.$el.prepend(new e.Message({message:o,status:"danger",persistent:!0,large:!0}).$el):Galaxy.modal&&Galaxy.modal.show({title:"Tool request failed",body:o,buttons:{Close:function(){Galaxy.modal.hide()}}}),Galaxy.emit.debug("tool-form-base::_buildModel()","Initial tool model request failed.",t),i.reject()}})},postchange:function(e,i){var a={tool_id:i.model.get("id"),tool_version:i.model.get("version"),inputs:r.extend(!0,{},i.data.create())};i.wait(!0),Galaxy.emit.debug("tool-form::postchange()","Sending current state.",a),t.request({type:"POST",url:Galaxy.root+"api/tools/"+i.model.get("id")+"/build",data:a,success:function(t){i.update(t),i.wait(!1),Galaxy.emit.debug("tool-form::postchange()","Received new model.",t),e.resolve()},error:function(t){Galaxy.emit.debug("tool-form::postchange()","Refresh request failed.",t),e.reject()}})}},n)),this.deferred=this.form.deferred,this.setElement("<div/>"),this.$el.append(this.form.$el)},_customize:function(t){var i=this,a=t.model.attributes;a.buttons={execute:execute_btn=new e.Button({icon:"fa-check",tooltip:"Execute: "+a.name+" ("+a.version+")",title:"Execute",cls:"btn btn-primary ui-clear-float",wait_cls:"btn btn-info ui-clear-float",onclick:function(){execute_btn.wait(),t.portlet.disable(),i.submit(a,function(){execute_btn.unwait(),t.portlet.enable()})}})},a.job_id&&a.job_remap&&a.inputs.push({label:"Resume dependencies from this job",name:"rerun_remap_job_id",type:"select",display:"radio",ignore:"__ignore__",value:"__ignore__",options:[["Yes",a.job_id],["No","__ignore__"]],help:"The previous run of this tool failed and other tools were waiting for it to finish successfully. Use this option to resume those tools using the new output(s) of this tool run."})},submit:function(e,i){var a=this,s={tool_id:e.id,tool_version:e.version,inputs:this.form.data.create()};if(this.form.trigger("reset"),!a.validate(s))return Galaxy.emit.debug("tool-form::submit()","Submission canceled. Validation failed."),void(i&&i());if(e.action!==Galaxy.root+"tool_runner/index"){var l=r("<form/>").attr({action:e.action,method:e.method,enctype:e.enctype});return o.each(s.inputs,function(t,e){l.append(r("<input/>").attr({name:e,value:t}))}),l.hide().appendTo("body").submit().remove(),void(i&&i())}Galaxy.emit.debug("tool-form::submit()","Validation complete.",s),t.request({type:"POST",url:Galaxy.root+"api/tools",data:s,success:function(t){if(i&&i(),a.$el.children().hide(),a.$el.append(a._templateSuccess(t)),t.jobs&&t.jobs.length>0){a.$el.append(r("<div/>",{id:"webhook-view"}));new n.WebhookView({urlRoot:Galaxy.root+"api/webhooks/tool",toolId:s.tool_id})}parent.Galaxy&&parent.Galaxy.currHistoryPanel&&parent.Galaxy.currHistoryPanel.refreshContents()},error:function(t){i&&i(),Galaxy.emit.debug("tool-form::submit","Submission failed.",t);var e=!1;if(t&&t.err_data){var n=a.form.data.matchResponse(t.err_data);for(var r in n){a.form.highlight(r,n[r]),e=!0;break}}e||a.modal.show({title:"Job submission failed",body:a._templateError(s,t&&t.err_msg),buttons:{Close:function(){a.modal.hide()}}})}})},validate:function(t){var e=t.inputs,i=-1,a=null;for(var n in e){var s=e[n],r=this.form.data.match(n),o=this.form.field_list[r],l=this.form.input_list[r];if(r&&l&&o){if(!l.optional&&null==s)return this.form.highlight(r),!1;if(s&&s.batch){var h=s.values.length,d=h>0&&s.values[0]&&s.values[0].src;if(d)if(null===a)a=d;else if(a!==d)return this.form.highlight(r,"Please select either dataset or dataset list fields for all batch mode fields."),!1;if(i===-1)i=h;else if(i!==h)return this.form.highlight(r,"Please make sure that you select the same number of inputs for all batch mode fields. This field contains <b>"+h+"</b> selection(s) while a previous field contains <b>"+i+"</b>."),!1}}else Galaxy.emit.debug("tool-form::validate()","Retrieving input objects failed.")}return!0},_templateSuccess:function(t){if(t.jobs&&t.jobs.length>0){var e=t.jobs.length,i=1==e?"1 job has":e+" jobs have",a=r("<div/>").addClass("donemessagelarge").append(r("<p/>").text(i+" been successfully added to the queue - resulting in the following datasets:"));return o.each(t.outputs,function(t){a.append(r("<p/>").addClass("messagerow").append(r("<b/>").text(t.hid+": "+t.name)))}),a.append(r("<p/>").append("<b/>").text("You can check the status of queued jobs and view the resulting data by refreshing the History pane. When the job has been run the status will change from 'running' to 'finished' if completed successfully or 'error' if problems were encountered.")),a}return this._templateError(t,"Invalid success response. No jobs found.")},_templateError:function(t,e){return r("<div/>").addClass("errormessagelarge").append(r("<p/>").text("The server could not complete the request. Please contact the Galaxy Team if this error persists. "+(e||""))).append(r("<pre/>").text(JSON.stringify(t,null,4)))}});return{View:l}}.apply(e,a),!(void 0!==n&&(t.exports=n))}).call(e,i(2),i(1),i(3))},,function(t,e,i){var a,n;(function(s,r){a=[i(4)],n=function(t){var e=s.View.extend({initialize:function(t){this.collection=new s.Collection,this.model=t&&t.model||new s.Model({onchange:null,visible:!0}).set(t),this.setElement(r(this._template())),this.$nav=this.$(".tab-navigation"),this.$content=this.$(".tab-content"),this.$el.on("click",function(){r(".tooltip").hide()}),this.render(),this.listenTo(this.model,"change",this.render,this),this.listenTo(this.collection,"add",this._add,this),this.listenTo(this.collection,"remove",this._remove,this),this.listenTo(this.collection,"change",this._change,this),this.listenTo(this.collection,"reset",this._reset,this),this.listenTo(this.collection,"add remove reset",this.render,this)},render:function(){var t=this.model.get("current");t=this.$("#"+t).length>0?t:this.first(),t&&(this.$nav.children().removeClass("active"),this.$content.children().removeClass("active"),this.$("#tab-"+t).addClass("active"),this.$("#"+t).addClass("active")),this.$el[this.model.get("visible")?"fadeIn":"fadeOut"]("fast"),this.$nav[this.size()>1?"show":"hide"]()},current:function(){return this.model.get("current")},show:function(t){t&&(this.model.set({current:t,visible:!0}),this.model.get("onchange")&&this.model.get("onchange")(t))},hide:function(){this.model.set("visible",!1)},first:function(){var t=this.collection.first();return t&&t.id},size:function(){return this.collection.length},add:function(t){this.collection.add(t)},del:function(t){this.collection.remove(t)},delAll:function(){this.collection.reset()},showTab:function(t){this.collection.get(t).set("hidden",!1)},hideTab:function(t){this.collection.get(t).set("hidden",!0)},_add:function(t){var e=this,i=t.attributes;this.$content.append(r("<div/>").attr("id",i.id).addClass("tab-pane").append(i.$el)),this.$nav.append(r(this._template_tab(i)).show().tooltip({title:i.tooltip,placement:"bottom",container:e.$el}).on("click",function(t){t.preventDefault(),e.show(i.id)})),1==this.size()&&this.show(i.id)},_remove:function(t){this.$("#tab-"+t.id).remove(),this.$("#"+t.id).remove()},_reset:function(){this.$nav.empty(),this.$content.empty()},_change:function(t){this.$("#tab-"+t.id)[t.get("hidden")?"hide":"show"]()},_template:function(){return r("<div/>").addClass("ui-tabs tabbable tabs-left").append(r("<ul/>").addClass("tab-navigation nav nav-tabs")).append(r("<div/>").addClass("tab-content"))},_template_tab:function(t){var e=r("<li/>").addClass("tab-element").attr("id","tab-"+t.id).append(r("<a/>").attr("id","tab-title-link-"+t.id)),i=e.find("a");return t.icon&&i.append(r("<i/>").addClass("tab-icon fa").addClass(t.icon)),i.append(r("<span/>").attr("id","tab-title-text-"+t.id).addClass("tab-title-text").append(t.title)),e}});return{View:e}}.apply(e,a),!(void 0!==n&&(t.exports=n))}).call(e,i(2),i(1))},function(t,e,i){var a,n;(function(s,r){a=[i(4)],n=function(t){return s.Model.extend({initialize:function(){this.active={},this.last=null},execute:function(e){var i=this,a=t.uid(),n=e.length>0;this.active[a]=!0;var s=r.Deferred();s.promise().always(function(){delete i.active[a],n&&Galaxy.emit.debug("deferred::execute()",this.state().charAt(0).toUpperCase()+this.state().slice(1)+" "+a)}),r.when(this.last).always(function(){i.active[a]?(n&&Galaxy.emit.debug("deferred::execute()","Running "+a),e(s),!n&&s.resolve()):s.reject()}),this.last=s.promise()},reset:function(){Galaxy.emit.debug("deferred::execute()","Reset");for(var t in this.active)this.active[t]=!1},ready:function(){return r.isEmptyObject(this.active)}})}.apply(e,a),!(void 0!==n&&(t.exports=n))}).call(e,i(2),i(1))},function(t,e,i){var a,n;(function(s,r){a=[i(3),i(16),i(27),i(71),i(12),i(49),i(5)],n=function(t,e,i,a,n,o,l){var h={toJSON:function(){var e=this,i={};return t.each(e.constructor.to_json_keys,function(t){var a=e.get(t);t in e.constructor.to_json_mappers&&(a=e.constructor.to_json_mappers[t](a,e)),i[t]=a}),i}},d=function(t,e){var i=new n({url_base:Galaxy.root+"visualization/list_history_datasets",filters:t,dict_format:!0,embedded:!0}),a=new n({url_base:Galaxy.root+"visualization/list_library_datasets",dict_format:!0,embedded:!0}),r=new o.View;r.add({id:"histories",title:"Histories",$el:s("<div/>").append(i.$el)}),r.add({id:"libraries",title:"Libraries",$el:s("<div/>").append(a.$el)}),Galaxy.modal.show({title:"Select datasets for new tracks",body:r.$el,closing_events:!0,buttons:{Cancel:function(){Galaxy.modal.hide()},Add:function(){var t=[];r.$("input.grid-row-select-checkbox[name=id]:checked").each(function(){window.console.log(s(this).val()),t[t.length]=s.ajax({url:Galaxy.root+"api/datasets/"+s(this).val(),dataType:"json",data:{data_type:"track_config",hda_ldda:"histories"==r.current()?"hda":"ldda"}})}),s.when.apply(s,t).then(function(){var t=arguments[0]instanceof Array?s.map(arguments,function(t){return t[0]}):[arguments[0]];e(t)}),Galaxy.modal.hide()}}})},c=function(t){this.default_font=void 0!==t?t:"9px Monaco, Lucida Console, monospace",this.dummy_canvas=this.new_canvas(),this.dummy_context=this.dummy_canvas.getContext("2d"),this.dummy_context.font=this.default_font,this.char_width_px=this.dummy_context.measureText("A").width,this.patterns={},this.load_pattern("right_strand","/visualization/strand_right.png"),this.load_pattern("left_strand","/visualization/strand_left.png"),this.load_pattern("right_strand_inv","/visualization/strand_right_inv.png"),this.load_pattern("left_strand_inv","/visualization/strand_left_inv.png")};t.extend(c.prototype,{load_pattern:function(t,e){var i=this.patterns,a=this.dummy_context,n=new Image;n.src=Galaxy.root+"static/images"+e,n.onload=function(){i[t]=a.createPattern(n,"repeat")}},get_pattern:function(t){return this.patterns[t]},new_canvas:function(){var t=s("<canvas/>")[0];return t.manager=this,t}});var u=r.Model.extend({defaults:{num_elements:20,obj_cache:null,key_ary:null},initialize:function(t){this.clear()},get_elt:function(e){var i=this.attributes.obj_cache,a=this.attributes.key_ary,n=e.toString(),s=t.indexOf(a,function(t){return t.toString()===n});return s!==-1&&(i[n].stale?(a.splice(s,1),delete i[n]):this.move_key_to_end(e,s)),i[n]},set_elt:function(t,e){var i=this.attributes.obj_cache,a=this.attributes.key_ary,n=t.toString(),s=this.attributes.num_elements;if(!i[n]){if(a.length>=s){var r=a.shift();delete i[r.toString()]}a.push(t)}return i[n]=e,e},move_key_to_end:function(t,e){this.attributes.key_ary.splice(e,1),this.attributes.key_ary.push(t)},clear:function(){this.attributes.obj_cache={},this.attributes.key_ary=[]},size:function(){return this.attributes.key_ary.length},most_recently_added:function(){return 0===this.size()?null:this.attributes.key_ary[this.attributes.key_ary.length-1]}}),g=u.extend({defaults:t.extend({},u.prototype.defaults,{dataset:null,genome:null,init_data:null,min_region_size:200,filters_manager:null,data_type:"data",data_mode_compatible:function(t,e){return!0},can_subset:function(t){return!1}}),initialize:function(t){u.prototype.initialize.call(this);var e=this.get("init_data");e&&this.add_data(e)},add_data:function(e){this.get("num_elements")<e.length&&this.set("num_elements",e.length);var i=this;t.each(e,function(t){i.set_data(t.region,t)})},data_is_ready:function(){var t=this.get("dataset"),e=s.Deferred(),a="raw_data"===this.get("data_type")?"state":"data"===this.get("data_type")?"converted_datasets_state":"error",n=new i.ServerStateDeferred({ajax_settings:{url:this.get("dataset").url(),data:{hda_ldda:t.get("hda_ldda"),data_type:a},dataType:"json"},interval:5e3,success_fn:function(t){return"pending"!==t}});return s.when(n.go()).then(function(t){e.resolve("ok"===t||"data"===t)}),e},search_features:function(t){var e=this.get("dataset"),i={query:t,hda_ldda:e.get("hda_ldda"),data_type:"features"};return s.getJSON(e.url(),i)},load_data:function(t,e,i,a){var n=this.get("dataset"),r={data_type:this.get("data_type"),chrom:t.get("chrom"),low:t.get("start"),high:t.get("end"),mode:e,resolution:i,hda_ldda:n.get("hda_ldda")};s.extend(r,a);var o=this.get("filters_manager");if(o){for(var l=[],h=o.filters,d=0;d<h.length;d++)l.push(h[d].name);r.filter_cols=JSON.stringify(l)}var c=this,u=s.getJSON(n.url(),r,function(e){e.region=t,c.set_data(t,e)});return this.set_data(t,u),u},get_data:function(t,e,a,n){var s=this.get_elt(t);if(s&&(i.is_deferred(s)||this.get("data_mode_compatible")(s,e)))return s;for(var r,o,l=this.get("key_ary"),h=this.get("obj_cache"),d=0;d<l.length;d++)if(r=l[d],r.contains(t)&&(o=!0,s=h[r.toString()],i.is_deferred(s)||this.get("data_mode_compatible")(s,e)&&this.get("can_subset")(s))){if(this.move_key_to_end(r,d),!i.is_deferred(s)){var c=this.subset_entry(s,t);this.set_data(t,c),s=c}return s}if(!o&&t.length()<this.attributes.min_region_size){t=t.copy();var u=this.most_recently_added();!u||t.get("start")>u.get("start")?t.set("end",t.get("start")+this.attributes.min_region_size):t.set("start",t.get("end")-this.attributes.min_region_size),t.set("genome",this.attributes.genome),t.trim()}return this.load_data(t,e,a,n)},set_data:function(t,e){this.set_elt(t,e)},DEEP_DATA_REQ:"deep",BROAD_DATA_REQ:"breadth",get_more_data:function(t,e,i,a,n){var r=this._mark_stale(t);if(!r||!this.get("data_mode_compatible")(r,e))return void console.log("ERROR: problem with getting more data: current data is not compatible");var o=t.get("start");n===this.DEEP_DATA_REQ?s.extend(a,{start_val:r.data.length+1}):n===this.BROAD_DATA_REQ&&(o=(r.max_high?r.max_high:r.data[r.data.length-1][2])+1);var l=t.copy().set("start",o),h=this,d=this.load_data(l,e,i,a),c=s.Deferred();return this.set_data(t,c),s.when(d).then(function(e){e.data&&(e.data=r.data.concat(e.data),e.max_low&&(e.max_low=r.max_low),e.message&&(e.message=e.message.replace(/[0-9]+/,e.data.length))),h.set_data(t,e),c.resolve(e)}),c},can_get_more_detailed_data:function(t){var e=this.get_elt(t);return"bigwig"===e.dataset_type&&e.data.length<8e3},get_more_detailed_data:function(t,e,i,a,n){var s=this._mark_stale(t);return s?(n||(n={}),"bigwig"===s.dataset_type&&(n.num_samples=1e3*a),this.load_data(t,e,i,n)):void console.log("ERROR getting more detailed data: no current data")},_mark_stale:function(t){var e=this.get_elt(t);return e||console.log("ERROR: no data to mark as stale: ",this.get("dataset"),t.toString()),e.stale=!0,e},get_genome_wide_data:function(e){var i=this,a=!0,n=t.map(e.get("chroms_info").chrom_info,function(t){var e=i.get_elt(new p({chrom:t.chrom,start:0,end:t.len}));return e||(a=!1),e});if(a)return n;var r=s.Deferred();return s.getJSON(this.get("dataset").url(),{data_type:"genome_data"},function(t){i.add_data(t.data),r.resolve(t.data)}),r},subset_entry:function(e,i){var a={bigwig:function(e,i){return t.filter(e,function(t){return t[0]>=i.get("start")&&t[0]<=i.get("end")})},refseq:function(t,i){var a=i.get("start")-e.region.get("start");return e.data.slice(a,a+i.length())}},n=e.data;return!e.region.same(i)&&e.dataset_type in a&&(n=a[e.dataset_type](e.data,i)),{region:i,data:n,dataset_type:e.dataset_type}}}),f=g.extend({initialize:function(t){var e=new r.Model;e.urlRoot=t.data_url,this.set("dataset",e)},load_data:function(t,e,i,a){return t.length()<=1e5?g.prototype.load_data.call(this,t,e,i,a):{data:null,region:t}}}),_=r.Model.extend({defaults:{name:null,key:null,chroms_info:null},initialize:function(t){this.id=t.dbkey},get_chroms_info:function(){return this.attributes.chroms_info.chrom_info},get_chrom_region:function(e){var i=t.find(this.get_chroms_info(),function(t){return t.chrom===e});return new p({chrom:i.chrom,end:i.len})},get_chrom_len:function(e){return t.find(this.get_chroms_info(),function(t){return t.chrom===e}).len}}),p=r.Model.extend({defaults:{chrom:null,start:0,end:0,str_val:null,genome:null},same:function(t){return this.attributes.chrom===t.get("chrom")&&this.attributes.start===t.get("start")&&this.attributes.end===t.get("end")},initialize:function(t){if(t.from_str){var e=t.from_str.split(":"),i=e[0],a=e[1].split("-");this.set({chrom:i,start:parseInt(a[0],10),end:parseInt(a[1],10)})}this.attributes.str_val=this.get("chrom")+":"+this.get("start")+"-"+this.get("end"),this.on("change",function(){this.attributes.str_val=this.get("chrom")+":"+this.get("start")+"-"+this.get("end")},this)},copy:function(){return new p({chrom:this.get("chrom"),start:this.get("start"),end:this.get("end")})},length:function(){return this.get("end")-this.get("start")},toString:function(){return this.attributes.str_val},toJSON:function(){return{chrom:this.get("chrom"),start:this.get("start"),end:this.get("end")}},compute_overlap:function(t){var e,i=this.get("chrom"),a=t.get("chrom"),n=this.get("start"),s=t.get("start"),r=this.get("end"),o=t.get("end");return i&&a&&i!==a?p.overlap_results.DIF_CHROMS:e=n<s?r<s?p.overlap_results.BEFORE:r<o?p.overlap_results.OVERLAP_START:p.overlap_results.CONTAINS:n>s?n>o?p.overlap_results.AFTER:r<=o?p.overlap_results.CONTAINED_BY:p.overlap_results.OVERLAP_END:r>=o?p.overlap_results.CONTAINS:p.overlap_results.CONTAINED_BY},trim:function(t){if(this.attributes.start<0&&(this.attributes.start=0),this.attributes.genome){var e=this.attributes.genome.get_chrom_len(this.attributes.chrom);this.attributes.end>e&&(this.attributes.end=e-1)}return this},contains:function(t){return this.compute_overlap(t)===p.overlap_results.CONTAINS},overlaps:function(e){return 0===t.intersection([this.compute_overlap(e)],[p.overlap_results.DIF_CHROMS,p.overlap_results.BEFORE,p.overlap_results.AFTER]).length}},{overlap_results:{DIF_CHROMS:1e3,BEFORE:1001,CONTAINS:1002,OVERLAP_START:1003,OVERLAP_END:1004,CONTAINED_BY:1005,AFTER:1006}}),v=r.Collection.extend({model:p}),m=r.Model.extend({defaults:{region:null,note:""},initialize:function(t){this.set("region",new p(t.region))}}),b=r.Collection.extend({model:m}),w=r.Model.extend(h).extend({defaults:{mode:"Auto"},initialize:function(t){this.set("dataset",new e.Dataset(t.dataset));var i=[{key:"name",default_value:this.get("dataset").get("name")},{key:"color"},{key:"min_value",label:"Min Value",type:"float",default_value:0},{key:"max_value",label:"Max Value",type:"float",default_value:1}];this.set("config",a.ConfigSettingCollection.from_models_and_saved_values(i,t.prefs));var n=this.get("preloaded_data");n=n?n.data:[],this.set("data_manager",new g({dataset:this.get("dataset"),init_data:n}))}},{to_json_keys:["track_type","dataset","prefs","mode","filters","tool_state"],to_json_mappers:{prefs:function(e,i){return 0===t.size(e)&&(e={name:i.get("config").get("name").get("value"),color:i.get("config").get("color").get("value")}),e},dataset:function(t){return{id:t.id,hda_ldda:t.get("hda_ldda")}}}}),y=r.Collection.extend({model:w}),x=r.Model.extend({defaults:{title:"",type:""},urlRoot:Galaxy.root+"api/visualizations",save:function(){return s.ajax({url:this.url(),type:"POST",dataType:"json",data:{vis_json:JSON.stringify(this)}})}}),k=x.extend(h).extend({defaults:t.extend({},x.prototype.defaults,{dbkey:"",drawables:null,bookmarks:null,viewport:null}),initialize:function(t){this.set("drawables",new y(t.tracks));var e=[];this.set("config",a.ConfigSettingCollection.from_models_and_saved_values(e,t.prefs)),this.unset("tracks"),this.get("drawables").each(function(t){t.unset("preloaded_data")})},add_tracks:function(t){this.get("drawables").add(t)}},{to_json_keys:["view","viewport","bookmarks"],to_json_mappers:{view:function(t,e){return{obj_type:"View",prefs:{name:e.get("title"),content_visible:!0},drawables:e.get("drawables")}}}}),C=r.Router.extend({initialize:function(t){this.view=t.view,this.route(/([\w]+)$/,"change_location"),this.route(/([\w\+]+\:[\d,]+-[\d,]+)$/,"change_location");var e=this;e.view.on("navigate",function(t){e.navigate(t)})},change_location:function(t){this.view.go_to(t)}});return{BackboneTrack:w,BrowserBookmark:m,BrowserBookmarkCollection:b,Cache:u,CanvasManager:c,Genome:_,GenomeDataManager:g,GenomeRegion:p,GenomeRegionCollection:v,GenomeVisualization:k,GenomeReferenceDataManager:f,TrackBrowserRouter:C,Visualization:x,select_datasets:d}}.apply(e,a),!(void 0!==n&&(t.exports=n))}).call(e,i(1),i(2))},,,,,function(t,e){function i(t){function e(t){n.push(t)}if("string"==typeof t){var a={},n=[],s=i.call(a,e);return s.parse(t),{entries:n,errors:s.getErrors()}}if("function"!=typeof t)throw"Invalid parser construction.";return this.STATES_={ENTRY_OR_JUNK:0,OBJECT_TYPE:1,ENTRY_KEY:2,KV_KEY:3,EQUALS:4,KV_VALUE:5},this.DATA_={},this.CALLBACK_=t,this.CHAR_=0,this.LINE_=1,this.CHAR_IN_LINE_=0,this.SKIPWS_=!0,this.SKIPCOMMENT_=!0,this.PARSETMP_={},this.SKIPTILLEOL_=!1,this.VALBRACES_=null,this.BRACETYPE_=null,this.BRACECOUNT_=0,this.STATE_=this.STATES_.ENTRY_OR_JUNK,this.ERRORS_=[],this.ENTRY_TYPES_={inproceedings:1,proceedings:2,article:3,techreport:4,misc:5,mastersthesis:6,book:7,phdthesis:8,incollection:9,unpublished:10,inbook:11,manual:12,periodical:13,booklet:14,masterthesis:15,conference:16,online:998,data:999},this.MACROS_={jan:"January",feb:"February",mar:"March",apr:"April",may:"May",jun:"June",jul:"July",aug:"August",sep:"September",oct:"October",nov:"November",dec:"December",Jan:"January",Feb:"February",Mar:"March",Apr:"April",May:"May",Jun:"June",Jul:"July",Aug:"August",Sep:"September",Oct:"October",Nov:"November",Dec:"December"},this.getErrors=function(){return this.ERRORS_},this.parse=function(t){for(var e=0;e<t.length;e++)this.processCharacter_(t[e])},this.error_=function(t){this.ERRORS_.push([this.LINE_,this.CHAR_IN_LINE_,this.CHAR_,t])},this.processEntry_=function(){var t=this.DATA_;if(t.Fields)for(var e in t.Fields){for(var i=t.Fields[e],a=0;a<this.CHARCONV_.length;a++){var n=this.CHARCONV_[a][0],s=this.CHARCONV_[a][1];i=i.replace(n,s)}i=i.replace(/[\n\r\t]/g," ").replace(/\s\s+/g," ").replace(/^\s+|\s+$/g,"");for(var r=i.length,o="",a=0;a<r;a++){
var l=i[a],h=!1;"\\"==l&&a<r-1?l=i[++a]:"{"!=l&&"}"!=l||(h=!0),h||(o+=l)}t.Fields[e]=o}if("string"==t.ObjectType)for(var e in t.Fields)this.MACROS_[e]=t.Fields[e];else this.CALLBACK_(t)},this.processCharacter_=function(t){if(this.CHAR_++,this.CHAR_IN_LINE_++,"\n"==t&&(this.LINE_++,this.CHAR_IN_LINE_=1),this.SKIPTILLEOL_)return void("\n"==t&&(this.SKIPTILLEOL_=!1));if(this.SKIPCOMMENT_&&"%"==t)return void(this.SKIPTILLEOL_=!0);if(!this.SKIPWS_||!/\s/.test(t)){this.SKIPWS_=!1,this.SKIPCOMMENT_=!1,this.SKIPTILLEOL_=!1;for(var e=!0;e;)switch(e=!1,this.STATE_){case this.STATES_.ENTRY_OR_JUNK:"@"==t&&(this.STATE_=this.STATES_.OBJECT_TYPE,this.DATA_={ObjectType:""}),this.BRACETYPE_=null,this.SKIPWS_=!0,this.SKIPCOMMENT_=!0;break;case this.STATES_.OBJECT_TYPE:if(/[A-Za-z]/.test(t))this.DATA_.ObjectType+=t.toLowerCase(),this.SKIPWS_=!0,this.SKIPCOMMENT_=!0;else{var i=this.DATA_.ObjectType;"comment"==i?this.STATE_=this.STATES_.ENTRY_OR_JUNK:"string"==i?(this.DATA_.ObjectType=i,this.DATA_.Fields={},this.BRACETYPE_=t,this.BRACECOUNT_=1,this.STATE_=this.STATES_.KV_KEY,this.SKIPWS_=!0,this.SKIPCOMMENT_=!0,this.PARSETMP_={Key:""}):"preamble"==i?this.STATE_=this.STATES_.ENTRY_OR_JUNK:i in this.ENTRY_TYPES_?(this.DATA_.ObjectType="entry",this.DATA_.EntryType=i,this.DATA_.EntryKey="",this.STATE_=this.STATES_.ENTRY_KEY,e=!0):(this.error_('Unrecognized object type: "'+this.DATA_.ObjectType+'"'),this.STATE_=this.STATES_.ENTRY_OR_JUNK)}break;case this.STATES_.ENTRY_KEY:if(("{"===t||"("===t)&&null==this.BRACETYPE_){this.BRACETYPE_=t,this.BRACECOUNT_=1,this.SKIPWS_=!0,this.SKIPCOMMENT_=!0;break}/[,%\s]/.test(t)?this.DATA_.EntryKey.length<1?(this.SKIPWS_=!0,this.SKIPCOMMENT_=!0):null==this.BRACETYPE_?(this.error_("No opening brace for object."),this.STATE_=this.STATES_.ENTRY_OR_JUNK):(this.SKIPWS_=!0,this.SKIPCOMMENT_=!0,e=!0,this.STATE_=this.STATES_.KV_KEY,this.PARSETMP_.Key="",this.DATA_.Fields={}):(this.DATA_.EntryKey+=t,this.SKIPWS_=!1,this.SKIPCOMMENT_=!1);break;case this.STATES_.KV_KEY:if("}"==t&&"{"==this.BRACETYPE_||")"==t&&"("==this.BRACETYPE_){this.processEntry_(),this.SKIPWS_=!0,this.SKIPCOMMENT_=!0,this.STATE_=this.STATES_.ENTRY_OR_JUNK;break}/[\-A-Za-z:]/.test(t)?(this.PARSETMP_.Key+=t,this.SKIPWS_=!1,this.SKIPCOMMENT_=!1):this.PARSETMP_.Key.length<1?(this.SKIPWS_=!0,this.SKIPCOMMENT_=!0):(this.SKIPWS_=!0,this.SKIPCOMMENT_=!0,this.STATE_=this.STATES_.EQUALS,e=!0);break;case this.STATES_.EQUALS:if("}"==t&&"{"==this.BRACETYPE_||")"==t&&"("==this.BRACETYPE_){this.error_('Key-value pair has key "'+this.PARSETMP_.Key+'", but no value.'),this.processEntry_(),this.SKIPWS_=!0,this.SKIPCOMMENT_=!0,this.STATE_=this.STATES_.ENTRY_OR_JUNK;break}"="==t&&(this.SKIPWS_=!0,this.SKIPCOMMENT_=!0,this.STATE_=this.STATES_.KV_VALUE,this.PARSETMP_.Value="",this.VALBRACES_={'"':[],"{":[]});break;case this.STATES_.KV_VALUE:var a=this.VALBRACES_,n=this.PARSETMP_.Value,s=!1;if('"'==t||"{"==t||"}"==t||","==t){if(","==t&&0===a['"'].length+a["{"].length){var r=this.PARSETMP_.Value.trim();r in this.MACROS_?this.PARSETMP_.Value=this.MACROS_[r]:this.error_("Reference to an undefined macro: "+r),s=!0}if('"'==t){if(0===a['"'].length+a["{"].length){a['"'].push(this.CHAR_),this.SKIPWS_=!1,this.SKIPCOMMENT_=!1;break}1!=a['"'].length||0!=a["{"].length||0!=n.length&&"\\"==n[n.length-1]||(s=!0)}if("{"==t&&(0!=n.length&&"\\"==n[n.length-1]||(a["{"].push(this.CHAR_),this.SKIPWS_=!1,this.SKIPCOMMENT_=!1)),"}"==t)if(0===a['"'].length+a["{"].length){var r=this.PARSETMP_.Value.trim();r in this.MACROS_?this.PARSETMP_.Value=this.MACROS_[r]:this.error_("Reference to an undefined macro: "+r),e=!0,s=!0}else 0!=n.length&&"\\"==n[n.length-1]||a["{"].length>0&&(a["{"].splice(a["{"].length-1,1),0==a["{"].length+a['"'].length&&(s=!0))}s?(this.SKIPWS_=!0,this.SKIPCOMMENT_=!0,this.STATE_=this.STATES_.KV_KEY,this.DATA_.Fields[this.PARSETMP_.Key]=this.PARSETMP_.Value,this.PARSETMP_={Key:""},this.VALBRACES_=null):this.PARSETMP_.Value+=t}}},this.CHARCONV_=[[/\\space /g," "],[/\\textdollar /g,"$"],[/\\textquotesingle /g,"'"],[/\\ast /g,"*"],[/\\textbackslash /g,"\\"],[/\\\^\{\}/g,"^"],[/\\textasciigrave /g,"`"],[/\\lbrace /g,"{"],[/\\vert /g,"|"],[/\\rbrace /g,"}"],[/\\textasciitilde /g,"~"],[/\\textexclamdown /g,""],[/\\textcent /g,""],[/\\textsterling /g,""],[/\\textcurrency /g,""],[/\\textyen /g,""],[/\\textbrokenbar /g,""],[/\\textsection /g,""],[/\\textasciidieresis /g,""],[/\\textcopyright /g,""],[/\\textordfeminine /g,""],[/\\guillemotleft /g,""],[/\\lnot /g,""],[/\\textregistered /g,""],[/\\textasciimacron /g,""],[/\\textdegree /g,""],[/\\pm /g,""],[/\\textasciiacute /g,""],[/\\mathrm\{\\mu\}/g,""],[/\\textparagraph /g,""],[/\\cdot /g,""],[/\\c\{\}/g,""],[/\\textordmasculine /g,""],[/\\guillemotright /g,""],[/\\textonequarter /g,""],[/\\textonehalf /g,""],[/\\textthreequarters /g,""],[/\\textquestiondown /g,""],[/\\`\{A\}/g,""],[/\\'\{A\}/g,""],[/\\\^\{A\}/g,""],[/\\~\{A\}/g,""],[/\\"\{A\}/g,""],[/\\AA /g,""],[/\\AE /g,""],[/\\c\{C\}/g,""],[/\\`\{E\}/g,""],[/\\'\{E\}/g,""],[/\\\^\{E\}/g,""],[/\\"\{E\}/g,""],[/\\`\{I\}/g,""],[/\\'\{I\}/g,""],[/\\\^\{I\}/g,""],[/\\"\{I\}/g,""],[/\\DH /g,""],[/\\~\{N\}/g,""],[/\\`\{O\}/g,""],[/\\'\{O\}/g,""],[/\\\^\{O\}/g,""],[/\\~\{O\}/g,""],[/\\"\{O\}/g,""],[/\\texttimes /g,""],[/\\O /g,""],[/\\`\{U\}/g,""],[/\\'\{U\}/g,""],[/\\\^\{U\}/g,""],[/\\"\{U\}/g,""],[/\\'\{Y\}/g,""],[/\\TH /g,""],[/\\ss /g,""],[/\\`\{a\}/g,""],[/\\'\{a\}/g,""],[/\\\^\{a\}/g,""],[/\\~\{a\}/g,""],[/\\"\{a\}/g,""],[/\\aa /g,""],[/\\ae /g,""],[/\\c\{c\}/g,""],[/\\`\{e\}/g,""],[/\\'\{e\}/g,""],[/\\\^\{e\}/g,""],[/\\"\{e\}/g,""],[/\\`\{\\i\}/g,""],[/\\'\{\\i\}/g,""],[/\\\^\{\\i\}/g,""],[/\\"\{\\i\}/g,""],[/\\dh /g,""],[/\\~\{n\}/g,""],[/\\`\{o\}/g,""],[/\\'\{o\}/g,""],[/\\\^\{o\}/g,""],[/\\~\{o\}/g,""],[/\\"\{o\}/g,""],[/\\div /g,""],[/\\o /g,""],[/\\`\{u\}/g,""],[/\\'\{u\}/g,""],[/\\\^\{u\}/g,""],[/\\"\{u\}/g,""],[/\\'\{y\}/g,""],[/\\th /g,""],[/\\"\{y\}/g,""],[/\\=\{A\}/g,""],[/\\=\{a\}/g,""],[/\\u\{A\}/g,""],[/\\u\{a\}/g,""],[/\\k\{A\}/g,""],[/\\k\{a\}/g,""],[/\\'\{C\}/g,""],[/\\'\{c\}/g,""],[/\\\^\{C\}/g,""],[/\\\^\{c\}/g,""],[/\\.\{C\}/g,""],[/\\.\{c\}/g,""],[/\\v\{C\}/g,""],[/\\v\{c\}/g,""],[/\\v\{D\}/g,""],[/\\v\{d\}/g,""],[/\\DJ /g,""],[/\\dj /g,""],[/\\=\{E\}/g,""],[/\\=\{e\}/g,""],[/\\u\{E\}/g,""],[/\\u\{e\}/g,""],[/\\.\{E\}/g,""],[/\\.\{e\}/g,""],[/\\k\{E\}/g,""],[/\\k\{e\}/g,""],[/\\v\{E\}/g,""],[/\\v\{e\}/g,""],[/\\\^\{G\}/g,""],[/\\\^\{g\}/g,""],[/\\u\{G\}/g,""],[/\\u\{g\}/g,""],[/\\.\{G\}/g,""],[/\\.\{g\}/g,""],[/\\c\{G\}/g,""],[/\\c\{g\}/g,""],[/\\\^\{H\}/g,""],[/\\\^\{h\}/g,""],[/\\Elzxh /g,""],[/\\~\{I\}/g,""],[/\\~\{\\i\}/g,""],[/\\=\{I\}/g,""],[/\\=\{\\i\}/g,""],[/\\u\{I\}/g,""],[/\\u\{\\i\}/g,""],[/\\k\{I\}/g,""],[/\\k\{i\}/g,""],[/\\.\{I\}/g,""],[/\\i /g,""],[/\\\^\{J\}/g,""],[/\\\^\{\\j\}/g,""],[/\\c\{K\}/g,""],[/\\c\{k\}/g,""],[/\\'\{L\}/g,""],[/\\'\{l\}/g,""],[/\\c\{L\}/g,""],[/\\c\{l\}/g,""],[/\\v\{L\}/g,""],[/\\v\{l\}/g,""],[/\\L /g,""],[/\\l /g,""],[/\\'\{N\}/g,""],[/\\'\{n\}/g,""],[/\\c\{N\}/g,""],[/\\c\{n\}/g,""],[/\\v\{N\}/g,""],[/\\v\{n\}/g,""],[/\\NG /g,""],[/\\ng /g,""],[/\\=\{O\}/g,""],[/\\=\{o\}/g,""],[/\\u\{O\}/g,""],[/\\u\{o\}/g,""],[/\\H\{O\}/g,""],[/\\H\{o\}/g,""],[/\\OE /g,""],[/\\oe /g,""],[/\\'\{R\}/g,""],[/\\'\{r\}/g,""],[/\\c\{R\}/g,""],[/\\c\{r\}/g,""],[/\\v\{R\}/g,""],[/\\v\{r\}/g,""],[/\\'\{S\}/g,""],[/\\'\{s\}/g,""],[/\\\^\{S\}/g,""],[/\\\^\{s\}/g,""],[/\\c\{S\}/g,""],[/\\c\{s\}/g,""],[/\\v\{S\}/g,""],[/\\v\{s\}/g,""],[/\\c\{T\}/g,""],[/\\c\{t\}/g,""],[/\\v\{T\}/g,""],[/\\v\{t\}/g,""],[/\\~\{U\}/g,""],[/\\~\{u\}/g,""],[/\\=\{U\}/g,""],[/\\=\{u\}/g,""],[/\\u\{U\}/g,""],[/\\u\{u\}/g,""],[/\\r\{U\}/g,""],[/\\r\{u\}/g,""],[/\\H\{U\}/g,""],[/\\H\{u\}/g,""],[/\\k\{U\}/g,""],[/\\k\{u\}/g,""],[/\\\^\{W\}/g,""],[/\\\^\{w\}/g,""],[/\\\^\{Y\}/g,""],[/\\\^\{y\}/g,""],[/\\"\{Y\}/g,""],[/\\'\{Z\}/g,""],[/\\'\{z\}/g,""],[/\\.\{Z\}/g,""],[/\\.\{z\}/g,""],[/\\v\{Z\}/g,""],[/\\v\{z\}/g,""],[/\\texthvlig /g,""],[/\\textnrleg /g,""],[/\\eth /g,""],[/\\textdoublepipe /g,""],[/\\'\{g\}/g,""],[/\\Elztrna /g,""],[/\\Elztrnsa /g,""],[/\\Elzopeno /g,""],[/\\Elzrtld /g,""],[/\\Elzschwa /g,""],[/\\varepsilon /g,""],[/\\Elzpgamma /g,""],[/\\Elzpbgam /g,""],[/\\Elztrnh /g,""],[/\\Elzbtdl /g,""],[/\\Elzrtll /g,""],[/\\Elztrnm /g,""],[/\\Elztrnmlr /g,""],[/\\Elzltlmr /g,""],[/\\Elzltln /g,""],[/\\Elzrtln /g,""],[/\\Elzclomeg /g,""],[/\\textphi /g,""],[/\\Elztrnr /g,""],[/\\Elztrnrl /g,""],[/\\Elzrttrnr /g,""],[/\\Elzrl /g,""],[/\\Elzrtlr /g,""],[/\\Elzfhr /g,""],[/\\Elzrtls /g,""],[/\\Elzesh /g,""],[/\\Elztrnt /g,""],[/\\Elzrtlt /g,""],[/\\Elzpupsil /g,""],[/\\Elzpscrv /g,""],[/\\Elzinvv /g,""],[/\\Elzinvw /g,""],[/\\Elztrny /g,""],[/\\Elzrtlz /g,""],[/\\Elzyogh /g,""],[/\\Elzglst /g,""],[/\\Elzreglst /g,""],[/\\Elzinglst /g,""],[/\\textturnk /g,""],[/\\Elzdyogh /g,""],[/\\Elztesh /g,""],[/\\textasciicaron /g,""],[/\\Elzverts /g,""],[/\\Elzverti /g,""],[/\\Elzlmrk /g,""],[/\\Elzhlmrk /g,""],[/\\Elzsbrhr /g,""],[/\\Elzsblhr /g,""],[/\\Elzrais /g,""],[/\\Elzlow /g,""],[/\\textasciibreve /g,""],[/\\textperiodcentered /g,""],[/\\r\{\}/g,""],[/\\k\{\}/g,""],[/\\texttildelow /g,""],[/\\H\{\}/g,""],[/\\tone\{55\}/g,""],[/\\tone\{44\}/g,""],[/\\tone\{33\}/g,""],[/\\tone\{22\}/g,""],[/\\tone\{11\}/g,""],[/\\cyrchar\\C/g,""],[/\\Elzpalh /g,""],[/\\Elzrh /g,""],[/\\Elzsbbrg /g,""],[/\\Elzxl /g,""],[/\\Elzbar /g,""],[/\\'\{A\}/g,""],[/\\'\{E\}/g,""],[/\\'\{H\}/g,""],[/\\'\{\}\{I\}/g,""],[/\\'\{\}O/g,""],[/\\mathrm\{'Y\}/g,""],[/\\mathrm\{'\\Omega\}/g,""],[/\\acute\{\\ddot\{\\iota\}\}/g,""],[/\\Alpha /g,""],[/\\Beta /g,""],[/\\Gamma /g,""],[/\\Delta /g,""],[/\\Epsilon /g,""],[/\\Zeta /g,""],[/\\Eta /g,""],[/\\Theta /g,""],[/\\Iota /g,""],[/\\Kappa /g,""],[/\\Lambda /g,""],[/\\Xi /g,""],[/\\Pi /g,""],[/\\Rho /g,""],[/\\Sigma /g,""],[/\\Tau /g,""],[/\\Upsilon /g,""],[/\\Phi /g,""],[/\\Chi /g,""],[/\\Psi /g,""],[/\\Omega /g,""],[/\\mathrm\{\\ddot\{I\}\}/g,""],[/\\mathrm\{\\ddot\{Y\}\}/g,""],[/\\'\{\$\\alpha\$\}/g,""],[/\\acute\{\\epsilon\}/g,""],[/\\acute\{\\eta\}/g,""],[/\\acute\{\\iota\}/g,""],[/\\acute\{\\ddot\{\\upsilon\}\}/g,""],[/\\alpha /g,""],[/\\beta /g,""],[/\\gamma /g,""],[/\\delta /g,""],[/\\epsilon /g,""],[/\\zeta /g,""],[/\\eta /g,""],[/\\texttheta /g,""],[/\\iota /g,""],[/\\kappa /g,""],[/\\lambda /g,""],[/\\mu /g,""],[/\\nu /g,""],[/\\xi /g,""],[/\\pi /g,""],[/\\rho /g,""],[/\\varsigma /g,""],[/\\sigma /g,""],[/\\tau /g,""],[/\\upsilon /g,""],[/\\varphi /g,""],[/\\chi /g,""],[/\\psi /g,""],[/\\omega /g,""],[/\\ddot\{\\iota\}/g,""],[/\\ddot\{\\upsilon\}/g,""],[/\\'\{o\}/g,""],[/\\acute\{\\upsilon\}/g,""],[/\\acute\{\\omega\}/g,""],[/\\Pisymbol\{ppi022\}\{87\}/g,""],[/\\textvartheta /g,""],[/\\Upsilon /g,""],[/\\phi /g,""],[/\\varpi /g,""],[/\\Stigma /g,""],[/\\Digamma /g,""],[/\\digamma /g,""],[/\\Koppa /g,""],[/\\Sampi /g,""],[/\\varkappa /g,""],[/\\varrho /g,""],[/\\textTheta /g,""],[/\\backepsilon /g,""],[/\\cyrchar\\CYRYO /g,""],[/\\cyrchar\\CYRDJE /g,""],[/\\cyrchar\{\\'\\CYRG\}/g,""],[/\\cyrchar\\CYRIE /g,""],[/\\cyrchar\\CYRDZE /g,""],[/\\cyrchar\\CYRII /g,""],[/\\cyrchar\\CYRYI /g,""],[/\\cyrchar\\CYRJE /g,""],[/\\cyrchar\\CYRLJE /g,""],[/\\cyrchar\\CYRNJE /g,""],[/\\cyrchar\\CYRTSHE /g,""],[/\\cyrchar\{\\'\\CYRK\}/g,""],[/\\cyrchar\\CYRUSHRT /g,""],[/\\cyrchar\\CYRDZHE /g,""],[/\\cyrchar\\CYRA /g,""],[/\\cyrchar\\CYRB /g,""],[/\\cyrchar\\CYRV /g,""],[/\\cyrchar\\CYRG /g,""],[/\\cyrchar\\CYRD /g,""],[/\\cyrchar\\CYRE /g,""],[/\\cyrchar\\CYRZH /g,""],[/\\cyrchar\\CYRZ /g,""],[/\\cyrchar\\CYRI /g,""],[/\\cyrchar\\CYRISHRT /g,""],[/\\cyrchar\\CYRK /g,""],[/\\cyrchar\\CYRL /g,""],[/\\cyrchar\\CYRM /g,""],[/\\cyrchar\\CYRN /g,""],[/\\cyrchar\\CYRO /g,""],[/\\cyrchar\\CYRP /g,""],[/\\cyrchar\\CYRR /g,""],[/\\cyrchar\\CYRS /g,""],[/\\cyrchar\\CYRT /g,""],[/\\cyrchar\\CYRU /g,""],[/\\cyrchar\\CYRF /g,""],[/\\cyrchar\\CYRH /g,""],[/\\cyrchar\\CYRC /g,""],[/\\cyrchar\\CYRCH /g,""],[/\\cyrchar\\CYRSH /g,""],[/\\cyrchar\\CYRSHCH /g,""],[/\\cyrchar\\CYRHRDSN /g,""],[/\\cyrchar\\CYRERY /g,""],[/\\cyrchar\\CYRSFTSN /g,""],[/\\cyrchar\\CYREREV /g,""],[/\\cyrchar\\CYRYU /g,""],[/\\cyrchar\\CYRYA /g,""],[/\\cyrchar\\cyra /g,""],[/\\cyrchar\\cyrb /g,""],[/\\cyrchar\\cyrv /g,""],[/\\cyrchar\\cyrg /g,""],[/\\cyrchar\\cyrd /g,""],[/\\cyrchar\\cyre /g,""],[/\\cyrchar\\cyrzh /g,""],[/\\cyrchar\\cyrz /g,""],[/\\cyrchar\\cyri /g,""],[/\\cyrchar\\cyrishrt /g,""],[/\\cyrchar\\cyrk /g,""],[/\\cyrchar\\cyrl /g,""],[/\\cyrchar\\cyrm /g,""],[/\\cyrchar\\cyrn /g,""],[/\\cyrchar\\cyro /g,""],[/\\cyrchar\\cyrp /g,""],[/\\cyrchar\\cyrr /g,""],[/\\cyrchar\\cyrs /g,""],[/\\cyrchar\\cyrt /g,""],[/\\cyrchar\\cyru /g,""],[/\\cyrchar\\cyrf /g,""],[/\\cyrchar\\cyrh /g,""],[/\\cyrchar\\cyrc /g,""],[/\\cyrchar\\cyrch /g,""],[/\\cyrchar\\cyrsh /g,""],[/\\cyrchar\\cyrshch /g,""],[/\\cyrchar\\cyrhrdsn /g,""],[/\\cyrchar\\cyrery /g,""],[/\\cyrchar\\cyrsftsn /g,""],[/\\cyrchar\\cyrerev /g,""],[/\\cyrchar\\cyryu /g,""],[/\\cyrchar\\cyrya /g,""],[/\\cyrchar\\cyryo /g,""],[/\\cyrchar\\cyrdje /g,""],[/\\cyrchar\{\\'\\cyrg\}/g,""],[/\\cyrchar\\cyrie /g,""],[/\\cyrchar\\cyrdze /g,""],[/\\cyrchar\\cyrii /g,""],[/\\cyrchar\\cyryi /g,""],[/\\cyrchar\\cyrje /g,""],[/\\cyrchar\\cyrlje /g,""],[/\\cyrchar\\cyrnje /g,""],[/\\cyrchar\\cyrtshe /g,""],[/\\cyrchar\{\\'\\cyrk\}/g,""],[/\\cyrchar\\cyrushrt /g,""],[/\\cyrchar\\cyrdzhe /g,""],[/\\cyrchar\\CYROMEGA /g,""],[/\\cyrchar\\cyromega /g,""],[/\\cyrchar\\CYRYAT /g,""],[/\\cyrchar\\CYRIOTE /g,""],[/\\cyrchar\\cyriote /g,""],[/\\cyrchar\\CYRLYUS /g,""],[/\\cyrchar\\cyrlyus /g,""],[/\\cyrchar\\CYRIOTLYUS /g,""],[/\\cyrchar\\cyriotlyus /g,""],[/\\cyrchar\\CYRBYUS /g,""],[/\\cyrchar\\CYRIOTBYUS /g,""],[/\\cyrchar\\cyriotbyus /g,""],[/\\cyrchar\\CYRKSI /g,""],[/\\cyrchar\\cyrksi /g,""],[/\\cyrchar\\CYRPSI /g,""],[/\\cyrchar\\cyrpsi /g,""],[/\\cyrchar\\CYRFITA /g,""],[/\\cyrchar\\CYRIZH /g,""],[/\\cyrchar\\CYRUK /g,""],[/\\cyrchar\\cyruk /g,""],[/\\cyrchar\\CYROMEGARND /g,""],[/\\cyrchar\\cyromegarnd /g,""],[/\\cyrchar\\CYROMEGATITLO /g,""],[/\\cyrchar\\cyromegatitlo /g,""],[/\\cyrchar\\CYROT /g,""],[/\\cyrchar\\cyrot /g,""],[/\\cyrchar\\CYRKOPPA /g,""],[/\\cyrchar\\cyrkoppa /g,""],[/\\cyrchar\\cyrthousands /g,""],[/\\cyrchar\\cyrhundredthousands /g,""],[/\\cyrchar\\cyrmillions /g,""],[/\\cyrchar\\CYRSEMISFTSN /g,""],[/\\cyrchar\\cyrsemisftsn /g,""],[/\\cyrchar\\CYRRTICK /g,""],[/\\cyrchar\\cyrrtick /g,""],[/\\cyrchar\\CYRGUP /g,""],[/\\cyrchar\\cyrgup /g,""],[/\\cyrchar\\CYRGHCRS /g,""],[/\\cyrchar\\cyrghcrs /g,""],[/\\cyrchar\\CYRGHK /g,""],[/\\cyrchar\\cyrghk /g,""],[/\\cyrchar\\CYRZHDSC /g,""],[/\\cyrchar\\cyrzhdsc /g,""],[/\\cyrchar\\CYRZDSC /g,""],[/\\cyrchar\\cyrzdsc /g,""],[/\\cyrchar\\CYRKDSC /g,""],[/\\cyrchar\\cyrkdsc /g,""],[/\\cyrchar\\CYRKVCRS /g,""],[/\\cyrchar\\cyrkvcrs /g,""],[/\\cyrchar\\CYRKHCRS /g,""],[/\\cyrchar\\cyrkhcrs /g,""],[/\\cyrchar\\CYRKBEAK /g,""],[/\\cyrchar\\cyrkbeak /g,""],[/\\cyrchar\\CYRNDSC /g,""],[/\\cyrchar\\cyrndsc /g,""],[/\\cyrchar\\CYRNG /g,""],[/\\cyrchar\\cyrng /g,""],[/\\cyrchar\\CYRPHK /g,""],[/\\cyrchar\\cyrphk /g,""],[/\\cyrchar\\CYRABHHA /g,""],[/\\cyrchar\\cyrabhha /g,""],[/\\cyrchar\\CYRSDSC /g,""],[/\\cyrchar\\cyrsdsc /g,""],[/\\cyrchar\\CYRTDSC /g,""],[/\\cyrchar\\cyrtdsc /g,""],[/\\cyrchar\\CYRY /g,""],[/\\cyrchar\\cyry /g,""],[/\\cyrchar\\CYRYHCRS /g,""],[/\\cyrchar\\cyryhcrs /g,""],[/\\cyrchar\\CYRHDSC /g,""],[/\\cyrchar\\cyrhdsc /g,""],[/\\cyrchar\\CYRTETSE /g,""],[/\\cyrchar\\cyrtetse /g,""],[/\\cyrchar\\CYRCHRDSC /g,""],[/\\cyrchar\\cyrchrdsc /g,""],[/\\cyrchar\\CYRCHVCRS /g,""],[/\\cyrchar\\cyrchvcrs /g,""],[/\\cyrchar\\CYRSHHA /g,""],[/\\cyrchar\\cyrshha /g,""],[/\\cyrchar\\CYRABHCH /g,""],[/\\cyrchar\\cyrabhch /g,""],[/\\cyrchar\\CYRABHCHDSC /g,""],[/\\cyrchar\\cyrabhchdsc /g,""],[/\\cyrchar\\CYRpalochka /g,""],[/\\cyrchar\\CYRKHK /g,""],[/\\cyrchar\\cyrkhk /g,""],[/\\cyrchar\\CYRNHK /g,""],[/\\cyrchar\\cyrnhk /g,""],[/\\cyrchar\\CYRCHLDSC /g,""],[/\\cyrchar\\cyrchldsc /g,""],[/\\cyrchar\\CYRAE /g,""],[/\\cyrchar\\cyrae /g,""],[/\\cyrchar\\CYRSCHWA /g,""],[/\\cyrchar\\cyrschwa /g,""],[/\\cyrchar\\CYRABHDZE /g,""],[/\\cyrchar\\cyrabhdze /g,""],[/\\cyrchar\\CYROTLD /g,""],[/\\cyrchar\\cyrotld /g,""],[/\\hspace\{0.6em\}/g,""],[/\\hspace\{1em\}/g,""],[/\\hspace\{0.33em\}/g,""],[/\\hspace\{0.25em\}/g,""],[/\\hspace\{0.166em\}/g,""],[/\\hphantom\{0\}/g,""],[/\\hphantom\{,\}/g,""],[/\\hspace\{0.167em\}/g,""],[/\\mkern1mu /g,""],[/\\textendash /g,""],[/\\textemdash /g,""],[/\\rule\{1em\}\{1pt\}/g,""],[/\\Vert /g,""],[/\\Elzreapos /g,""],[/\\textquotedblleft /g,""],[/\\textquotedblright /g,""],[/\\textdagger /g,""],[/\\textdaggerdbl /g,""],[/\\textbullet /g,""],[/\\ldots /g,""],[/\\textperthousand /g,""],[/\\textpertenthousand /g,""],[/\\backprime /g,""],[/\\guilsinglleft /g,""],[/\\guilsinglright /g,""],[/\\mkern4mu /g,""],[/\\nolinebreak /g,""],[/\\ensuremath\{\\Elzpes\}/g,""],[/\\mbox\{\\texteuro\} /g,""],[/\\dddot /g,""],[/\\ddddot /g,""],[/\\mathbb\{C\}/g,""],[/\\mathscr\{g\}/g,""],[/\\mathscr\{H\}/g,""],[/\\mathfrak\{H\}/g,""],[/\\mathbb\{H\}/g,""],[/\\hslash /g,""],[/\\mathscr\{I\}/g,""],[/\\mathfrak\{I\}/g,""],[/\\mathscr\{L\}/g,""],[/\\mathscr\{l\}/g,""],[/\\mathbb\{N\}/g,""],[/\\cyrchar\\textnumero /g,""],[/\\wp /g,""],[/\\mathbb\{P\}/g,""],[/\\mathbb\{Q\}/g,""],[/\\mathscr\{R\}/g,""],[/\\mathfrak\{R\}/g,""],[/\\mathbb\{R\}/g,""],[/\\Elzxrat /g,""],[/\\texttrademark /g,""],[/\\mathbb\{Z\}/g,""],[/\\Omega /g,""],[/\\mho /g,""],[/\\mathfrak\{Z\}/g,""],[/\\ElsevierGlyph\{2129\}/g,""],[/\\AA /g,""],[/\\mathscr\{B\}/g,""],[/\\mathfrak\{C\}/g,""],[/\\mathscr\{e\}/g,""],[/\\mathscr\{E\}/g,""],[/\\mathscr\{F\}/g,""],[/\\mathscr\{M\}/g,""],[/\\mathscr\{o\}/g,""],[/\\aleph /g,""],[/\\beth /g,""],[/\\gimel /g,""],[/\\daleth /g,""],[/\\textfrac\{1\}\{3\}/g,""],[/\\textfrac\{2\}\{3\}/g,""],[/\\textfrac\{1\}\{5\}/g,""],[/\\textfrac\{2\}\{5\}/g,""],[/\\textfrac\{3\}\{5\}/g,""],[/\\textfrac\{4\}\{5\}/g,""],[/\\textfrac\{1\}\{6\}/g,""],[/\\textfrac\{5\}\{6\}/g,""],[/\\textfrac\{1\}\{8\}/g,""],[/\\textfrac\{3\}\{8\}/g,""],[/\\textfrac\{5\}\{8\}/g,""],[/\\textfrac\{7\}\{8\}/g,""],[/\\leftarrow /g,""],[/\\uparrow /g,""],[/\\rightarrow /g,""],[/\\downarrow /g,""],[/\\leftrightarrow /g,""],[/\\updownarrow /g,""],[/\\nwarrow /g,""],[/\\nearrow /g,""],[/\\searrow /g,""],[/\\swarrow /g,""],[/\\nleftarrow /g,""],[/\\nrightarrow /g,""],[/\\arrowwaveright /g,""],[/\\arrowwaveright /g,""],[/\\twoheadleftarrow /g,""],[/\\twoheadrightarrow /g,""],[/\\leftarrowtail /g,""],[/\\rightarrowtail /g,""],[/\\mapsto /g,""],[/\\hookleftarrow /g,""],[/\\hookrightarrow /g,""],[/\\looparrowleft /g,""],[/\\looparrowright /g,""],[/\\leftrightsquigarrow /g,""],[/\\nleftrightarrow /g,""],[/\\Lsh /g,""],[/\\Rsh /g,""],[/\\ElsevierGlyph\{21B3\}/g,""],[/\\curvearrowleft /g,""],[/\\curvearrowright /g,""],[/\\circlearrowleft /g,""],[/\\circlearrowright /g,""],[/\\leftharpoonup /g,""],[/\\leftharpoondown /g,""],[/\\upharpoonright /g,""],[/\\upharpoonleft /g,""],[/\\rightharpoonup /g,""],[/\\rightharpoondown /g,""],[/\\downharpoonright /g,""],[/\\downharpoonleft /g,""],[/\\rightleftarrows /g,""],[/\\dblarrowupdown /g,""],[/\\leftrightarrows /g,""],[/\\leftleftarrows /g,""],[/\\upuparrows /g,""],[/\\rightrightarrows /g,""],[/\\downdownarrows /g,""],[/\\leftrightharpoons /g,""],[/\\rightleftharpoons /g,""],[/\\nLeftarrow /g,""],[/\\nLeftrightarrow /g,""],[/\\nRightarrow /g,""],[/\\Leftarrow /g,""],[/\\Uparrow /g,""],[/\\Rightarrow /g,""],[/\\Downarrow /g,""],[/\\Leftrightarrow /g,""],[/\\Updownarrow /g,""],[/\\Lleftarrow /g,""],[/\\Rrightarrow /g,""],[/\\rightsquigarrow /g,""],[/\\DownArrowUpArrow /g,""],[/\\forall /g,""],[/\\complement /g,""],[/\\partial /g,""],[/\\exists /g,""],[/\\nexists /g,""],[/\\varnothing /g,""],[/\\nabla /g,""],[/\\in /g,""],[/\\not\\in /g,""],[/\\ni /g,""],[/\\not\\ni /g,""],[/\\prod /g,""],[/\\coprod /g,""],[/\\sum /g,""],[/\\mp /g,""],[/\\dotplus /g,""],[/\\setminus /g,""],[/\\circ /g,""],[/\\bullet /g,""],[/\\surd /g,""],[/\\propto /g,""],[/\\infty /g,""],[/\\rightangle /g,""],[/\\angle /g,""],[/\\measuredangle /g,""],[/\\sphericalangle /g,""],[/\\mid /g,""],[/\\nmid /g,""],[/\\parallel /g,""],[/\\nparallel /g,""],[/\\wedge /g,""],[/\\vee /g,""],[/\\cap /g,""],[/\\cup /g,""],[/\\int /g,""],[/\\int\\!\\int /g,""],[/\\int\\!\\int\\!\\int /g,""],[/\\oint /g,""],[/\\surfintegral /g,""],[/\\volintegral /g,""],[/\\clwintegral /g,""],[/\\ElsevierGlyph\{2232\}/g,""],[/\\ElsevierGlyph\{2233\}/g,""],[/\\therefore /g,""],[/\\because /g,""],[/\\Colon /g,""],[/\\ElsevierGlyph\{2238\}/g,""],[/\\mathbin\{\{:\}\\!\\!\{\-\}\\!\\!\{:\}\}/g,""],[/\\homothetic /g,""],[/\\sim /g,""],[/\\backsim /g,""],[/\\lazysinv /g,""],[/\\wr /g,""],[/\\not\\sim /g,""],[/\\ElsevierGlyph\{2242\}/g,""],[/\\NotEqualTilde /g,"-00338"],[/\\simeq /g,""],[/\\not\\simeq /g,""],[/\\cong /g,""],[/\\approxnotequal /g,""],[/\\not\\cong /g,""],[/\\approx /g,""],[/\\not\\approx /g,""],[/\\approxeq /g,""],[/\\tildetrpl /g,""],[/\\not\\apid /g,"-00338"],[/\\allequal /g,""],[/\\asymp /g,""],[/\\Bumpeq /g,""],[/\\NotHumpDownHump /g,"-00338"],[/\\bumpeq /g,""],[/\\NotHumpEqual /g,"-00338"],[/\\doteq /g,""],[/\\not\\doteq/g,"-00338"],[/\\doteqdot /g,""],[/\\fallingdotseq /g,""],[/\\risingdotseq /g,""],[/\\eqcirc /g,""],[/\\circeq /g,""],[/\\estimates /g,""],[/\\ElsevierGlyph\{225A\}/g,""],[/\\starequal /g,""],[/\\triangleq /g,""],[/\\ElsevierGlyph\{225F\}/g,""],[/\\not =/g,""],[/\\equiv /g,""],[/\\not\\equiv /g,""],[/\\leq /g,""],[/\\geq /g,""],[/\\leqq /g,""],[/\\geqq /g,""],[/\\lneqq /g,""],[/\\lvertneqq /g,"-0FE00"],[/\\gneqq /g,""],[/\\gvertneqq /g,"-0FE00"],[/\\ll /g,""],[/\\NotLessLess /g,"-00338"],[/\\gg /g,""],[/\\NotGreaterGreater /g,"-00338"],[/\\between /g,""],[/\\not\\kern\-0.3em\\times /g,""],[/\\not</g,""],[/\\not>/g,""],[/\\not\\leq /g,""],[/\\not\\geq /g,""],[/\\lessequivlnt /g,""],[/\\greaterequivlnt /g,""],[/\\ElsevierGlyph\{2274\}/g,""],[/\\ElsevierGlyph\{2275\}/g,""],[/\\lessgtr /g,""],[/\\gtrless /g,""],[/\\notlessgreater /g,""],[/\\notgreaterless /g,""],[/\\prec /g,""],[/\\succ /g,""],[/\\preccurlyeq /g,""],[/\\succcurlyeq /g,""],[/\\precapprox /g,""],[/\\NotPrecedesTilde /g,"-00338"],[/\\succapprox /g,""],[/\\NotSucceedsTilde /g,"-00338"],[/\\not\\prec /g,""],[/\\not\\succ /g,""],[/\\subset /g,""],[/\\supset /g,""],[/\\not\\subset /g,""],[/\\not\\supset /g,""],[/\\subseteq /g,""],[/\\supseteq /g,""],[/\\not\\subseteq /g,""],[/\\not\\supseteq /g,""],[/\\subsetneq /g,""],[/\\varsubsetneqq /g,"-0FE00"],[/\\supsetneq /g,""],[/\\varsupsetneq /g,"-0FE00"],[/\\uplus /g,""],[/\\sqsubset /g,""],[/\\NotSquareSubset /g,"-00338"],[/\\sqsupset /g,""],[/\\NotSquareSuperset /g,"-00338"],[/\\sqsubseteq /g,""],[/\\sqsupseteq /g,""],[/\\sqcap /g,""],[/\\sqcup /g,""],[/\\oplus /g,""],[/\\ominus /g,""],[/\\otimes /g,""],[/\\oslash /g,""],[/\\odot /g,""],[/\\circledcirc /g,""],[/\\circledast /g,""],[/\\circleddash /g,""],[/\\boxplus /g,""],[/\\boxminus /g,""],[/\\boxtimes /g,""],[/\\boxdot /g,""],[/\\vdash /g,""],[/\\dashv /g,""],[/\\top /g,""],[/\\perp /g,""],[/\\truestate /g,""],[/\\forcesextra /g,""],[/\\Vdash /g,""],[/\\Vvdash /g,""],[/\\VDash /g,""],[/\\nvdash /g,""],[/\\nvDash /g,""],[/\\nVdash /g,""],[/\\nVDash /g,""],[/\\vartriangleleft /g,""],[/\\vartriangleright /g,""],[/\\trianglelefteq /g,""],[/\\trianglerighteq /g,""],[/\\original /g,""],[/\\image /g,""],[/\\multimap /g,""],[/\\hermitconjmatrix /g,""],[/\\intercal /g,""],[/\\veebar /g,""],[/\\rightanglearc /g,""],[/\\ElsevierGlyph\{22C0\}/g,""],[/\\ElsevierGlyph\{22C1\}/g,""],[/\\bigcap /g,""],[/\\bigcup /g,""],[/\\diamond /g,""],[/\\cdot /g,""],[/\\star /g,""],[/\\divideontimes /g,""],[/\\bowtie /g,""],[/\\ltimes /g,""],[/\\rtimes /g,""],[/\\leftthreetimes /g,""],[/\\rightthreetimes /g,""],[/\\backsimeq /g,""],[/\\curlyvee /g,""],[/\\curlywedge /g,""],[/\\Subset /g,""],[/\\Supset /g,""],[/\\Cap /g,""],[/\\Cup /g,""],[/\\pitchfork /g,""],[/\\lessdot /g,""],[/\\gtrdot /g,""],[/\\verymuchless /g,""],[/\\verymuchgreater /g,""],[/\\lesseqgtr /g,""],[/\\gtreqless /g,""],[/\\curlyeqprec /g,""],[/\\curlyeqsucc /g,""],[/\\not\\sqsubseteq /g,""],[/\\not\\sqsupseteq /g,""],[/\\Elzsqspne /g,""],[/\\lnsim /g,""],[/\\gnsim /g,""],[/\\precedesnotsimilar /g,""],[/\\succnsim /g,""],[/\\ntriangleleft /g,""],[/\\ntriangleright /g,""],[/\\ntrianglelefteq /g,""],[/\\ntrianglerighteq /g,""],[/\\vdots /g,""],[/\\cdots /g,""],[/\\upslopeellipsis /g,""],[/\\downslopeellipsis /g,""],[/\\barwedge /g,""],[/\\perspcorrespond /g,""],[/\\lceil /g,""],[/\\rceil /g,""],[/\\lfloor /g,""],[/\\rfloor /g,""],[/\\recorder /g,""],[/\\mathchar"2208/g,""],[/\\ulcorner /g,""],[/\\urcorner /g,""],[/\\llcorner /g,""],[/\\lrcorner /g,""],[/\\frown /g,""],[/\\smile /g,""],[/\\langle /g,""],[/\\rangle /g,""],[/\\ElsevierGlyph\{E838\}/g,""],[/\\Elzdlcorn /g,""],[/\\lmoustache /g,""],[/\\rmoustache /g,""],[/\\textvisiblespace /g,""],[/\\ding\{172\}/g,""],[/\\ding\{173\}/g,""],[/\\ding\{174\}/g,""],[/\\ding\{175\}/g,""],[/\\ding\{176\}/g,""],[/\\ding\{177\}/g,""],[/\\ding\{178\}/g,""],[/\\ding\{179\}/g,""],[/\\ding\{180\}/g,""],[/\\ding\{181\}/g,""],[/\\circledS /g,""],[/\\Elzdshfnc /g,""],[/\\Elzsqfnw /g,""],[/\\diagup /g,""],[/\\ding\{110\}/g,""],[/\\square /g,""],[/\\blacksquare /g,""],[/\\fbox\{~~\}/g,""],[/\\Elzvrecto /g,""],[/\\ElsevierGlyph\{E381\}/g,""],[/\\ding\{115\}/g,""],[/\\bigtriangleup /g,""],[/\\blacktriangle /g,""],[/\\vartriangle /g,""],[/\\blacktriangleright /g,""],[/\\triangleright /g,""],[/\\ding\{116\}/g,""],[/\\bigtriangledown /g,""],[/\\blacktriangledown /g,""],[/\\triangledown /g,""],[/\\blacktriangleleft /g,""],[/\\triangleleft /g,""],[/\\ding\{117\}/g,""],[/\\lozenge /g,""],[/\\bigcirc /g,""],[/\\ding\{108\}/g,""],[/\\Elzcirfl /g,""],[/\\Elzcirfr /g,""],[/\\Elzcirfb /g,""],[/\\ding\{119\}/g,""],[/\\Elzrvbull /g,""],[/\\Elzsqfl /g,""],[/\\Elzsqfr /g,""],[/\\Elzsqfse /g,""],[/\\bigcirc /g,""],[/\\ding\{72\}/g,""],[/\\ding\{73\}/g,""],[/\\ding\{37\}/g,""],[/\\ding\{42\}/g,""],[/\\ding\{43\}/g,""],[/\\rightmoon /g,""],[/\\mercury /g,""],[/\\venus /g,""],[/\\male /g,""],[/\\jupiter /g,""],[/\\saturn /g,""],[/\\uranus /g,""],[/\\neptune /g,""],[/\\pluto /g,""],[/\\aries /g,""],[/\\taurus /g,""],[/\\gemini /g,""],[/\\cancer /g,""],[/\\leo /g,""],[/\\virgo /g,""],[/\\libra /g,""],[/\\scorpio /g,""],[/\\sagittarius /g,""],[/\\capricornus /g,""],[/\\aquarius /g,""],[/\\pisces /g,""],[/\\ding\{171\}/g,""],[/\\diamond /g,""],[/\\ding\{168\}/g,""],[/\\ding\{170\}/g,""],[/\\ding\{169\}/g,""],[/\\quarternote /g,""],[/\\eighthnote /g,""],[/\\flat /g,""],[/\\natural /g,""],[/\\sharp /g,""],[/\\ding\{33\}/g,""],[/\\ding\{34\}/g,""],[/\\ding\{35\}/g,""],[/\\ding\{36\}/g,""],[/\\ding\{38\}/g,""],[/\\ding\{39\}/g,""],[/\\ding\{40\}/g,""],[/\\ding\{41\}/g,""],[/\\ding\{44\}/g,""],[/\\ding\{45\}/g,""],[/\\ding\{46\}/g,""],[/\\ding\{47\}/g,""],[/\\ding\{48\}/g,""],[/\\ding\{49\}/g,""],[/\\ding\{50\}/g,""],[/\\ding\{51\}/g,""],[/\\ding\{52\}/g,""],[/\\ding\{53\}/g,""],[/\\ding\{54\}/g,""],[/\\ding\{55\}/g,""],[/\\ding\{56\}/g,""],[/\\ding\{57\}/g,""],[/\\ding\{58\}/g,""],[/\\ding\{59\}/g,""],[/\\ding\{60\}/g,""],[/\\ding\{61\}/g,""],[/\\ding\{62\}/g,""],[/\\ding\{63\}/g,""],[/\\ding\{64\}/g,""],[/\\ding\{65\}/g,""],[/\\ding\{66\}/g,""],[/\\ding\{67\}/g,""],[/\\ding\{68\}/g,""],[/\\ding\{69\}/g,""],[/\\ding\{70\}/g,""],[/\\ding\{71\}/g,""],[/\\ding\{73\}/g,""],[/\\ding\{74\}/g,""],[/\\ding\{75\}/g,""],[/\\ding\{76\}/g,""],[/\\ding\{77\}/g,""],[/\\ding\{78\}/g,""],[/\\ding\{79\}/g,""],[/\\ding\{80\}/g,""],[/\\ding\{81\}/g,""],[/\\ding\{82\}/g,""],[/\\ding\{83\}/g,""],[/\\ding\{84\}/g,""],[/\\ding\{85\}/g,""],[/\\ding\{86\}/g,""],[/\\ding\{87\}/g,""],[/\\ding\{88\}/g,""],[/\\ding\{89\}/g,""],[/\\ding\{90\}/g,""],[/\\ding\{91\}/g,""],[/\\ding\{92\}/g,""],[/\\ding\{93\}/g,""],[/\\ding\{94\}/g,""],[/\\ding\{95\}/g,""],[/\\ding\{96\}/g,""],[/\\ding\{97\}/g,""],[/\\ding\{98\}/g,""],[/\\ding\{99\}/g,""],[/\\ding\{100\}/g,""],[/\\ding\{101\}/g,""],[/\\ding\{102\}/g,""],[/\\ding\{103\}/g,""],[/\\ding\{104\}/g,""],[/\\ding\{105\}/g,""],[/\\ding\{106\}/g,""],[/\\ding\{107\}/g,""],[/\\ding\{109\}/g,""],[/\\ding\{111\}/g,""],[/\\ding\{112\}/g,""],[/\\ding\{113\}/g,""],[/\\ding\{114\}/g,""],[/\\ding\{118\}/g,""],[/\\ding\{120\}/g,""],[/\\ding\{121\}/g,""],[/\\ding\{122\}/g,""],[/\\ding\{123\}/g,""],[/\\ding\{124\}/g,""],[/\\ding\{125\}/g,""],[/\\ding\{126\}/g,""],[/\\ding\{161\}/g,""],[/\\ding\{162\}/g,""],[/\\ding\{163\}/g,""],[/\\ding\{164\}/g,""],[/\\ding\{165\}/g,""],[/\\ding\{166\}/g,""],[/\\ding\{167\}/g,""],[/\\ding\{182\}/g,""],[/\\ding\{183\}/g,""],[/\\ding\{184\}/g,""],[/\\ding\{185\}/g,""],[/\\ding\{186\}/g,""],[/\\ding\{187\}/g,""],[/\\ding\{188\}/g,""],[/\\ding\{189\}/g,""],[/\\ding\{190\}/g,""],[/\\ding\{191\}/g,""],[/\\ding\{192\}/g,""],[/\\ding\{193\}/g,""],[/\\ding\{194\}/g,""],[/\\ding\{195\}/g,""],[/\\ding\{196\}/g,""],[/\\ding\{197\}/g,""],[/\\ding\{198\}/g,""],[/\\ding\{199\}/g,""],[/\\ding\{200\}/g,""],[/\\ding\{201\}/g,""],[/\\ding\{202\}/g,""],[/\\ding\{203\}/g,""],[/\\ding\{204\}/g,""],[/\\ding\{205\}/g,""],[/\\ding\{206\}/g,""],[/\\ding\{207\}/g,""],[/\\ding\{208\}/g,""],[/\\ding\{209\}/g,""],[/\\ding\{210\}/g,""],[/\\ding\{211\}/g,""],[/\\ding\{212\}/g,""],[/\\ding\{216\}/g,""],[/\\ding\{217\}/g,""],[/\\ding\{218\}/g,""],[/\\ding\{219\}/g,""],[/\\ding\{220\}/g,""],[/\\ding\{221\}/g,""],[/\\ding\{222\}/g,""],[/\\ding\{223\}/g,""],[/\\ding\{224\}/g,""],[/\\ding\{225\}/g,""],[/\\ding\{226\}/g,""],[/\\ding\{227\}/g,""],[/\\ding\{228\}/g,""],[/\\ding\{229\}/g,""],[/\\ding\{230\}/g,""],[/\\ding\{231\}/g,""],[/\\ding\{232\}/g,""],[/\\ding\{233\}/g,""],[/\\ding\{234\}/g,""],[/\\ding\{235\}/g,""],[/\\ding\{236\}/g,""],[/\\ding\{237\}/g,""],[/\\ding\{238\}/g,""],[/\\ding\{239\}/g,""],[/\\ding\{241\}/g,""],[/\\ding\{242\}/g,""],[/\\ding\{243\}/g,""],[/\\ding\{244\}/g,""],[/\\ding\{245\}/g,""],[/\\ding\{246\}/g,""],[/\\ding\{247\}/g,""],[/\\ding\{248\}/g,""],[/\\ding\{249\}/g,""],[/\\ding\{250\}/g,""],[/\\ding\{251\}/g,""],[/\\ding\{252\}/g,""],[/\\ding\{253\}/g,""],[/\\ding\{254\}/g,""],[/\\longleftarrow /g,""],[/\\longrightarrow /g,""],[/\\longleftrightarrow /g,""],[/\\Longleftarrow /g,""],[/\\Longrightarrow /g,""],[/\\Longleftrightarrow /g,""],[/\\longmapsto /g,""],[/\\sim\\joinrel\\leadsto/g,""],[/\\ElsevierGlyph\{E212\}/g,""],[/\\UpArrowBar /g,""],[/\\DownArrowBar /g,""],[/\\ElsevierGlyph\{E20C\}/g,""],[/\\ElsevierGlyph\{E20D\}/g,""],[/\\ElsevierGlyph\{E20B\}/g,""],[/\\ElsevierGlyph\{E20A\}/g,""],[/\\ElsevierGlyph\{E211\}/g,""],[/\\ElsevierGlyph\{E20E\}/g,""],[/\\ElsevierGlyph\{E20F\}/g,""],[/\\ElsevierGlyph\{E210\}/g,""],[/\\ElsevierGlyph\{E21C\}/g,""],[/\\ElsevierGlyph\{E21D\}/g,"-00338"],[/\\ElsevierGlyph\{E21A\}/g,""],[/\\ElsevierGlyph\{E219\}/g,""],[/\\Elolarr /g,""],[/\\Elorarr /g,""],[/\\ElzRlarr /g,""],[/\\ElzrLarr /g,""],[/\\Elzrarrx /g,""],[/\\LeftRightVector /g,""],[/\\RightUpDownVector /g,""],[/\\DownLeftRightVector /g,""],[/\\LeftUpDownVector /g,""],[/\\LeftVectorBar /g,""],[/\\RightVectorBar /g,""],[/\\RightUpVectorBar /g,""],[/\\RightDownVectorBar /g,""],[/\\DownLeftVectorBar /g,""],[/\\DownRightVectorBar /g,""],[/\\LeftUpVectorBar /g,""],[/\\LeftDownVectorBar /g,""],[/\\LeftTeeVector /g,""],[/\\RightTeeVector /g,""],[/\\RightUpTeeVector /g,""],[/\\RightDownTeeVector /g,""],[/\\DownLeftTeeVector /g,""],[/\\DownRightTeeVector /g,""],[/\\LeftUpTeeVector /g,""],[/\\LeftDownTeeVector /g,""],[/\\UpEquilibrium /g,""],[/\\ReverseUpEquilibrium /g,""],[/\\RoundImplies /g,""],[/\\ElsevierGlyph\{E214\}/g,""],[/\\ElsevierGlyph\{E215\}/g,""],[/\\Elztfnc /g,""],[/\\ElsevierGlyph\{3018\}/g,""],[/\\Elroang /g,""],[/\\ElsevierGlyph\{E291\}/g,""],[/\\Elzddfnc /g,""],[/\\Angle /g,""],[/\\Elzlpargt /g,""],[/\\ElsevierGlyph\{E260\}/g,""],[/\\ElsevierGlyph\{E61B\}/g,""],[/\\ElzLap /g,""],[/\\Elzdefas /g,""],[/\\LeftTriangleBar /g,""],[/\\NotLeftTriangleBar /g,"-00338"],[/\\RightTriangleBar /g,""],[/\\NotRightTriangleBar /g,"-00338"],[/\\ElsevierGlyph\{E372\}/g,""],[/\\blacklozenge /g,""],[/\\RuleDelayed /g,""],[/\\Elxuplus /g,""],[/\\ElzThr /g,""],[/\\Elxsqcup /g,""],[/\\ElzInf /g,""],[/\\ElzSup /g,""],[/\\ElzCint /g,""],[/\\clockoint /g,""],[/\\ElsevierGlyph\{E395\}/g,""],[/\\sqrint /g,""],[/\\ElsevierGlyph\{E25A\}/g,""],[/\\ElsevierGlyph\{E25B\}/g,""],[/\\ElsevierGlyph\{E25C\}/g,""],[/\\ElsevierGlyph\{E25D\}/g,""],[/\\ElzTimes /g,""],[/\\ElsevierGlyph\{E25E\}/g,""],[/\\ElsevierGlyph\{E25E\}/g,""],[/\\ElsevierGlyph\{E259\}/g,""],[/\\amalg /g,""],[/\\ElzAnd /g,""],[/\\ElzOr /g,""],[/\\ElsevierGlyph\{E36E\}/g,""],[/\\ElOr /g,""],[/\\perspcorrespond /g,""],[/\\Elzminhat /g,""],[/\\ElsevierGlyph\{225A\}/g,""],[/\\stackrel\{*\}\{=\}/g,""],[/\\Equal /g,""],[/\\leqslant /g,""],[/\\nleqslant /g,"-00338"],[/\\geqslant /g,""],[/\\ngeqslant /g,"-00338"],[/\\lessapprox /g,""],[/\\gtrapprox /g,""],[/\\lneq /g,""],[/\\gneq /g,""],[/\\lnapprox /g,""],[/\\gnapprox /g,""],[/\\lesseqqgtr /g,""],[/\\gtreqqless /g,""],[/\\eqslantless /g,""],[/\\eqslantgtr /g,""],[/\\Pisymbol\{ppi020\}\{117\}/g,""],[/\\Pisymbol\{ppi020\}\{105\}/g,""],[/\\NestedLessLess /g,""],[/\\NotNestedLessLess /g,"-00338"],[/\\NestedGreaterGreater /g,""],[/\\NotNestedGreaterGreater /g,"-00338"],[/\\preceq /g,""],[/\\not\\preceq /g,"-00338"],[/\\succeq /g,""],[/\\not\\succeq /g,"-00338"],[/\\precneqq /g,""],[/\\succneqq /g,""],[/\\precapprox /g,""],[/\\succapprox /g,""],[/\\precnapprox /g,""],[/\\succnapprox /g,""],[/\\subseteqq /g,""],[/\\nsubseteqq /g,"-00338"],[/\\supseteqq /g,""],[/\\nsupseteqq/g,"-00338"],[/\\subsetneqq /g,""],[/\\supsetneqq /g,""],[/\\ElsevierGlyph\{E30D\}/g,""],[/\\Elztdcol /g,""],[/\\ElsevierGlyph\{300A\}/g,""],[/\\ElsevierGlyph\{300B\}/g,""],[/\\ElsevierGlyph\{3018\}/g,""],[/\\ElsevierGlyph\{3019\}/g,""],[/\\openbracketleft /g,""],[/\\openbracketright /g,""]],
this}"undefined"!=typeof t&&t.exports&&(t.exports=i)},function(t,e,i){var a,n;(function(s){a=[i(7),i(28),i(6)],n=function(t,e,i){var a=s.View.extend({tagName:"div",className:"citations",render:function(){return this.$el.append("<p>"+this.formattedReference()+"</p>"),this},formattedReference:function(){var t=this.model,e=t.entryType(),i=t.fields(),a="",n=this._asSentence((i.author?i.author:"")+(i.year?" ("+i.year+")":""))+" ",s=i.title||"",r=i.pages?"pp. "+i.pages:"",o=i.address;if("article"==e){var l=(i.volume?i.volume:"")+(i.number?" ("+i.number+")":"")+(r?", "+r:"");a=n+this._asSentence(s)+(i.journal?"In <em>"+i.journal+", ":"")+this._asSentence(l)+this._asSentence(i.address)+"</em>"}else a="inproceedings"==e||"proceedings"==e?n+this._asSentence(s)+(i.booktitle?"In <em>"+i.booktitle+", ":"")+(r?r:"")+(o?", "+o:"")+".</em>":"mastersthesis"==e||"phdthesis"==e?n+this._asSentence(s)+(i.howpublished?i.howpublished+". ":"")+(i.note?i.note+".":""):"techreport"==e?n+this._asSentence(s)+this._asSentence(i.institution)+this._asSentence(i.number)+this._asSentence(i.type):"book"==e||"inbook"==e||"incollection"==e?n+" "+this._formatBookInfo(i):n+" "+this._asSentence(s)+this._asSentence(i.howpublished)+this._asSentence(i.note);var h="";i.doi&&(h="http://dx.doi.org/"+i.doi,a+='[<a href="'+h+'" target="_blank">doi:'+i.doi+"</a>]");var d=i.url||h;return d&&(a+='[<a href="'+d+'" target="_blank">Link</a>]'),a},_formatBookInfo:function(t){var e="";return t.chapter&&(e+=t.chapter+" in "),t.title&&(e+="<em>"+t.title+"</em>"),t.editor&&(e+=", Edited by "+t.editor+", "),t.publisher&&(e+=", "+t.publisher),t.pages&&(e+=", pp. "+t.pages),t.series&&(e+=", <em>"+t.series+"</em>"),t.volume&&(e+=", Vol."+t.volume),t.issn&&(e+=", ISBN: "+t.issn),e+"."},_asSentence:function(t){return t&&t.trim()?t+". ":""}}),n=s.View.extend({el:"#citations",initialize:function(){this.listenTo(this.collection,"add",this.renderCitation)},events:{"click .citations-to-bibtex":"showBibtex","click .citations-to-formatted":"showFormatted"},renderCitation:function(t){var e=new a({model:t});this.$(".citations-formatted").append(e.render().el);var i=this.$(".citations-bibtex-text");i.val(i.val()+"\n\r"+t.attributes.content)},render:function(){this.$el.html(this.citationsElement()),this.collection.each(function(t){this.renderCitation(t)},this),this.showFormatted()},showBibtex:function(){this.$(".citations-to-formatted").show(),this.$(".citations-to-bibtex").hide(),this.$(".citations-bibtex").show(),this.$(".citations-formatted").hide(),this.$(".citations-bibtex-text").select()},showFormatted:function(){this.$(".citations-to-formatted").hide(),this.$(".citations-to-bibtex").show(),this.$(".citations-bibtex").hide(),this.$(".citations-formatted").show()},partialWarningElement:function(){return this.collection.partial?['<div style="padding:5px 10px">',"<b>Warning: This is a experimental feature.</b> Most Galaxy tools will not annotate"," citations explicitly at this time. When writing up your analysis, please manually"," review your histories and find all references"," that should be cited in order to completely describe your work. Also, please remember to",' <a href="https://galaxyproject.org/citing-galaxy">cite Galaxy</a>.',"</div>"].join(""):""},citationsElement:function(){return['<div class="toolForm">','<div class="toolFormTitle">',i("Citations"),' <button type="button" class="btn btn-xs citations-to-bibtex" title="Show all in BibTeX format."><i class="fa fa-pencil-square-o"></i> Show BibTeX</button>',' <button type="button" class="btn btn-xs citations-to-formatted" title="Return to formatted citation list."><i class="fa fa-times"></i> Hide BibTeX</button>',"</div>",'<div class="toolFormBody" style="padding:5px 10px">',this.partialWarningElement(),'<span class="citations-formatted" style="word-wrap: break-word;"></span>',"</div>",'<div class="citations-bibtex toolFormBody" style="padding:5px 10px">','<textarea style="width: 100%; height: 500px;" class="citations-bibtex-text"></textarea>',"</div>","</div>"].join("")}});return{CitationView:a,CitationListView:n}}.apply(e,a),!(void 0!==n&&(t.exports=n))}).call(e,i(2))},,,,,,,,,,,function(t,e,i){var a,n;(function(s,r){a=[i(3),i(27),i(16),i(47)],n=function(t,e,i,a){"use strict";var n={hidden:!1,show:function(){this.set("hidden",!1)},hide:function(){this.set("hidden",!0)},toggle:function(){this.set("hidden",!this.get("hidden"))},is_visible:function(){return!this.attributes.hidden}},o=s.Model.extend({defaults:{name:null,label:null,type:null,value:null,html:null,num_samples:5},initialize:function(t){this.attributes.html=unescape(this.attributes.html)},copy:function(){return new o(this.toJSON())},set_value:function(t){this.set("value",t||"")}}),l=s.Collection.extend({model:o}),h=o.extend({}),d=o.extend({set_value:function(t){this.set("value",parseInt(t,10))},get_samples:function(){return d3.scale.linear().domain([this.get("min"),this.get("max")]).ticks(this.get("num_samples"))}}),c=d.extend({set_value:function(t){this.set("value",parseFloat(t))}}),u=o.extend({get_samples:function(){return t.map(this.get("options"),function(t){return t[0]})}});o.subModelTypes={integer:d,float:c,data:h,select:u};var g=s.Model.extend({defaults:{id:null,name:null,description:null,target:null,inputs:[],outputs:[]},urlRoot:Galaxy.root+"api/tools",initialize:function(e){this.set("inputs",new l(t.map(e.inputs,function(t){var e=o.subModelTypes[t.type]||o;return new e(t)})))},toJSON:function(){var t=s.Model.prototype.toJSON.call(this);return t.inputs=this.get("inputs").map(function(t){return t.toJSON()}),t},remove_inputs:function(t){var e=this,i=e.get("inputs").filter(function(e){return t.indexOf(e.get("type"))!==-1});e.get("inputs").remove(i)},copy:function(t){var e=new g(this.toJSON());if(t){var i=new s.Collection;e.get("inputs").each(function(t){t.get_samples()&&i.push(t)}),e.set("inputs",i)}return e},apply_search_results:function(e){return t.indexOf(e,this.attributes.id)!==-1?this.show():this.hide(),this.is_visible()},set_input_value:function(t,e){this.get("inputs").find(function(e){return e.get("name")===t}).set("value",e)},set_input_values:function(e){var i=this;t.each(t.keys(e),function(t){i.set_input_value(t,e[t])})},run:function(){return this._run()},rerun:function(t,e){return this._run({action:"rerun",target_dataset_id:t.id,regions:e})},get_inputs_dict:function(){var t={};return this.get("inputs").each(function(e){t[e.get("name")]=e.get("value")}),t},_run:function(a){var n=t.extend({tool_id:this.id,inputs:this.get_inputs_dict()},a),s=r.Deferred(),o=new e.ServerStateDeferred({ajax_settings:{url:this.urlRoot,data:JSON.stringify(n),dataType:"json",contentType:"application/json",type:"POST"},interval:2e3,success_fn:function(t){return"pending"!==t}});return r.when(o.go()).then(function(t){s.resolve(new i.DatasetCollection(t))}),s}});t.extend(g.prototype,n);var f=(s.View.extend({}),s.Collection.extend({model:g})),_=s.Model.extend(n),p=s.Model.extend({defaults:{elems:[],open:!1},clear_search_results:function(){t.each(this.attributes.elems,function(t){t.show()}),this.show(),this.set("open",!1)},apply_search_results:function(e){var i,a=!0;t.each(this.attributes.elems,function(t){t instanceof _?(i=t,i.hide()):t instanceof g&&t.apply_search_results(e)&&(a=!1,i&&i.show())}),a?this.hide():(this.show(),this.set("open",!0))}});t.extend(p.prototype,n);var v=s.Model.extend({defaults:{search_hint_string:"search tools",min_chars_for_search:3,clear_btn_url:"",visible:!0,query:"",results:null,clear_key:27},urlRoot:Galaxy.root+"api/tools",initialize:function(){this.on("change:query",this.do_search)},do_search:function(){var t=this.attributes.query;if(t.length<this.attributes.min_chars_for_search)return void this.set("results",null);var e=t;this.timer&&clearTimeout(this.timer),r("#search-clear-btn").hide(),r("#search-spinner").show();var i=this;this.timer=setTimeout(function(){"undefined"!=typeof ga&&ga("send","pageview",Galaxy.root+"?q="+e),r.get(i.urlRoot,{q:e},function(t){i.set("results",t),r("#search-spinner").hide(),r("#search-clear-btn").show()},"json")},400)},clear_search:function(){this.set("query",""),this.set("results",null)}});t.extend(v.prototype,n);var m=s.Model.extend({initialize:function(t){this.attributes.tool_search=t.tool_search,this.attributes.tool_search.on("change:results",this.apply_search_results,this),this.attributes.tools=t.tools,this.attributes.layout=new s.Collection(this.parse(t.layout))},parse:function(e){var i=this,a=function(e){var n=e.model_class;if(n.indexOf("Tool")===n.length-4)return i.attributes.tools.get(e.id);if("ToolSection"===n){var s=t.map(e.elems,a);return e.elems=s,new p(e)}return"ToolSectionLabel"===n?new _(e):void 0};return t.map(e,a)},clear_search_results:function(){this.get("layout").each(function(t){t instanceof p?t.clear_search_results():t.show()})},apply_search_results:function(){var t=this.get("tool_search").get("results");if(null===t)return void this.clear_search_results();var e=null;this.get("layout").each(function(i){i instanceof _?(e=i,e.hide()):i instanceof g?i.apply_search_results(t)&&e&&e.show():(e=null,i.apply_search_results(t))})}}),b=s.View.extend({initialize:function(){this.model.on("change:hidden",this.update_visible,this),this.update_visible()},update_visible:function(){this.model.attributes.hidden?this.$el.hide():this.$el.show()}}),w=b.extend({tagName:"div",render:function(){var t=r("<div/>");t.append($.tool_link(this.model.toJSON()));var e=this.model.get("form_style",null);if("upload1"===this.model.id)t.find("a").on("click",function(t){t.preventDefault(),Galaxy.upload.show()});else if("regular"===e){var i=this;t.find("a").on("click",function(t){t.preventDefault(),Galaxy.router.push("/",{tool_id:i.model.id,version:i.model.get("version")})})}return this.$el.append(t),this}}),y=b.extend({tagName:"div",className:"toolPanelLabel",render:function(){return this.$el.append(r("<span/>").text(this.model.attributes.text)),this}}),x=b.extend({tagName:"div",className:"toolSectionWrapper",initialize:function(){b.prototype.initialize.call(this),this.model.on("change:open",this.update_open,this)},render:function(){this.$el.append($.panel_section(this.model.toJSON()));var e=this.$el.find(".toolSectionBody");return t.each(this.model.attributes.elems,function(t){if(t instanceof g){var i=new w({model:t,className:"toolTitle"});i.render(),e.append(i.$el)}else if(t instanceof _){var a=new y({model:t});a.render(),e.append(a.$el)}}),this},events:{"click .toolSectionTitle > a":"toggle"},toggle:function(){this.model.set("open",!this.model.attributes.open)},update_open:function(){this.model.attributes.open?this.$el.children(".toolSectionBody").slideDown("fast"):this.$el.children(".toolSectionBody").slideUp("fast")}}),k=s.View.extend({tagName:"div",id:"tool-search",className:"bar",events:{click:"focus_and_select","keyup :input":"query_changed","change :input":"query_changed","click #search-clear-btn":"clear"},render:function(){return this.$el.append($.tool_search(this.model.toJSON())),this.model.is_visible()||this.$el.hide(),r("#messagebox").is(":visible")&&this.$el.css("top","95px"),this.$el.find("[title]").tooltip(),this},focus_and_select:function(){this.$el.find(":input").focus().select()},clear:function(){return this.model.clear_search(),this.$el.find(":input").val(""),this.focus_and_select(),!1},query_changed:function(t){return this.model.attributes.clear_key&&this.model.attributes.clear_key===t.which?(this.clear(),!1):void this.model.set("query",this.$el.find(":input").val())}}),C=s.View.extend({tagName:"div",className:"toolMenu",initialize:function(){this.model.get("tool_search").on("change:results",this.handle_search_results,this)},render:function(){var t=this,e=new k({model:this.model.get("tool_search")});return e.render(),t.$el.append(e.$el),this.model.get("layout").each(function(e){if(e instanceof p){var i=new x({model:e});i.render(),t.$el.append(i.$el)}else if(e instanceof g){var a=new w({model:e,className:"toolTitleNoSection"});a.render(),t.$el.append(a.$el)}else if(e instanceof _){var n=new y({model:e});n.render(),t.$el.append(n.$el)}}),t.$el.find("a.tool-link").click(function(e){var i=r(this).attr("class").split(/\s+/)[0],a=t.model.get("tools").get(i);t.trigger("tool_link_click",e,a)}),this},handle_search_results:function(){var t=this.model.get("tool_search").get("results");t&&0===t.length?r("#search-no-results").show():r("#search-no-results").hide()}}),T=s.View.extend({className:"toolForm",render:function(){this.$el.children().remove(),this.$el.append($.tool_form(this.model.toJSON()))}}),$=(s.View.extend({className:"toolMenuAndView",initialize:function(){this.tool_panel_view=new C({collection:this.collection}),this.tool_form_view=new T},render:function(){this.tool_panel_view.render(),this.tool_panel_view.$el.css("float","left"),this.$el.append(this.tool_panel_view.$el),this.tool_form_view.$el.hide(),this.$el.append(this.tool_form_view.$el);var t=this;this.tool_panel_view.on("tool_link_click",function(e,i){e.preventDefault(),t.show_tool(i)})},show_tool:function(t){var e=this;t.fetch().done(function(){e.tool_form_view.model=t,e.tool_form_view.render(),e.tool_form_view.$el.show(),r("#left").width("650px")})}}),{tool_search:t.template(['<input id="tool-search-query" class="search-query parent-width" name="query" ','placeholder="<%- search_hint_string %>" autocomplete="off" type="text" />','<a id="search-clear-btn" title="clear search (esc)"> </a>','<span id="search-spinner" class="search-spinner fa fa-spinner fa-spin"></span>'].join("")),panel_section:t.template(['<div class="toolSectionTitle" id="title_<%- id %>">','<a href="javascript:void(0)"><span><%- name %></span></a>',"</div>",'<div id="<%- id %>" class="toolSectionBody" style="display: none;">','<div class="toolSectionBg"></div>',"<div>"].join("")),tool_link:t.template(['<a class="<%- id %> tool-link" href="<%= link %>" target="<%- target %>" minsizehint="<%- min_width %>">','<span class="labels">',"<% _.each( labels, function( label ){ %>",'<span class="label label-default label-<%- label %>">',"<%- label %>","</span>","<% }); %>","</span>",'<span class="tool-old-link">',"<%- name %>","</span>"," <%- description %>","</a>"].join("")),tool_form:t.template(['<div class="toolFormTitle"><%- tool.name %> (version <%- tool.version %>)</div>','<div class="toolFormBody">',"<% _.each( tool.inputs, function( input ){ %>",'<div class="form-row">','<label for="<%- input.name %>"><%- input.label %>:</label>','<div class="form-row-input">',"<%= input.html %>","</div>",'<div class="toolParamHelp" style="clear: both;">',"<%- input.help %>","</div>",'<div style="clear: both;"></div>',"</div>","<% }); %>","</div>",'<div class="form-row form-actions">','<input type="submit" class="btn btn-primary" name="runtool_btn" value="Execute" />',"</div>",'<div class="toolHelp">','<div class="toolHelpBody"><% tool.help %></div>',"</div>"].join(""),{variable:"tool"})});return{ToolParameter:o,IntegerToolParameter:d,SelectToolParameter:u,Tool:g,ToolCollection:f,ToolSearch:v,ToolPanel:m,ToolPanelView:C,ToolFormView:T}}.apply(e,a),!(void 0!==n&&(t.exports=n))}).call(e,i(2),i(1))},,,function(t,e,i){var a,n;(function(s,r){a=[i(3),i(27),i(71)],n=function(t,e,i){var a=s.Model.extend({initialize:function(i){var n=this.get("key");this.set("id",n);var s=t.find(a.known_settings_defaults,function(t){return t.key===n});s&&this.set(t.extend({},s,i)),void 0===this.get("value")&&void 0!==this.get("default_value")&&(this.set_value(this.get("default_value")),this.get("value")||"color"!==this.get("type")||this.set("value",e.get_random_color()))},set_value:function(t,e){var i=this.get("type");"float"===i?t=parseFloat(t):"int"===i&&(t=parseInt(t,10)),this.set({value:t},e)}},{known_settings_defaults:[{key:"name",label:"Name",type:"text",default_value:""},{key:"color",label:"Color",type:"color",default_value:null},{key:"min_value",label:"Min Value",type:"float",default_value:null},{key:"max_value",label:"Max Value",type:"float",default_value:null},{key:"mode",type:"string",default_value:this.mode,hidden:!0},{key:"height",type:"int",default_value:32,hidden:!0},{key:"pos_color",label:"Positive Color",type:"color",default_value:"#FF8C00"},{key:"neg_color",label:"Negative Color",type:"color",default_value:"#4169E1"},{key:"block_color",label:"Block color",type:"color",default_value:null},{key:"label_color",label:"Label color",type:"color",default_value:"black"},{key:"show_insertions",label:"Show insertions",type:"bool",default_value:!1},{key:"show_counts",label:"Show summary counts",type:"bool",default_value:!0},{key:"mode",type:"string",default_value:this.mode,hidden:!0},{key:"reverse_strand_color",label:"Antisense strand color",type:"color",default_value:null},{key:"show_differences",label:"Show differences only",type:"bool",default_value:!0},{key:"mode",type:"string",default_value:this.mode,hidden:!0}]}),n=s.Collection.extend({model:a,to_key_value_dict:function(){var t={};return this.each(function(e){t[e.get("key")]=e.get("value")}),t},get_value:function(t){var e=this.get(t);if(e)return e.get("value")},set_value:function(t,e,i){var a=this.get(t);if(a)return a.set_value(e,i)},set_default_value:function(t,e){var i=this.get(t);if(i)return i.set("default_value",e)}},{from_models_and_saved_values:function(e,i){return i&&(e=t.map(e,function(e){return t.extend({},e,{value:i[e.key]})})),new n(e)}}),o=s.View.extend({className:"config-settings-view",render:function(){var i=this.$el;return this.collection.each(function(a,n){if(!a.get("hidden")){var s="param_"+n,o=a.get("type"),l=a.get("value"),h=r("<div class='form-row' />").appendTo(i);if(h.append(r("<label />").attr("for",s).text(a.get("label")+":")),"bool"===o)h.append(r('<input type="checkbox" />').attr("id",s).attr("name",s).attr("checked",l));else if("text"===o)h.append(r('<input type="text"/>').attr("id",s).val(l).click(function(){r(this).select()}));else if("select"===o){var d=r("<select />").attr("id",s);t.each(a.get("options"),function(t){r("<option/>").text(t.label).attr("value",t.value).appendTo(d)}),d.val(l),h.append(d)}else if("color"===o){var c=r("<div/>").appendTo(h),u=r("<input />").attr("id",s).attr("name",s).val(l).css("float","left").appendTo(c).click(function(t){r(".tooltip").removeClass("in");var e=r(this).siblings(".tooltip").addClass("in");e.css({left:r(this).position().left+r(this).width()+5,top:r(this).position().top-r(e).height()/2+r(this).height()/2}).show(),e.click(function(t){t.stopPropagation()}),r(document).bind("click.color-picker",function(){e.hide(),r(document).unbind("click.color-picker")}),t.stopPropagation()}),g=r("<a href='javascript:void(0)'/>").addClass("icon-button arrow-circle").appendTo(c).attr("title","Set new random color").tooltip(),f=r("<div class='tooltip right' style='position: absolute;' />").appendTo(c).hide(),_=r("<div class='tooltip-inner' style='text-align: inherit'></div>").appendTo(f),p=(r("<div class='tooltip-arrow'></div>").appendTo(f),r.farbtastic(_,{width:100,height:100,callback:u,color:l}));c.append(r("<div/>").css("clear","both")),function(t){g.click(function(){t.setColor(e.get_random_color())})}(p)}else h.append(r("<input />").attr("id",s).attr("name",s).val(l));a.help&&h.append(r("<div class='help'/>").text(a.help))}}),this},render_in_modal:function(t){var e=this,i=function(){Galaxy.modal.hide(),r(window).unbind("keypress.check_enter_esc")},a=function(){Galaxy.modal.hide(),r(window).unbind("keypress.check_enter_esc"),e.update_from_form()},n=function(t){27===(t.keyCode||t.which)?i():13===(t.keyCode||t.which)&&a()};r(window).bind("keypress.check_enter_esc",n),0===this.$el.children().length&&this.render(),Galaxy.modal.show({title:t||"Configure",body:this.$el,buttons:{Cancel:i,OK:a}})},update_from_form:function(){var t=this;this.collection.each(function(e,i){if(!e.get("hidden")){var a="param_"+i,n=t.$el.find("#"+a).val();"bool"===e.get("type")&&(n=t.$el.find("#"+a).is(":checked")),e.set_value(n)}})}});return{ConfigSetting:a,ConfigSettingCollection:n,ConfigSettingCollectionView:o}}.apply(e,a),!(void 0!==n&&(t.exports=n))}).call(e,i(2),i(1))},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,i){var a,n;(function(s){a=[i(112),i(111),i(110)],n=function(t,e){"use strict";function i(){}function a(t){t&&(this.id=t)}function n(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]}function r(t,e,i){Math.pow(10,6);return s.ajax({type:"GET",dataType:"native",url:t,timeout:5e3,beforeSend:function(t){t.setRequestHeader("Range","bytes="+e+"-"+(e+(i-1)))},xhrFields:{responseType:"arraybuffer"}})}function o(t,e){var i=t[e]+t[e+1]*C+t[e+2]*T+t[e+3]*$+t[e+4]*S;return i}function l(){}function h(t,e,i,a){this.bwg=t,this.cirTreeOffset=e,this.cirTreeLength=i,this.isSummary=a}function d(t){var e=s.Deferred(),i=new l;return i.url=t,s.when(r(i.url,0,512)).then(function(t){if(!t)return e.resolve(null,"Couldn't fetch file");var a=t,n=new Uint8Array(a),r=new Int16Array(a),l=new Int32Array(a),h=n[0]+C*n[1]+T*n[2]+$*n[3];if(h==v)i.type="bigwig";else{if(h!=b)return h==m||h==w?e.resolve(null,"Currently don't support big-endian BBI files"):e.resolve(null,"Not a supported format, magic=0x"+h.toString(16));i.type="bigbed"}i.version=r[2],i.numZoomLevels=r[3],i.chromTreeOffset=o(n,8),i.unzoomedDataOffset=o(n,16),i.unzoomedIndexOffset=o(n,24),i.fieldCount=r[16],i.definedFieldCount=r[17],i.asOffset=o(n,36),i.totalSummaryOffset=o(n,44),i.uncompressBufSize=l[13],i.extHeaderOffset=o(n,56),i.zoomLevels=[];for(var d=0;d<i.numZoomLevels;++d){var c=l[6*d+16],u=o(n,24*d+72),g=o(n,24*d+80);i.zoomLevels.push({reduction:c,dataOffset:u,indexOffset:g})}s.when(i.readChromTree()).then(function(){i.getAutoSQL(function(t){return i.schema=t,e.resolve(i)})})}),e}function c(t,e,i,a,n){this.bbi=t,this.type=e,this.fieldCount=i,this.offset=a,this.field=n}var u=t.Range,g=t.union,f=t.intersection,_=e.inflateBuffer,p=e.arrayCopy,v=2291137574,m=654086024,b=2273964779,w=3958540679,y=1,x=2,k=3,C=256,T=65536,$=16777216,S=4294967296,E=new RegExp("^[0-9]+,[0-9]+,[0-9]+");return l.prototype.readChromTree=function(){var t=this;this.chromsToIDs={},this.idsToChroms={},this.maxID=0;var e=this.unzoomedDataOffset,i=e-this.chromTreeOffset&3;return e=e+4-i,s.when(r(this.url,this.chromTreeOffset,e-this.chromTreeOffset)).then(function(e){var i=new Uint8Array(e),a=new Int16Array(e),n=new Int32Array(e),s=(n[0],n[1],n[2]),r=(n[3],o(i,16),32),l=function(e){var n=i[e],r=a[e/2+1];e+=4;for(var h=0;h<r;++h)if(0===n){e+=s;var d=o(i,e);e+=8,d-=t.chromTreeOffset,l(d)}else{for(var c="",u=0;u<s;++u){var g=i[e++];0!==g&&(c+=String.fromCharCode(g))}var f=i[e+3]<<24|i[e+2]<<16|i[e+1]<<8|i[e+0];i[e+7]<<24|i[e+6]<<16|i[e+5]<<8|i[e+4];e+=8,t.chromsToIDs[c]=f,0===c.indexOf("chr")&&(t.chromsToIDs[c.substr(3)]=f),t.idsToChroms[f]=c,t.maxID=Math.max(t.maxID,f)}};l(r)})},h.prototype.readWigData=function(t,e,i){var a,n=this.bwg.chromsToIDs[t];return a=void 0===n?[]:this.readWigDataById(n,e,i)},h.prototype.readWigDataById=function(t,e,i){var a=this,n=s.Deferred();if(!this.cirHeader)return s.when(r(a.bwg.url,this.cirTreeOffset,48)).then(function(r){a.cirHeader=r;var o=new Int32Array(a.cirHeader);a.cirBlockSize=o[1],s.when(a.readWigDataById(t,e,i)).then(function(t){n.resolve(t)})}),n;var l=[],h=0,d=(Date.now(),function(a,n,s,r){return(t<0||a==t)&&n<=i&&s>=e}),c=function(t,e){if(a.bwg.instrument&&console.log("level="+e+"; offset="+t+"; time="+(0|Date.now())),h+=t.length,1==t.length&&t[0]-a.cirTreeOffset==48&&a.cachedCirRoot)return _(a.cachedCirRoot,0,e),--h,void(0===h&&s.when(a.fetchFeatures(d,l)).then(function(t){n.resolve(t)}));for(var i,r=4+32*a.cirBlockSize,o=0;o<t.length;++o){var c=new u(t[o],t[o]+r);i=i?g(i,c):c}for(var p=i.ranges(),v=0;v<p.length;++v){var m=p[v];f(t,m,e)}},f=function(t,e,i,o){e.max()-e.min();s.when(r(a.bwg.url,e.min(),e.max()-e.min())).then(function(r){for(var o=0;o<t.length;++o)e.contains(t[o])&&(_(r,t[o]-e.min(),i),t[o]-a.cirTreeOffset==48&&t[o]-e.min()===0&&(a.cachedCirRoot=r),--h,0===h&&s.when(a.fetchFeatures(d,l)).then(function(t){n.resolve(t)}))})},_=function(a,n,s){var r=new Uint8Array(a),h=new Int16Array(a),d=new Int32Array(a),u=r[n],g=h[n/2+1];if(n+=4,0!==u)for(var f=0;f<g;++f){var _=n/4,p=d[_],v=d[_+1],m=d[_+2],b=d[_+3],w=o(r,n+16),y=o(r,n+24);(t<0||p<t||p==t&&v<=i)&&(t<0||m>t||m==t&&b>=e)&&l.push({offset:w,size:y}),n+=32}else{for(var x=[],f=0;f<g;++f){var _=n/4,p=d[_],v=d[_+1],m=d[_+2],b=d[_+3],w=o(r,n+16);(t<0||p<t||p==t&&v<=i)&&(t<0||m>t||m==t&&b>=e)&&x.push(w),n+=24}x.length>0&&c(x,s+1)}};return c([a.cirTreeOffset+48],1),n},h.prototype.fetchFeatures=function(t,e){var a=this,n=s.Deferred();if(e.sort(function(t,e){return(0|t.offset)-(0|e.offset)}),0===e.length)return[];var o=[],l=function(t,e,n,s){s||(s={});var r=new i;r._chromId=t,r.segment=a.bwg.idsToChroms[t],r.min=e,r.max=n,r.type=a.bwg.type;for(var l in s)r[l]=s[l];o.push(r)},h=function(){if(0===e.length){Date.now();return n.resolve(o)}var i=e[0];if(i.data)a.parseFeatures(i.data,l,t),e.splice(0,1),h();else{for(var d=i.offset,c=i.size,u=1;u<e.length&&e[u].offset==d+c;)c+=e[u].size,++u;s.when(r(a.bwg.url,d,c)).then(function(t){for(var i=0,n=0;i<c;){var s,r=e[n];if(a.bwg.uncompressBufSize>0)s=_(t,i+2,r.size-2);else{var o=new Uint8Array(r.size);p(new Uint8Array(t,i,r.size),0,o,0,r.size),s=o.buffer}r.data=s,i+=r.size,++n}h()})}};return h(),n},h.prototype.parseFeatures=function(t,e,i){var n=new Uint8Array(t);if(this.isSummary)for(var r=new Int16Array(t),o=new Int32Array(t),l=new Float32Array(t),h=t.byteLength/32,d=0;d<h;++d){var c=o[8*d],_=o[8*d+1],p=o[8*d+2],v=o[8*d+3],m=(l[8*d+4],l[8*d+5]),b=l[8*d+6];l[8*d+7];if(i(c,_+1,p)){var w={type:"bigwig",score:b/v,maxScore:m};"bigbed"==this.bwg.type&&(w.type="density"),e(c,_+1,p,w)}}else if("bigwig"==this.bwg.type){var r=new Int16Array(t),o=new Int32Array(t),l=new Float32Array(t),c=o[0],C=o[1],T=(o[2],o[3]),$=o[4],S=n[20],h=r[11];if(S==k)for(var d=0;d<h;++d){var A=l[d+6],R=C+d*T+1,z=C+d*T+$;i(c,R,z)&&e(c,R,z,{score:A})}else if(S==x)for(var d=0;d<h;++d){var _=o[2*d+6]+1,p=_+$-1,A=l[2*d+7];i(c,_,p)&&e(c,_,p,{score:A})}else if(S==y)for(var d=0;d<h;++d){var _=o[3*d+6]+1,p=o[3*d+7],A=l[3*d+8];_>p&&(_=p),i(c,_,p)&&e(c,_,p,{score:A})}else console.log("Currently not handling bwgType="+S)}else{if("bigbed"!=this.bwg.type)throw Error("Don't know what to do with "+this.bwg.type);for(var M=0,I=this.bwg.definedFieldCount,D=this.bwg.schema;M<n.length;){var c=n[M+3]<<24|n[M+2]<<16|n[M+1]<<8|n[M+0],_=n[M+7]<<24|n[M+6]<<16|n[M+5]<<8|n[M+4],p=n[M+11]<<24|n[M+10]<<16|n[M+9]<<8|n[M+8];M+=12;for(var V="";;){var O=n[M++];if(0==O)break;V+=String.fromCharCode(O)}var q,N={};if(q=V.length>0?V.split("\t"):[],q.length>0&&I>3&&(N.label=q[0]),q.length>1&&I>4){var A=parseInt(q[1]);isNaN(A)||(N.score=A)}if(q.length>2&&I>5&&(N.orientation=q[2]),q.length>5&&I>8){var G=q[5];E.test(G)&&(N.itemRgb="rgb("+G+")")}if(q.length>I-3&&D)for(var P=I-3;P<q.length;++P)N[D.fields[P+3].name]=q[P];if(i(c,_+1,p,q))if(I<12)e(c,_+1,p,N);else{var B=0|q[3],L=0|q[4],Y=0|q[6],F=q[7].split(","),j=q[8].split(",");if(N.exonFrames){var H=N.exonFrames.split(",");N.exonFrames=void 0}N.type="transcript";var U=new a;for(var K in N)U[K]=N[K];if(U.id=q[0],U.segment=this.bwg.idsToChroms[c],U.min=_+1,U.max=p,U.notes=[],N.groups=[U],q.length>9){var J=N.geneName||q[9],W=J;q.length>10&&(W=q[10]),N.geneName2&&(W=N.geneName2);var X=s.extend({},U);X.id=J,X.label=W,X.type="gene",N.groups.push(X)}for(var Z=[],Q=0;Q<Y;++Q){var tt=(0|j[Q])+_,et=tt+(0|F[Q]),it=new u(tt,et);Z.push(it)}for(var at=g(Z),nt=at.ranges(),st=0;st<nt.length;++st){var rt=nt[st];e(c,rt.min()+1,rt.max(),N)}if(L>B){var ot="+"==N.orientation?new u(B,L+3):new u(B-3,L),lt=f(at,ot);if(lt){N.type="translation";for(var ht=lt.ranges(),dt=0,ct=0;ht[0].min()>nt[ct].max();)ct++;for(var st=0;st<ht.length;++st){var ut=st;"-"==N.orientation&&(ut=ht.length-st-1);var rt=ht[ut];if(N.readframe=dt,H){var gt=parseInt(H[ut+ct]);"number"==typeof gt&&gt>=0&&gt<=2&&(N.readframe=gt,N.readframeExplicit=!0)}var ft=rt.max()-rt.min();dt=(dt+ft)%3,e(c,rt.min()+1,rt.max(),N)}}}}}}},h.prototype.getFirstAdjacent=function(t,e,i,a){var n=this.bwg.chromsToIDs[t];return void 0===n?a([]):void this.getFirstAdjacentById(n,e,i,a)},h.prototype.getFirstAdjacentById=function(t,e,i,a){var n=this;if(!this.cirHeader)return void this.bwg.data.slice(this.cirTreeOffset,48).fetch(function(s){n.cirHeader=s;var r=new Int32Array(n.cirHeader);n.cirBlockSize=r[1],n.getFirstAdjacentById(t,e,i,a)});var s=null,r=-1,l=-1,h=0,d=(Date.now(),function(t,e){h+=t.length;for(var i,a=4+32*n.cirBlockSize,s=0;s<t.length;++s){var r=new u(t[s],t[s]+a);i=i?g(i,r):r}for(var o=i.ranges(),l=0;l<o.length;++l){var d=o[l];c(t,d,e)}}),c=function(r,o,l,d){o.max()-o.min();n.bwg.data.slice(o.min(),o.max()-o.min()).fetch(function(d){for(var c=0;c<r.length;++c)if(o.contains(r[c])&&(f(d,r[c]-o.min(),l),--h,0==h)){if(!s)return i>0&&(0!=t||e>0)?n.getFirstAdjacentById(0,0,i,a):i<0&&(t!=n.bwg.maxID||e<1e9)?n.getFirstAdjacentById(n.bwg.maxID,1e9,i,a):a([]);n.fetchFeatures(function(a,n,s,r){return i<0&&(a<t||s<e)||i>0&&(a>t||n>e)},[s],function(t){for(var e=null,n=-1,s=-1,r=0;r<t.length;++r){var o=t[r],l=o._chromId,h=o.min,d=o.max;(null==e||i<0&&(l>n||d>s)||i>0&&(l<n||h<s))&&(e=o,s=i<0?d:h,n=l)}return a(null!=e?[e]:[])})}})},f=function(a,h,c){var u=new Uint8Array(a),g=new Int16Array(a),f=new Int32Array(a),_=u[h],p=g[h/2+1];if(h+=4,0!=_)for(var v=0;v<p;++v){var m=h/4,b=f[m],w=f[m+1],y=f[m+2],x=f[m+3],k=o(u,h+16),C=o(u,h+24);(i<0&&(b<t||b==t&&w<=e)||i>0&&(y>t||y==t&&x>=e))&&(/_random/.exec(n.bwg.idsToChroms[b])||(null==s||i<0&&(y>r||y==r&&x>l)||i>0&&(b<r||b==r&&w<l))&&(s={offset:k,size:C},l=i<0?x:w,r=i<0?y:b)),h+=32}else{for(var T=-1,$=-1,S=-1,v=0;v<p;++v){var m=h/4,b=f[m],w=f[m+1],y=f[m+2],x=f[m+3],k=f[m+4]<<32|f[m+5];(i<0&&(b<t||b==t&&w<=e)&&y>=t||i>0&&(y>t||y==t&&x>=e)&&b<=t)&&(T<0||x>$)&&(T=k,$=i<0?x:w,S=i<0?y:b),h+=24}T>=0&&d([T],c+1)}};d([n.cirTreeOffset+48],1)},l.prototype.readWigData=function(t,e,i){var a,n=25e3,s=i-e;if(s<=n||0===this.zoomLevels.length)a=this.getUnzoomedView();else for(var r=0;r<this.zoomLevels.length;r++)if(s/this.zoomLevels[r].reduction<n){a=this.getZoomedView(r);break}return a.readWigData(t,e,i)},l.prototype.getUnzoomedView=function(){if(!this.unzoomedView){var t=4e3,e=this.zoomLevels[0];e&&(t=this.zoomLevels[0].dataOffset-this.unzoomedIndexOffset),this.unzoomedView=new h(this,this.unzoomedIndexOffset,t,!1)}return this.unzoomedView},l.prototype.getZoomedView=function(t){var e=this.zoomLevels[t];return e.view||(e.view=new h(this,e.indexOffset,4e3,!0)),e.view},l.prototype._tsFetch=function(t,e,i,a,n){var s=this;if(!(t>=this.zoomLevels.length-1)){var r;return r=t<0?this.getUnzoomedView():this.getZoomedView(t),r.readWigDataById(e,i,a,n)}if(this.topLevelReductionCache){for(var o=[],l=this.topLevelReductionCache,h=0;h<l.length;++h)l[h]._chromId==e&&o.push(l[h]);return n(o)}this.getZoomedView(this.zoomLevels.length-1).readWigDataById(-1,0,3e8,function(r){return s.topLevelReductionCache=r,s._tsFetch(t,e,i,a,n)})},l.prototype.thresholdSearch=function(t,e,i,a,n){function s(){if(0==l.length)return n(null);l.sort(function(t,e){var a=t.zoom-e.zoom;return 0!=a?a:(a=t.chrOrd-e.chrOrd,0!=a?a:t.min-e.min*i)});var t=l.splice(0,1)[0];r._tsFetch(t.zoom,t.chr,t.min,t.max,function(r){var o=i>0?0:3e8;t.fromRef&&(o=e);for(var h=0;h<r.length;++h){var d,c=r[h];if(d=void 0!=c.maxScore?c.maxScore:c.score,i>0){if(d>a)if(t.zoom<0){if(c.min>o)return n(c)}else c.max>o&&l.push({chr:t.chr,chrOrd:t.chrOrd,zoom:t.zoom-2,min:c.min,max:c.max,fromRef:t.fromRef})}else if(d>a)if(t.zoom<0){if(c.max<o)return n(c)}else c.min<o&&l.push({chr:t.chr,chrOrd:t.chrOrd,zoom:t.zoom-2,min:c.min,max:c.max,fromRef:t.fromRef})}s()})}i=i<0?-1:1;for(var r=this,o=this.chromsToIDs[t],l=[{chrOrd:0,chr:o,zoom:r.zoomLevels.length-4,min:0,max:3e8,fromRef:!0}],h=1;h<=this.maxID+1;++h){var d=(o+i*h)%(this.maxID+1);d<0&&(d+=this.maxID+1),l.push({chrOrd:h,chr:d,zoom:r.zoomLevels.length-1,min:0,max:3e8})}s()},l.prototype.getAutoSQL=function(t){return this.asOffset?void s.when(r(this.url,this.asOffset,2048)).then(function(e){for(var i=new Uint8Array(e),a="",n=0;n<i.length&&0!=i[n];++n)a+=String.fromCharCode(i[n]);
var s=/(\w+)\s+(\w+)\s+("([^"]+)")?\s+\(\s*/,r=/([\w\[\]]+)\s+(\w+)\s*;\s*("([^"]+)")?\s*/g,o=s.exec(a);if(o){var l={declType:o[1],name:o[2],comment:o[4],fields:[]};a=a.substring(o[0]);for(var h=r.exec(a);null!=h;h=r.exec(a))l.fields.push({type:h[1],name:h[2],comment:h[4]});return t(l)}}):t(null)},l.prototype.getExtraIndices=function(t){var e=this;return this.version<4||0==this.extHeaderOffset||"bigbed"!=this.type?t(null):void this.data.slice(this.extHeaderOffset,64).fetch(function(i){if(!i)return t(null,"Couldn't fetch extension header");var a=new Uint8Array(i),n=new Int16Array(i),s=(new Int32Array(i),n[0],n[1]),r=o(a,4);return 0==s?t(null):void e.data.slice(r,20*s).fetch(function(i){if(!i)return t(null,"Couldn't fetch index info");for(var a=new Uint8Array(i),n=new Int16Array(i),r=(new Int32Array(i),[]),l=0;l<s;++l){var h=n[10*l],d=n[10*l+1],u=o(a,20*l+4),g=n[10*l+8],f=new c(e,h,d,u,g);r.push(f)}t(r)})})},c.prototype.lookup=function(t,e){var i=this;this.bbi.data.slice(this.offset,32).fetch(function(a){function s(a){i.bbi.data.slice(a,4+h*(d+c)).fetch(function(a){var r=new Uint8Array(a),l=new Uint16Array(a),h=(new Uint32Array(a),r[0]),u=l[1],g=4;if(0!=h){for(var f=0;f<u;++f){for(var _="",p=0;p<d;++p){var v=r[g++];0!=v&&(_+=String.fromCharCode(v))}if(_==t){var m=o(r,g),b=n(r,g+8);return i.bbi.getUnzoomedView().fetchFeatures(function(e,a,n,s){if(s&&s.length>i.field-3)return s[i.field-3]==t},[{offset:m,size:b}],e)}g+=c}return e([])}for(var w=null,f=0;f<u;++f){for(var _="",p=0;p<d;++p){var v=r[g++];0!=v&&(_+=String.fromCharCode(v))}var y=o(r,g);if(g+=8,t.localeCompare(_)<0&&w)return void s(w);w=y}s(w)})}var r=new Uint8Array(a),l=(new Int16Array(a),new Int32Array(a)),h=(l[0],l[1]),d=l[2],c=l[3],u=(o(r,16),32);s(i.offset+u)})},{makeBwg:d}}.apply(e,a),!(void 0!==n&&(t.exports=n))}).call(e,i(1))},function(t,e,i){var a,n,s;(function(r){!function(r,o){n=[i(1)],a=o,s="function"==typeof a?a.apply(e,n):a,!(void 0!==s&&(t.exports=s))}(this,function(t){var e=t.ajaxSettings;e.responseFields.native="responseNative",e.converters["* native"]=!0;var i={},a=0,n={0:200,1223:204},s={},o=r.ajaxSettings.xhr();window.ActiveXObject&&t(window).on("unload",function(){for(var t in s)s[t]()}),i.cors=!!o&&"withCredentials"in o,i.ajax=o=!!o,t.ajaxTransport("native",function(t){var e;if(i.cors||o&&!t.crossDomain)return{send:function(i,r){var o,l=t.xhr(),h=++a,d={};if(l.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(o in t.xhrFields)l[o]=t.xhrFields[o];t.mimeType&&l.overrideMimeType&&l.overrideMimeType(t.mimeType),t.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest");for(o in i)l.setRequestHeader(o,i[o]);e=function(t){return function(){e&&(delete s[h],e=l.onload=l.onerror=null,"abort"===t?l.abort():"error"===t?r(l.status,l.statusText):(l.response&&(d.native=l.response),r(n[l.status]||l.status,l.statusText,d,l.getAllResponseHeaders())))}},l.onload=e(),l.onerror=e("error"),e=s[h]=e("abort");try{l.send(t.hasContent&&t.data||null)}catch(t){if(e)throw t}},abort:function(){e&&e()}}}),t.getNative=function(e,i){return t.ajax({dataType:"native",url:e,xhrFields:{responseType:"arraybuffer"},success:i})}})}).call(e,i(1))},function(t,e,i){var a,n;a=[],n=function(){function t(){}function e(){this.was=[0]}function i(t,e,i){this.hufts=new Int32Array(3*u),this.window=new Uint8Array(i),this.end=i,this.checkfn=e,this.mode=P,this.reset(t,null),this.left=0,this.table=0,this.index=0,this.blens=null,this.bb=new Int32Array(1),this.tb=new Int32Array(1),this.codes=new a,this.last=0,this.bitk=0,this.bitb=0,this.read=0,this.write=0,this.check=0,this.inftree=new n}function a(){}function n(){}function s(t,e,i,a,n){return t[0]=W,e[0]=X,i[0]=Z,a[0]=Q,m}function r(t,e,i,a,n){if(0!=n){if(!t)throw"Undef src";if(!i)throw"Undef dest";0==e&&n==t.length?l(t,i,a):vt?l(t.subarray(e,e+n),i,a):1==t.BYTES_PER_ELEMENT&&n>100?l(new Uint8Array(t.buffer,t.byteOffset+e,n),i,a):o(t,e,i,a,n)}}function o(t,e,i,a,n){for(var s=0;s<n;++s)i[a+s]=t[e+s]}function l(t,e,i){e.set(t,i)}function h(e,i,a,n){e=i?a?new Uint8Array(e,i,a):new Uint8Array(e,i,e.byteLength-i):new Uint8Array(e);var s=new t;s.inflateInit(c,!0),s.next_in=e,s.next_in_index=0,s.avail_in=e.length;for(var o=[],l=0;;){var h=new Uint8Array(32e3);s.next_out=h,s.next_out_index=0,s.avail_out=h.length;var d=s.inflate(_);if(d!=m&&d!=b&&d!=C)throw s.msg;if(0!=s.avail_out){var u=new Uint8Array(h.length-s.avail_out);r(h,0,u,0,h.length-s.avail_out),h=u}if(o.push(h),l+=h.length,d==b||d==C)break}if(n&&(n[0]=(i||0)+s.next_in_index),1==o.length)return o[0].buffer;for(var g=new Uint8Array(l),f=0,p=0;p<o.length;++p){var v=o[p];r(v,0,g,f,v.length),f+=v.length}return g.buffer}var d=15,c=d,u=1440,g=15,f=32,_=0,p=4,v=8,m=0,b=1,w=2,y=-2,x=-3,k=-4,C=-5,T=0,$=1,S=2,E=3,A=4,R=5,z=6,M=7,I=8,D=9,V=10,O=11,q=12,N=13,G=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535],P=0,B=1,L=2,Y=3,F=4,j=5,H=6,U=7,K=8,J=9,W=9,X=5,Z=[96,7,256,0,8,80,0,8,16,84,8,115,82,7,31,0,8,112,0,8,48,0,9,192,80,7,10,0,8,96,0,8,32,0,9,160,0,8,0,0,8,128,0,8,64,0,9,224,80,7,6,0,8,88,0,8,24,0,9,144,83,7,59,0,8,120,0,8,56,0,9,208,81,7,17,0,8,104,0,8,40,0,9,176,0,8,8,0,8,136,0,8,72,0,9,240,80,7,4,0,8,84,0,8,20,85,8,227,83,7,43,0,8,116,0,8,52,0,9,200,81,7,13,0,8,100,0,8,36,0,9,168,0,8,4,0,8,132,0,8,68,0,9,232,80,7,8,0,8,92,0,8,28,0,9,152,84,7,83,0,8,124,0,8,60,0,9,216,82,7,23,0,8,108,0,8,44,0,9,184,0,8,12,0,8,140,0,8,76,0,9,248,80,7,3,0,8,82,0,8,18,85,8,163,83,7,35,0,8,114,0,8,50,0,9,196,81,7,11,0,8,98,0,8,34,0,9,164,0,8,2,0,8,130,0,8,66,0,9,228,80,7,7,0,8,90,0,8,26,0,9,148,84,7,67,0,8,122,0,8,58,0,9,212,82,7,19,0,8,106,0,8,42,0,9,180,0,8,10,0,8,138,0,8,74,0,9,244,80,7,5,0,8,86,0,8,22,192,8,0,83,7,51,0,8,118,0,8,54,0,9,204,81,7,15,0,8,102,0,8,38,0,9,172,0,8,6,0,8,134,0,8,70,0,9,236,80,7,9,0,8,94,0,8,30,0,9,156,84,7,99,0,8,126,0,8,62,0,9,220,82,7,27,0,8,110,0,8,46,0,9,188,0,8,14,0,8,142,0,8,78,0,9,252,96,7,256,0,8,81,0,8,17,85,8,131,82,7,31,0,8,113,0,8,49,0,9,194,80,7,10,0,8,97,0,8,33,0,9,162,0,8,1,0,8,129,0,8,65,0,9,226,80,7,6,0,8,89,0,8,25,0,9,146,83,7,59,0,8,121,0,8,57,0,9,210,81,7,17,0,8,105,0,8,41,0,9,178,0,8,9,0,8,137,0,8,73,0,9,242,80,7,4,0,8,85,0,8,21,80,8,258,83,7,43,0,8,117,0,8,53,0,9,202,81,7,13,0,8,101,0,8,37,0,9,170,0,8,5,0,8,133,0,8,69,0,9,234,80,7,8,0,8,93,0,8,29,0,9,154,84,7,83,0,8,125,0,8,61,0,9,218,82,7,23,0,8,109,0,8,45,0,9,186,0,8,13,0,8,141,0,8,77,0,9,250,80,7,3,0,8,83,0,8,19,85,8,195,83,7,35,0,8,115,0,8,51,0,9,198,81,7,11,0,8,99,0,8,35,0,9,166,0,8,3,0,8,131,0,8,67,0,9,230,80,7,7,0,8,91,0,8,27,0,9,150,84,7,67,0,8,123,0,8,59,0,9,214,82,7,19,0,8,107,0,8,43,0,9,182,0,8,11,0,8,139,0,8,75,0,9,246,80,7,5,0,8,87,0,8,23,192,8,0,83,7,51,0,8,119,0,8,55,0,9,206,81,7,15,0,8,103,0,8,39,0,9,174,0,8,7,0,8,135,0,8,71,0,9,238,80,7,9,0,8,95,0,8,31,0,9,158,84,7,99,0,8,127,0,8,63,0,9,222,82,7,27,0,8,111,0,8,47,0,9,190,0,8,15,0,8,143,0,8,79,0,9,254,96,7,256,0,8,80,0,8,16,84,8,115,82,7,31,0,8,112,0,8,48,0,9,193,80,7,10,0,8,96,0,8,32,0,9,161,0,8,0,0,8,128,0,8,64,0,9,225,80,7,6,0,8,88,0,8,24,0,9,145,83,7,59,0,8,120,0,8,56,0,9,209,81,7,17,0,8,104,0,8,40,0,9,177,0,8,8,0,8,136,0,8,72,0,9,241,80,7,4,0,8,84,0,8,20,85,8,227,83,7,43,0,8,116,0,8,52,0,9,201,81,7,13,0,8,100,0,8,36,0,9,169,0,8,4,0,8,132,0,8,68,0,9,233,80,7,8,0,8,92,0,8,28,0,9,153,84,7,83,0,8,124,0,8,60,0,9,217,82,7,23,0,8,108,0,8,44,0,9,185,0,8,12,0,8,140,0,8,76,0,9,249,80,7,3,0,8,82,0,8,18,85,8,163,83,7,35,0,8,114,0,8,50,0,9,197,81,7,11,0,8,98,0,8,34,0,9,165,0,8,2,0,8,130,0,8,66,0,9,229,80,7,7,0,8,90,0,8,26,0,9,149,84,7,67,0,8,122,0,8,58,0,9,213,82,7,19,0,8,106,0,8,42,0,9,181,0,8,10,0,8,138,0,8,74,0,9,245,80,7,5,0,8,86,0,8,22,192,8,0,83,7,51,0,8,118,0,8,54,0,9,205,81,7,15,0,8,102,0,8,38,0,9,173,0,8,6,0,8,134,0,8,70,0,9,237,80,7,9,0,8,94,0,8,30,0,9,157,84,7,99,0,8,126,0,8,62,0,9,221,82,7,27,0,8,110,0,8,46,0,9,189,0,8,14,0,8,142,0,8,78,0,9,253,96,7,256,0,8,81,0,8,17,85,8,131,82,7,31,0,8,113,0,8,49,0,9,195,80,7,10,0,8,97,0,8,33,0,9,163,0,8,1,0,8,129,0,8,65,0,9,227,80,7,6,0,8,89,0,8,25,0,9,147,83,7,59,0,8,121,0,8,57,0,9,211,81,7,17,0,8,105,0,8,41,0,9,179,0,8,9,0,8,137,0,8,73,0,9,243,80,7,4,0,8,85,0,8,21,80,8,258,83,7,43,0,8,117,0,8,53,0,9,203,81,7,13,0,8,101,0,8,37,0,9,171,0,8,5,0,8,133,0,8,69,0,9,235,80,7,8,0,8,93,0,8,29,0,9,155,84,7,83,0,8,125,0,8,61,0,9,219,82,7,23,0,8,109,0,8,45,0,9,187,0,8,13,0,8,141,0,8,77,0,9,251,80,7,3,0,8,83,0,8,19,85,8,195,83,7,35,0,8,115,0,8,51,0,9,199,81,7,11,0,8,99,0,8,35,0,9,167,0,8,3,0,8,131,0,8,67,0,9,231,80,7,7,0,8,91,0,8,27,0,9,151,84,7,67,0,8,123,0,8,59,0,9,215,82,7,19,0,8,107,0,8,43,0,9,183,0,8,11,0,8,139,0,8,75,0,9,247,80,7,5,0,8,87,0,8,23,192,8,0,83,7,51,0,8,119,0,8,55,0,9,207,81,7,15,0,8,103,0,8,39,0,9,175,0,8,7,0,8,135,0,8,71,0,9,239,80,7,9,0,8,95,0,8,31,0,9,159,84,7,99,0,8,127,0,8,63,0,9,223,82,7,27,0,8,111,0,8,47,0,9,191,0,8,15,0,8,143,0,8,79,0,9,255],Q=[80,5,1,87,5,257,83,5,17,91,5,4097,81,5,5,89,5,1025,85,5,65,93,5,16385,80,5,3,88,5,513,84,5,33,92,5,8193,82,5,9,90,5,2049,86,5,129,192,5,24577,80,5,2,87,5,385,83,5,25,91,5,6145,81,5,7,89,5,1537,85,5,97,93,5,24577,80,5,4,88,5,769,84,5,49,92,5,12289,82,5,13,90,5,3073,86,5,193,192,5,24577],tt=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],et=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,112,112],it=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],at=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13];t.prototype.inflateInit=function(t,i){return t||(t=c),i&&(i=!1),this.istate=new e,this.istate.inflateInit(this,i?-t:t)},t.prototype.inflate=function(t){return null==this.istate?y:this.istate.inflate(this,t)},t.prototype.inflateEnd=function(){if(null==this.istate)return y;var t=istate.inflateEnd(this);return this.istate=null,t},t.prototype.inflateSync=function(){return istate.inflateSync(this)},t.prototype.inflateSetDictionary=function(t,e){return istate.inflateSetDictionary(this,t,e)},e.prototype.inflateReset=function(t){return null==t||null==t.istate?y:(t.total_in=t.total_out=0,t.msg=null,t.istate.mode=0!=t.istate.nowrap?M:T,t.istate.blocks.reset(t,null),m)},e.prototype.inflateEnd=function(t){return null!=this.blocks&&this.blocks.free(t),this.blocks=null,m},e.prototype.inflateInit=function(t,e){return t.msg=null,this.blocks=null,nowrap=0,e<0&&(e=-e,nowrap=1),e<8||e>15?(this.inflateEnd(t),y):(this.wbits=e,t.istate.blocks=new i(t,0!=t.istate.nowrap?null:this,1<<e),this.inflateReset(t),m)},e.prototype.inflate=function(t,e){var i,a;if(null==t||null==t.istate||null==t.next_in)return y;for(e=e==p?C:m,i=C;;)switch(t.istate.mode){case T:if(0==t.avail_in)return i;if(i=e,t.avail_in--,t.total_in++,(15&(t.istate.method=t.next_in[t.next_in_index++]))!=v){t.istate.mode=N,t.msg="unknown compression method",t.istate.marker=5;break}if((t.istate.method>>4)+8>t.istate.wbits){t.istate.mode=N,t.msg="invalid window size",t.istate.marker=5;break}t.istate.mode=$;case $:if(0==t.avail_in)return i;if(i=e,t.avail_in--,t.total_in++,a=255&t.next_in[t.next_in_index++],((t.istate.method<<8)+a)%31!=0){t.istate.mode=N,t.msg="incorrect header check",t.istate.marker=5;break}if(0==(a&f)){t.istate.mode=M;break}t.istate.mode=S;case S:if(0==t.avail_in)return i;i=e,t.avail_in--,t.total_in++,t.istate.need=(255&t.next_in[t.next_in_index++])<<24&4278190080,t.istate.mode=E;case E:if(0==t.avail_in)return i;i=e,t.avail_in--,t.total_in++,t.istate.need+=(255&t.next_in[t.next_in_index++])<<16&16711680,t.istate.mode=A;case A:if(0==t.avail_in)return i;i=e,t.avail_in--,t.total_in++,t.istate.need+=(255&t.next_in[t.next_in_index++])<<8&65280,t.istate.mode=R;case R:return 0==t.avail_in?i:(i=e,t.avail_in--,t.total_in++,t.istate.need+=255&t.next_in[t.next_in_index++],t.adler=t.istate.need,t.istate.mode=z,w);case z:return t.istate.mode=N,t.msg="need dictionary",t.istate.marker=0,y;case M:if(i=t.istate.blocks.proc(t,i),i==x){t.istate.mode=N,t.istate.marker=0;break}if(i==m&&(i=e),i!=b)return i;if(i=e,t.istate.blocks.reset(t,t.istate.was),0!=t.istate.nowrap){t.istate.mode=q;break}t.istate.mode=I;case I:if(0==t.avail_in)return i;i=e,t.avail_in--,t.total_in++,t.istate.need=(255&t.next_in[t.next_in_index++])<<24&4278190080,t.istate.mode=D;case D:if(0==t.avail_in)return i;i=e,t.avail_in--,t.total_in++,t.istate.need+=(255&t.next_in[t.next_in_index++])<<16&16711680,t.istate.mode=V;case V:if(0==t.avail_in)return i;i=e,t.avail_in--,t.total_in++,t.istate.need+=(255&t.next_in[t.next_in_index++])<<8&65280,t.istate.mode=O;case O:if(0==t.avail_in)return i;if(i=e,t.avail_in--,t.total_in++,t.istate.need+=255&t.next_in[t.next_in_index++],t.istate.was[0]!=t.istate.need){t.istate.mode=N,t.msg="incorrect data check",t.istate.marker=5;break}t.istate.mode=q;case q:return b;case N:return x;default:return y}},e.prototype.inflateSetDictionary=function(t,e,i){var a=0,n=i;return null==t||null==t.istate||t.istate.mode!=z?y:t._adler.adler32(1,e,0,i)!=t.adler?x:(t.adler=t._adler.adler32(0,null,0,0),n>=1<<t.istate.wbits&&(n=(1<<t.istate.wbits)-1,a=i-n),t.istate.blocks.set_dictionary(e,a,n),t.istate.mode=M,m)};var nt=[0,0,255,255];e.prototype.inflateSync=function(t){var e,i,a,n,s;if(null==t||null==t.istate)return y;if(t.istate.mode!=N&&(t.istate.mode=N,t.istate.marker=0),0==(e=t.avail_in))return C;for(i=t.next_in_index,a=t.istate.marker;0!=e&&a<4;)t.next_in[i]==nt[a]?a++:a=0!=t.next_in[i]?0:4-a,i++,e--;return t.total_in+=i-t.next_in_index,t.next_in_index=i,t.avail_in=e,t.istate.marker=a,4!=a?x:(n=t.total_in,s=t.total_out,this.inflateReset(t),t.total_in=n,t.total_out=s,t.istate.mode=M,m)},e.prototype.inflateSyncPoint=function(t){return null==t||null==t.istate||null==t.istate.blocks?y:t.istate.blocks.sync_point()};var st=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];i.prototype.reset=function(t,e){e&&(e[0]=this.check),this.mode==H&&this.codes.free(t),this.mode=P,this.bitk=0,this.bitb=0,this.read=this.write=0,this.checkfn&&(t.adler=this.check=t._adler.adler32(0,null,0,0))},i.prototype.proc=function(t,e){var i,a,n,o,l,h,d;for(o=t.next_in_index,l=t.avail_in,a=this.bitb,n=this.bitk,h=this.write,d=h<this.read?this.read-h-1:this.end-h;;)switch(this.mode){case P:for(;n<3;){if(0==l)return this.bitb=a,this.bitk=n,t.avail_in=l,t.total_in+=o-t.next_in_index,t.next_in_index=o,this.write=h,this.inflate_flush(t,e);e=m,l--,a|=(255&t.next_in[o++])<<n,n+=8}switch(i=7&a,this.last=1&i,i>>>1){case 0:a>>>=3,n-=3,i=7&n,a>>>=i,n-=i,this.mode=B;break;case 1:var c=new Int32Array(1),u=new Int32Array(1),g=[],f=[];s(c,u,g,f,t),this.codes.init(c[0],u[0],g[0],0,f[0],0,t),a>>>=3,n-=3,this.mode=H;break;case 2:a>>>=3,n-=3,this.mode=Y;break;case 3:return a>>>=3,n-=3,this.mode=N,t.msg="invalid block type",e=x,this.bitb=a,this.bitk=n,t.avail_in=l,t.total_in+=o-t.next_in_index,t.next_in_index=o,this.write=h,this.inflate_flush(t,e)}break;case B:for(;n<32;){if(0==l)return this.bitb=a,this.bitk=n,t.avail_in=l,t.total_in+=o-t.next_in_index,t.next_in_index=o,this.write=h,this.inflate_flush(t,e);e=m,l--,a|=(255&t.next_in[o++])<<n,n+=8}if((~a>>>16&65535)!=(65535&a))return this.mode=N,t.msg="invalid stored block lengths",e=x,this.bitb=a,this.bitk=n,t.avail_in=l,t.total_in+=o-t.next_in_index,t.next_in_index=o,this.write=h,this.inflate_flush(t,e);this.left=65535&a,a=n=0,this.mode=0!=this.left?L:0!=this.last?U:P;break;case L:if(0==l)return this.bitb=a,this.bitk=n,t.avail_in=l,t.total_in+=o-t.next_in_index,t.next_in_index=o,write=h,this.inflate_flush(t,e);if(0==d&&(h==end&&0!=read&&(h=0,d=h<this.read?this.read-h-1:this.end-h),0==d&&(this.write=h,e=this.inflate_flush(t,e),h=this.write,d=h<this.read?this.read-h-1:this.end-h,h==this.end&&0!=this.read&&(h=0,d=h<this.read?this.read-h-1:this.end-h),0==d)))return this.bitb=a,this.bitk=n,t.avail_in=l,t.total_in+=o-t.next_in_index,t.next_in_index=o,this.write=h,this.inflate_flush(t,e);if(e=m,i=this.left,i>l&&(i=l),i>d&&(i=d),r(t.next_in,o,this.window,h,i),o+=i,l-=i,h+=i,d-=i,0!=(this.left-=i))break;this.mode=0!=this.last?U:P;break;case Y:for(;n<14;){if(0==l)return this.bitb=a,this.bitk=n,t.avail_in=l,t.total_in+=o-t.next_in_index,t.next_in_index=o,this.write=h,this.inflate_flush(t,e);e=m,l--,a|=(255&t.next_in[o++])<<n,n+=8}if(this.table=i=16383&a,(31&i)>29||(i>>5&31)>29)return this.mode=J,t.msg="too many length or distance symbols",e=x,this.bitb=a,this.bitk=n,t.avail_in=l,t.total_in+=o-t.next_in_index,t.next_in_index=o,this.write=h,this.inflate_flush(t,e);if(i=258+(31&i)+(i>>5&31),null==this.blens||this.blens.length<i)this.blens=new Int32Array(i);else for(var _=0;_<i;_++)this.blens[_]=0;a>>>=14,n-=14,this.index=0,mode=F;case F:for(;this.index<4+(this.table>>>10);){for(;n<3;){if(0==l)return this.bitb=a,this.bitk=n,t.avail_in=l,t.total_in+=o-t.next_in_index,t.next_in_index=o,this.write=h,this.inflate_flush(t,e);e=m,l--,a|=(255&t.next_in[o++])<<n,n+=8}this.blens[st[this.index++]]=7&a,a>>>=3,n-=3}for(;this.index<19;)this.blens[st[this.index++]]=0;if(this.bb[0]=7,i=this.inftree.inflate_trees_bits(this.blens,this.bb,this.tb,this.hufts,t),i!=m)return e=i,e==x&&(this.blens=null,this.mode=J),this.bitb=a,this.bitk=n,t.avail_in=l,t.total_in+=o-t.next_in_index,t.next_in_index=o,write=h,this.inflate_flush(t,e);this.index=0,this.mode=j;case j:for(;;){if(i=this.table,!(this.index<258+(31&i)+(i>>5&31)))break;var _,p,v;for(i=this.bb[0];n<i;){if(0==l)return this.bitb=a,this.bitk=n,t.avail_in=l,t.total_in+=o-t.next_in_index,t.next_in_index=o,this.write=h,this.inflate_flush(t,e);e=m,l--,a|=(255&t.next_in[o++])<<n,n+=8}if(i=this.hufts[3*(this.tb[0]+(a&G[i]))+1],v=this.hufts[3*(this.tb[0]+(a&G[i]))+2],v<16)a>>>=i,n-=i,this.blens[this.index++]=v;else{for(_=18==v?7:v-14,p=18==v?11:3;n<i+_;){if(0==l)return this.bitb=a,this.bitk=n,t.avail_in=l,t.total_in+=o-t.next_in_index,t.next_in_index=o,this.write=h,this.inflate_flush(t,e);e=m,l--,a|=(255&t.next_in[o++])<<n,n+=8}if(a>>>=i,n-=i,p+=a&G[_],a>>>=_,n-=_,_=this.index,i=this.table,_+p>258+(31&i)+(i>>5&31)||16==v&&_<1)return this.blens=null,this.mode=J,t.msg="invalid bit length repeat",e=x,this.bitb=a,this.bitk=n,t.avail_in=l,t.total_in+=o-t.next_in_index,t.next_in_index=o,this.write=h,this.inflate_flush(t,e);v=16==v?this.blens[_-1]:0;do this.blens[_++]=v;while(0!=--p);this.index=_}}this.tb[0]=-1;var c=new Int32Array(1),u=new Int32Array(1),g=new Int32Array(1),f=new Int32Array(1);if(c[0]=9,u[0]=6,i=this.table,i=this.inftree.inflate_trees_dynamic(257+(31&i),1+(i>>5&31),this.blens,c,u,g,f,this.hufts,t),i!=m)return i==x&&(this.blens=null,this.mode=N),e=i,this.bitb=a,this.bitk=n,t.avail_in=l,t.total_in+=o-t.next_in_index,t.next_in_index=o,this.write=h,this.inflate_flush(t,e);this.codes.init(c[0],u[0],this.hufts,g[0],this.hufts,f[0],t),this.mode=H;case H:if(this.bitb=a,this.bitk=n,t.avail_in=l,t.total_in+=o-t.next_in_index,t.next_in_index=o,this.write=h,(e=this.codes.proc(this,t,e))!=b)return this.inflate_flush(t,e);if(e=m,this.codes.free(t),o=t.next_in_index,l=t.avail_in,a=this.bitb,n=this.bitk,h=this.write,d=h<this.read?this.read-h-1:this.end-h,0==this.last){this.mode=P;break}this.mode=U;case U:if(this.write=h,e=this.inflate_flush(t,e),h=this.write,d=h<this.read?this.read-h-1:this.end-h,this.read!=this.write)return this.bitb=a,this.bitk=n,t.avail_in=l,t.total_in+=o-t.next_in_index,t.next_in_index=o,this.write=h,this.inflate_flush(t,e);mode=q;case K:return e=b,this.bitb=a,this.bitk=n,t.avail_in=l,t.total_in+=o-t.next_in_index,t.next_in_index=o,this.write=h,this.inflate_flush(t,e);case J:return e=x,this.bitb=a,this.bitk=n,t.avail_in=l,t.total_in+=o-t.next_in_index,t.next_in_index=o,this.write=h,this.inflate_flush(t,e);default:return e=y,this.bitb=a,this.bitk=n,t.avail_in=l,t.total_in+=o-t.next_in_index,t.next_in_index=o,this.write=h,this.inflate_flush(t,e)}},i.prototype.free=function(t){this.reset(t,null),this.window=null,this.hufts=null},i.prototype.set_dictionary=function(t,e,i){r(t,e,window,0,i),this.read=this.write=i},i.prototype.sync_point=function(){return this.mode==B},i.prototype.inflate_flush=function(t,e){var i,a,n;return a=t.next_out_index,n=this.read,i=(n<=this.write?this.write:this.end)-n,i>t.avail_out&&(i=t.avail_out),0!=i&&e==C&&(e=m),t.avail_out-=i,t.total_out+=i,null!=this.checkfn&&(t.adler=this.check=t._adler.adler32(this.check,this.window,n,i)),r(this.window,n,t.next_out,a,i),a+=i,n+=i,n==this.end&&(n=0,this.write==this.end&&(this.write=0),i=this.write-n,i>t.avail_out&&(i=t.avail_out),0!=i&&e==C&&(e=m),t.avail_out-=i,t.total_out+=i,null!=this.checkfn&&(t.adler=this.check=t._adler.adler32(this.check,this.window,n,i)),r(this.window,n,t.next_out,a,i),a+=i,n+=i),t.next_out_index=a,this.read=n,e};var rt=0,ot=1,lt=2,ht=3,dt=4,ct=5,ut=6,gt=7,ft=8,_t=9;a.prototype.init=function(t,e,i,a,n,s,r){this.mode=rt,this.lbits=t,this.dbits=e,this.ltree=i,this.ltree_index=a,this.dtree=n,this.dtree_index=s,this.tree=null},a.prototype.proc=function(t,e,i){var a,n,s,r,o,l,h,d=0,c=0,u=0;for(u=e.next_in_index,r=e.avail_in,d=t.bitb,c=t.bitk,o=t.write,l=o<t.read?t.read-o-1:t.end-o;;)switch(this.mode){case rt:if(l>=258&&r>=10&&(t.bitb=d,t.bitk=c,e.avail_in=r,e.total_in+=u-e.next_in_index,e.next_in_index=u,t.write=o,i=this.inflate_fast(this.lbits,this.dbits,this.ltree,this.ltree_index,this.dtree,this.dtree_index,t,e),u=e.next_in_index,r=e.avail_in,d=t.bitb,c=t.bitk,o=t.write,l=o<t.read?t.read-o-1:t.end-o,i!=m)){this.mode=i==b?gt:_t;break}this.need=this.lbits,this.tree=this.ltree,this.tree_index=this.ltree_index,this.mode=ot;case ot:for(a=this.need;c<a;){if(0==r)return t.bitb=d,t.bitk=c,e.avail_in=r,e.total_in+=u-e.next_in_index,e.next_in_index=u,t.write=o,t.inflate_flush(e,i);i=m,r--,d|=(255&e.next_in[u++])<<c,c+=8}if(n=3*(this.tree_index+(d&G[a])),d>>>=this.tree[n+1],c-=this.tree[n+1],s=this.tree[n],0==s){this.lit=this.tree[n+2],this.mode=ut;break}if(0!=(16&s)){this.get=15&s,this.len=this.tree[n+2],this.mode=lt;break}if(0==(64&s)){this.need=s,this.tree_index=n/3+this.tree[n+2];break}if(0!=(32&s)){this.mode=gt;break}return this.mode=_t,e.msg="invalid literal/length code",i=x,t.bitb=d,t.bitk=c,e.avail_in=r,e.total_in+=u-e.next_in_index,e.next_in_index=u,t.write=o,t.inflate_flush(e,i);case lt:for(a=this.get;c<a;){if(0==r)return t.bitb=d,t.bitk=c,e.avail_in=r,e.total_in+=u-e.next_in_index,e.next_in_index=u,t.write=o,t.inflate_flush(e,i);i=m,r--,d|=(255&e.next_in[u++])<<c,c+=8}this.len+=d&G[a],d>>=a,c-=a,this.need=this.dbits,this.tree=this.dtree,this.tree_index=this.dtree_index,this.mode=ht;case ht:for(a=this.need;c<a;){if(0==r)return t.bitb=d,t.bitk=c,e.avail_in=r,e.total_in+=u-e.next_in_index,e.next_in_index=u,t.write=o,t.inflate_flush(e,i);i=m,r--,d|=(255&e.next_in[u++])<<c,c+=8}if(n=3*(this.tree_index+(d&G[a])),d>>=this.tree[n+1],c-=this.tree[n+1],s=this.tree[n],0!=(16&s)){this.get=15&s,this.dist=this.tree[n+2],this.mode=dt;break}if(0==(64&s)){this.need=s,this.tree_index=n/3+this.tree[n+2];break}return this.mode=_t,e.msg="invalid distance code",i=x,t.bitb=d,t.bitk=c,e.avail_in=r,e.total_in+=u-e.next_in_index,e.next_in_index=u,t.write=o,t.inflate_flush(e,i);case dt:for(a=this.get;c<a;){if(0==r)return t.bitb=d,t.bitk=c,e.avail_in=r,e.total_in+=u-e.next_in_index,e.next_in_index=u,t.write=o,t.inflate_flush(e,i);i=m,r--,d|=(255&e.next_in[u++])<<c,c+=8}this.dist+=d&G[a],d>>=a,c-=a,this.mode=ct;case ct:for(h=o-this.dist;h<0;)h+=t.end;for(;0!=this.len;){if(0==l&&(o==t.end&&0!=t.read&&(o=0,l=o<t.read?t.read-o-1:t.end-o),0==l&&(t.write=o,i=t.inflate_flush(e,i),o=t.write,l=o<t.read?t.read-o-1:t.end-o,o==t.end&&0!=t.read&&(o=0,l=o<t.read?t.read-o-1:t.end-o),0==l)))return t.bitb=d,t.bitk=c,e.avail_in=r,e.total_in+=u-e.next_in_index,e.next_in_index=u,t.write=o,t.inflate_flush(e,i);t.window[o++]=t.window[h++],l--,h==t.end&&(h=0),this.len--}this.mode=rt;break;case ut:if(0==l&&(o==t.end&&0!=t.read&&(o=0,l=o<t.read?t.read-o-1:t.end-o),0==l&&(t.write=o,i=t.inflate_flush(e,i),o=t.write,l=o<t.read?t.read-o-1:t.end-o,o==t.end&&0!=t.read&&(o=0,l=o<t.read?t.read-o-1:t.end-o),0==l)))return t.bitb=d,t.bitk=c,e.avail_in=r,e.total_in+=u-e.next_in_index,e.next_in_index=u,t.write=o,t.inflate_flush(e,i);i=m,t.window[o++]=this.lit,l--,this.mode=rt;break;case gt:if(c>7&&(c-=8,r++,u--),t.write=o,i=t.inflate_flush(e,i),o=t.write,l=o<t.read?t.read-o-1:t.end-o,t.read!=t.write)return t.bitb=d,t.bitk=c,e.avail_in=r,e.total_in+=u-e.next_in_index,e.next_in_index=u,t.write=o,t.inflate_flush(e,i);this.mode=ft;case ft:return i=b,t.bitb=d,t.bitk=c,e.avail_in=r,e.total_in+=u-e.next_in_index,e.next_in_index=u,t.write=o,t.inflate_flush(e,i);case _t:return i=x,t.bitb=d,t.bitk=c,e.avail_in=r,e.total_in+=u-e.next_in_index,e.next_in_index=u,t.write=o,t.inflate_flush(e,i);default:return i=y,t.bitb=d,t.bitk=c,e.avail_in=r,e.total_in+=u-e.next_in_index,e.next_in_index=u,t.write=o,t.inflate_flush(e,i)}},a.prototype.free=function(t){},a.prototype.inflate_fast=function(t,e,i,a,n,s,o,l){var h,d,c,u,g,f,_,p,v,w,y,k,C,T,$,S;_=l.next_in_index,p=l.avail_in,g=o.bitb,f=o.bitk,v=o.write,w=v<o.read?o.read-v-1:o.end-v,y=G[t],k=G[e];do{for(;f<20;)p--,g|=(255&l.next_in[_++])<<f,f+=8;if(h=g&y,d=i,c=a,S=3*(c+h),0!=(u=d[S]))for(;;){if(g>>=d[S+1],f-=d[S+1],0!=(16&u)){for(u&=15,C=d[S+2]+(g&G[u]),g>>=u,f-=u;f<15;)p--,g|=(255&l.next_in[_++])<<f,f+=8;for(h=g&k,d=n,c=s,S=3*(c+h),u=d[S];;){if(g>>=d[S+1],f-=d[S+1],0!=(16&u)){for(u&=15;f<u;)p--,g|=(255&l.next_in[_++])<<f,f+=8;if(T=d[S+2]+(g&G[u]),g>>=u,f-=u,w-=C,v>=T)$=v-T,v-$>0&&2>v-$?(o.window[v++]=o.window[$++],o.window[v++]=o.window[$++],C-=2):(o.window[v++]=o.window[$++],o.window[v++]=o.window[$++],C-=2);else{$=v-T;do $+=o.end;while($<0);if(u=o.end-$,C>u){if(C-=u,v-$>0&&u>v-$){do o.window[v++]=o.window[$++];while(0!=--u)}else r(o.window,$,o.window,v,u),v+=u,$+=u,u=0;$=0}}do o.window[v++]=o.window[$++];while(0!=--C);break}if(0!=(64&u))return l.msg="invalid distance code",C=l.avail_in-p,C=f>>3<C?f>>3:C,p+=C,_-=C,f-=C<<3,o.bitb=g,o.bitk=f,l.avail_in=p,l.total_in+=_-l.next_in_index,l.next_in_index=_,o.write=v,x;h+=d[S+2],h+=g&G[u],S=3*(c+h),u=d[S]}break}if(0!=(64&u))return 0!=(32&u)?(C=l.avail_in-p,C=f>>3<C?f>>3:C,p+=C,_-=C,f-=C<<3,o.bitb=g,o.bitk=f,l.avail_in=p,l.total_in+=_-l.next_in_index,l.next_in_index=_,o.write=v,b):(l.msg="invalid literal/length code",C=l.avail_in-p,C=f>>3<C?f>>3:C,p+=C,_-=C,f-=C<<3,o.bitb=g,o.bitk=f,l.avail_in=p,l.total_in+=_-l.next_in_index,l.next_in_index=_,o.write=v,x);if(h+=d[S+2],h+=g&G[u],S=3*(c+h),0==(u=d[S])){g>>=d[S+1],f-=d[S+1],o.window[v++]=d[S+2],w--;break}}else g>>=d[S+1],f-=d[S+1],o.window[v++]=d[S+2],w--}while(w>=258&&p>=10);return C=l.avail_in-p,C=f>>3<C?f>>3:C,p+=C,_-=C,f-=C<<3,o.bitb=g,o.bitk=f,l.avail_in=p,l.total_in+=_-l.next_in_index,l.next_in_index=_,o.write=v,m},n.prototype.huft_build=function(t,e,i,a,n,s,o,l,h,d,c){var f,_,p,v,b,w,y,k,T,$,S,E,A,R,z;$=0,b=i;do this.c[t[e+$]]++,$++,b--;while(0!=b);if(this.c[0]==i)return o[0]=-1,l[0]=0,m;for(k=l[0],w=1;w<=g&&0==this.c[w];w++);for(y=w,k<w&&(k=w),b=g;0!=b&&0==this.c[b];b--);for(p=b,k>b&&(k=b),l[0]=k,R=1<<w;w<b;w++,R<<=1)if((R-=this.c[w])<0)return x;if((R-=this.c[b])<0)return x;for(this.c[b]+=R,this.x[1]=w=0,$=1,A=2;0!=--b;)this.x[A]=w+=this.c[$],A++,$++;b=0,$=0;do 0!=(w=t[e+$])&&(this.v[this.x[w]++]=b),$++;while(++b<i);for(i=this.x[p],this.x[0]=b=0,$=0,v=-1,E=-k,this.u[0]=0,S=0,z=0;y<=p;y++)for(f=this.c[y];0!=f--;){for(;y>E+k;){if(v++,E+=k,z=p-E,z=z>k?k:z,(_=1<<(w=y-E))>f+1&&(_-=f+1,A=y,w<z))for(;++w<z&&!((_<<=1)<=this.c[++A]);)_-=this.c[A];if(z=1<<w,this.hn[0]+z>u)return x;this.u[v]=S=this.hn[0],this.hn[0]+=z,0!=v?(this.x[v]=b,this.r[0]=w,this.r[1]=k,w=b>>>E-k,this.r[2]=S-this.u[v-1]-w,r(this.r,0,h,3*(this.u[v-1]+w),3)):o[0]=S}for(this.r[1]=y-E,$>=i?this.r[0]=192:c[$]<a?(this.r[0]=this.v[$]<256?0:96,this.r[2]=this.v[$++]):(this.r[0]=s[this.v[$]-a]+16+64,this.r[2]=n[this.v[$++]-a]),_=1<<y-E,w=b>>>E;w<z;w+=_)r(this.r,0,h,3*(S+w),3);for(w=1<<y-1;0!=(b&w);w>>>=1)b^=w;for(b^=w,T=(1<<E)-1;(b&T)!=this.x[v];)v--,E-=k,T=(1<<E)-1}return 0!=R&&1!=p?C:m},n.prototype.inflate_trees_bits=function(t,e,i,a,n){var s;return this.initWorkArea(19),this.hn[0]=0,s=this.huft_build(t,0,19,19,null,null,i,e,a,this.hn,this.v),s==x?n.msg="oversubscribed dynamic bit lengths tree":s!=C&&0!=e[0]||(n.msg="incomplete dynamic bit lengths tree",s=x),s},n.prototype.inflate_trees_dynamic=function(t,e,i,a,n,s,r,o,l){var h;return this.initWorkArea(288),this.hn[0]=0,h=this.huft_build(i,0,t,257,tt,et,s,a,o,this.hn,this.v),h!=m||0==a[0]?(h==x?l.msg="oversubscribed literal/length tree":h!=k&&(l.msg="incomplete literal/length tree",h=x),h):(this.initWorkArea(288),h=this.huft_build(i,t,e,0,it,at,r,n,o,this.hn,this.v),h!=m||0==n[0]&&t>257?(h==x?l.msg="oversubscribed distance tree":h==C?(l.msg="incomplete distance tree",h=x):h!=k&&(l.msg="empty distance tree with lengths",h=x),h):m)},n.prototype.initWorkArea=function(t){null==this.hn&&(this.hn=new Int32Array(1),this.v=new Int32Array(t),this.c=new Int32Array(g+1),this.r=new Int32Array(3),this.u=new Int32Array(g),this.x=new Int32Array(g+1)),this.v.length<t&&(this.v=new Int32Array(t));for(var e=0;e<t;e++)this.v[e]=0;for(var e=0;e<g+1;e++)this.c[e]=0;for(var e=0;e<3;e++)this.r[e]=0;r(this.c,0,this.u,0,g),r(this.c,0,this.x,0,g+1)};var pt=new Uint8Array(1),vt="function"==typeof pt.subarray;return{inflateBuffer:h,arrayCopy:r}}.apply(e,a),!(void 0!==n&&(t.exports=n))},function(t,e,i){var a,n;a=[],n=function(){"use strict";function t(t,e){if("number"!=typeof t||"number"!=typeof e)throw"Bad range "+t+","+e;this._min=t,this._max=e}function e(t){var e=t.sort(r),i=[],a=e.shift();e.forEach(function(t){t._min<=a._max?t._max>a._max&&(a._max=t._max):(i.push(a),a=t)}),i.push(a),this._ranges=i}function i(t,i){return t instanceof e||(t instanceof Array||(t=[t]),t=new e(t)),i&&t.insertRange(i),t}function a(i,a){for(var n=i.ranges(),s=a.ranges(),r=n.length,o=s.length,l=0,h=0,d=[];l<r&&h<o;){var i=n[l],a=s[h],c=Math.max(i.min(),a.min()),u=Math.min(i.max(),a.max());u>=c&&d.push(new t(c,u)),i.max()>a.max()?++h:++l}return 0==d.length?null:1==d.length?d[0]:new e(d)}function n(t){for(var e=0,i=t.ranges(),a=0;a<i.length;++a){var n=i[a];e+=n.max()-n.min()+1}return e}function s(t,e){return t.min()<e.min()?-1:t.min()>e.min()?1:t.max()<e.max()?-1:e.max()>t.max()?1:0}function r(t,e){return t._min<e._min?-1:t._min>e._min?1:t._max<e._max?-1:e._max>t._max?1:0}return t.prototype.min=function(){return this._min},t.prototype.max=function(){return this._max},t.prototype.contains=function(t){return t>=this._min&&t<=this._max},t.prototype.isContiguous=function(){return!0},t.prototype.ranges=function(){return[this]},t.prototype._pushRanges=function(t){t.push(this)},t.prototype.toString=function(){return"["+this._min+"-"+this._max+"]"},e.prototype.min=function(){return this._ranges[0].min()},e.prototype.max=function(){return this._ranges[this._ranges.length-1].max()},e.prototype.lower_bound=function(t){var e=this.ranges();if(t>this.max())return e.length;if(t<this.min())return 0;for(var i=0,a=e.length-1;i<=a;){var n=Math.floor((i+a)/2);if(t>e[n]._max)i=n+1;else{if(!(t<e[n]._min))return n;a=n-1}}return i},e.prototype.contains=function(t){var e=this.lower_bound(t);return!!(e<this._ranges.length&&this._ranges[e].contains(t))},e.prototype.insertRange=function(t){var e=this.lower_bound(t._min);if(e===this._ranges.length)return void this._ranges.push(t);var i=this.ranges();if(t._max<i[e]._min)return void this._ranges.splice(e,0,t);i[e]._min<t._min&&(t._min=i[e]._min);for(var a=e+1;a<i.length&&i[a]._min<=t._max;)a++;a--,i[a]._max>t._max&&(t._max=i[a]._max),this._ranges.splice(e,a-e+1,t)},e.prototype.isContiguous=function(){return this._ranges.length>1},e.prototype.ranges=function(){return this._ranges},e.prototype._pushRanges=function(t){for(var e=0;e<this._ranges.length;++e)t.push(this._ranges[e])},e.prototype.toString=function(){for(var t="",e=0;e<this._ranges.length;++e)e>0&&(t+=","),t+=this._ranges[e].toString();return t},{Range:t,union:i,intersection:a,coverage:n,rangeOver:s,_rangeOrder:r}}.apply(e,a),!(void 0!==n&&(t.exports=n))},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,i){var a,n;(function(s){a=[i(51),i(109)],n=function(t,e){var i=t.GenomeDataManager.extend({load_data:function(t,i,a,n){var r=s.Deferred();this.set_data(t,r);var o=Galaxy.root+"datasets/"+this.get("dataset").id+"/display",l=this;
new s.Deferred;return s.when(e.makeBwg(o)).then(function(e,i){s.when(e.readWigData(t.get("chrom"),t.get("start"),t.get("end"))).then(function(e){var i=[],a={max:Number.MIN_VALUE};e.forEach(function(t){a.max!==t.min-1&&(i.push([a.max+1,0]),i.push([t.min-2,0])),i.push([t.min-1,t.score]),i.push([t.max,t.score]),a=t});var n={data:i,region:t,dataset_type:"bigwig"};l.set_data(t,n),r.resolve(n)})}),r}});return{BBIDataManager:i}}.apply(e,a),!(void 0!==n&&(t.exports=n))}).call(e,i(1))},function(t,e,i){var a,n;(function(s,r){var o=null,l=null;i.e(6,function(t){var e=[t(4),t(118),t(76),t(120),t(75),t(79),t(114),t(77),t(78),t(24)];(function(t){t.cssLoadFile("static/style/jquery.rating.css"),t.cssLoadFile("static/style/autocomplete_tagging.css"),t.cssLoadFile("static/style/jquery-ui/smoothness/jquery-ui.css"),t.cssLoadFile("static/style/library.css"),t.cssLoadFile("static/style/trackster.css")}).apply(null,e)}),a=[i(3),i(163),i(51),i(20),i(26),i(12)],n=function(t,e,i,a,n,h){var d=function(){this.initialize&&this.initialize.apply(this,arguments)};d.extend=s.Model.extend;var c=d.extend({initialize:function(t){this.baseURL=t},save_viz:function(){Galaxy.modal.show({title:"Saving...",body:"progress"});var t=[];r(".bookmark").each(function(){t.push({position:r(this).children(".position").text(),annotation:r(this).children(".annotation").text()})});var e=l.overview_drawable?l.overview_drawable.config.get_value("name"):null,i={view:l.to_dict(),viewport:{chrom:l.chrom,start:l.low,end:l.high,overview:e},bookmarks:t};return r.ajax({url:Galaxy.root+"visualization/save",type:"POST",dataType:"json",data:{id:l.vis_id,title:l.config.get_value("name"),dbkey:l.dbkey,type:"trackster",vis_json:JSON.stringify(i)}}).success(function(t){Galaxy.modal.hide(),l.vis_id=t.vis_id,l.has_changes=!1,window.history.pushState({},"",t.url+window.location.hash)}).error(function(){Galaxy.modal.show({title:"Could Not Save",body:"Could not save visualization. Please try again later.",buttons:{Cancel:function(){Galaxy.modal.hide()}}})})},createButtonMenu:function(){var n=this,s=a.create_icon_buttons_menu([{icon_class:"plus-button",title:"Add tracks",on_click:function(){i.select_datasets({dbkey:l.dbkey},function(i){t.each(i,function(t){l.add_drawable(e.object_from_template(t,l,l))})})}},{icon_class:"block--plus",title:"Add group",on_click:function(){l.add_drawable(new e.DrawableGroup(l,l,{name:"New Group"}))}},{icon_class:"bookmarks",title:"Bookmarks",on_click:function(){force_right_panel("0px"==r("div#right").css("right")?"hide":"show")}},{icon_class:"globe",title:"Circster",on_click:function(){window.location=n.baseURL+"visualization/circster?id="+l.vis_id}},{icon_class:"disk--arrow",title:"Save",on_click:function(){n.save_viz()}},{icon_class:"cross-circle",title:"Close",on_click:function(){n.handle_unsaved_changes(l)}}],{tooltip_config:{placement:"bottom"}});return this.buttonMenu=s,s},add_bookmark:function(t,e,i){var a=r("#right .unified-panel-body"),n=r("<div/>").addClass("bookmark").appendTo(a),s=r("<div/>").addClass("position").appendTo(n),o=(r("<a href=''/>").text(t).appendTo(s).click(function(){return l.go_to(t),!1}),r("<div/>").text(e).appendTo(n));if(i){var h=r("<div/>").addClass("delete-icon-container").prependTo(n).click(function(){return n.slideUp("fast"),n.remove(),l.has_changes=!0,!1});r("<a href=''/>").addClass("icon-button delete").appendTo(h);o.make_text_editable({num_rows:3,use_textarea:!0,help_text:"Edit bookmark note"}).addClass("annotation")}return l.has_changes=!0,n},create_visualization:function(i,a,n,s,o){var l=this,h=new e.TracksterView(t.extend(i,{header:!1}));return h.editor=!0,r.when(h.load_chroms_deferred).then(function(t){if(a){var i=a.chrom,r=a.start,d=a.end,c=a.overview;i&&void 0!==r&&d?h.change_chrom(i,r,d):h.change_chrom(t[0].chrom)}else h.change_chrom(t[0].chrom);if(n)for(var u=0;u<n.length;u++)h.add_drawable(e.object_from_template(n[u],h,h));for(var u=0;u<h.drawables.length;u++)if(h.drawables[u].config.get_value("name")===c){h.set_overview(h.drawables[u]);break}if(s)for(var g,u=0;u<s.length;u++)g=s[u],l.add_bookmark(g.position,g.annotation,o);h.has_changes=!1}),this.set_up_router({view:h}),h},set_up_router:function(t){new i.TrackBrowserRouter(t),s.history.start()},init_keyboard_nav:function(t){r(document).keyup(function(e){if(!r(e.srcElement).is(":input"))switch(e.which){case 37:t.move_fraction(.25);break;case 38:Math.round(t.viewport_container.height()/15);t.viewport_container.scrollTop(t.viewport_container.scrollTop()-20);break;case 39:t.move_fraction(-.25);break;case 40:Math.round(t.viewport_container.height()/15);t.viewport_container.scrollTop(t.viewport_container.scrollTop()+20)}})},handle_unsaved_changes:function(t){if(t.has_changes){var e=this;Galaxy.modal.show({title:"Close visualization",body:"There are unsaved changes to your visualization which will be lost if you do not save them.",buttons:{Cancel:function(){Galaxy.modal.hide()},"Leave without Saving":function(){r(window).off("beforeunload"),window.location=Galaxy.root+"visualization"},Save:function(){r.when(e.save_viz()).then(function(){window.location=Galaxy.root+"visualization"})}}})}else window.location=Galaxy.root+"visualization"}}),u=s.View.extend({initialize:function(){o=new c(Galaxy.root),o.createButtonMenu(),o.buttonMenu.$el.attr("style","float: right"),r("#center .unified-panel-header-inner").append(o.buttonMenu.$el),r("#right .unified-panel-title").append("Bookmarks"),r("#right .unified-panel-icons").append("<a id='add-bookmark-button' class='icon-button menu-button plus-button' href='javascript:void(0);' title='Add bookmark'></a>"),r("#right-border").click(function(){l.resize_window()}),force_right_panel("hide"),galaxy_config.app.id?this.view_existing():n.get("dataset_id")?this.choose_existing_or_new():this.view_new()},choose_existing_or_new:function(){var t=this,e=n.get("dbkey"),i={},a={dbkey:e,dataset_id:n.get("dataset_id"),hda_ldda:n.get("hda_ldda"),gene_region:n.get("gene_region")};e&&(i["f-dbkey"]=e),Galaxy.modal.show({title:"View Data in a New or Saved Visualization?",body:"<p><ul style='list-style: disc inside none'>You can add this dataset as:<li>a new track to one of your existing, saved Trackster sessions if they share the genome build: <b>"+(e||"Not available.")+"</b></li><li>or create a new session with this dataset as the only track</li></ul></p>",buttons:{Cancel:function(){window.location=Galaxy.root+"visualizations/list"},"View in saved visualization":function(){t.view_in_saved(a)},"View in new visualization":function(){t.view_new()}}})},view_in_saved:function(t){var e=new h({url_base:Galaxy.root+"visualization/list_tracks",dict_format:!0,embedded:!0});Galaxy.modal.show({title:"Add Data to Saved Visualization",body:e.$el,buttons:{Cancel:function(){window.location=Galaxy.root+"visualizations/list"},"Add to visualization":function(){r(parent.document).find("input[name=id]:checked").each(function(){t.id=r(this).val(),window.location=Galaxy.root+"visualization/trackster?"+r.param(t)})}}})},view_existing:function(){var t=galaxy_config.app.viz_config;l=o.create_visualization({container:r("#center .unified-panel-body"),name:t.title,vis_id:t.vis_id,dbkey:t.dbkey},t.viewport,t.tracks,t.bookmarks,!0),this.init_editor()},view_new:function(){var e=this;r.ajax({url:Galaxy.root+"api/genomes?chrom_info=True",data:{},error:function(){alert("Couldn't create new browser.")},success:function(i){Galaxy.modal.show({title:"New Visualization",body:e.template_view_new(i),buttons:{Cancel:function(){window.location=Galaxy.root+"visualizations/list"},Create:function(){e.create_browser(r("#new-title").val(),r("#new-dbkey").val()),Galaxy.modal.hide()}}});var a=i.map(function(t){return t[1]});galaxy_config.app.default_dbkey&&t.contains(a,galaxy_config.app.default_dbkey)&&r("#new-dbkey").val(galaxy_config.app.default_dbkey),r("#new-title").focus(),r("select[name='dbkey']").select2(),r("#overlay").css("overflow","auto")}})},template_view_new:function(t){for(var e='<form id="new-browser-form" action="javascript:void(0);" method="post" onsubmit="return false;"><div class="form-row"><label for="new-title">Browser name:</label><div class="form-row-input"><input type="text" name="title" id="new-title" value="Unnamed"></input></div><div style="clear: both;"></div></div><div class="form-row"><label for="new-dbkey">Reference genome build (dbkey): </label><div class="form-row-input"><select name="dbkey" id="new-dbkey">',i=0;i<t.length;i++)e+='<option value="'+t[i][1]+'">'+t[i][0]+"</option>";return e+='</select></div><div style="clear: both;"></div></div><div class="form-row">Is the build not listed here? <a href="'+Galaxy.root+'user/dbkeys?use_panels=True">Add a Custom Build</a></div></form>'},create_browser:function(t,e){r(document).trigger("convert_to_values"),l=o.create_visualization({container:r("#center .unified-panel-body"),name:t,dbkey:e},galaxy_config.app.gene_region),this.init_editor(),l.editor=!0},init_editor:function(){r("#center .unified-panel-title").text(l.config.get_value("name")+" ("+l.dbkey+")"),galaxy_config.app.add_dataset&&r.ajax({url:Galaxy.root+"api/datasets/"+galaxy_config.app.add_dataset,data:{hda_ldda:"hda",data_type:"track_config"},dataType:"json",success:function(t){l.add_drawable(e.object_from_template(t,l,l))}}),r("#add-bookmark-button").click(function(){var t=l.chrom+":"+l.low+"-"+l.high,e="Bookmark description";return o.add_bookmark(t,e,!0)}),o.init_keyboard_nav(l),r(window).on("beforeunload",function(){if(l.has_changes)return"There are unsaved changes to your visualization that will be lost if you leave this page."})}});return{TracksterUI:c,GalaxyApp:u}}.apply(e,a),!(void 0!==n&&(t.exports=n))}).call(e,i(2),i(1))},function(t,e,i){var a,n;(function(s){a=[i(3)],n=function(t){var e=t.extend,i=function(t){this.manager=null,this.name=t.name,this.index=t.index,this.tool_id=t.tool_id,this.tool_exp_name=t.tool_exp_name};e(i.prototype,{to_dict:function(){return{name:this.name,index:this.index,tool_id:this.tool_id,tool_exp_name:this.tool_exp_name}}});var a=function(t,e,i){return s("<a/>").attr("href","javascript:void(0);").attr("title",t).addClass("icon-button").addClass(e).tooltip().click(i)},n=function(t){i.call(this,t),this.low="low"in t?t.low:-Number.MAX_VALUE,this.high="high"in t?t.high:Number.MAX_VALUE,this.min="min"in t?t.min:Number.MAX_VALUE,this.max="max"in t?t.max:-Number.MAX_VALUE,this.container=null,this.slider=null,this.slider_label=null;var e=function(t,e,i){t.click(function(){var t=e.text(),a=parseFloat(i.slider("option","max")),n=a<=1?4:a<=1e6?a.toString().length:6,r=!1,o=s(this).parents(".slider-row");o.addClass("input"),i.slider("option","values")&&(n=2*n+1,r=!0),e.text(""),s("<input type='text'/>").attr("size",n).attr("maxlength",n).attr("value",t).appendTo(e).focus().select().click(function(t){t.stopPropagation()}).blur(function(){s(this).remove(),e.text(t),o.removeClass("input")}).keyup(function(t){if(27===t.keyCode)s(this).trigger("blur");else if(13===t.keyCode){var e=i.slider("option","min"),a=i.slider("option","max"),n=function(t){return isNaN(t)||t>a||t<e},l=s(this).val();if(r){if(l=l.split("-"),l=[parseFloat(l[0]),parseFloat(l[1])],n(l[0])||n(l[1]))return alert("Parameter value must be in the range ["+e+"-"+a+"]"),s(this)}else if(l=parseFloat(l),n(l))return alert("Parameter value must be in the range ["+e+"-"+a+"]"),s(this);i.slider(r?"values":"value",l),o.removeClass("input")}})})},n=this;n.parent_div=s("<div/>").addClass("filter-row slider-row");var r=s("<div/>").addClass("elt-label").appendTo(n.parent_div),o=(s("<span/>").addClass("slider-name").text(n.name+"  ").appendTo(r),s("<span/>").text(this.low+"-"+this.high)),l=s("<span/>").addClass("slider-value").appendTo(r).append("[").append(o).append("]");n.values_span=o;var h=s("<div/>").addClass("slider").appendTo(n.parent_div);n.control_element=s("<div/>").attr("id",n.name+"-filter-control").appendTo(h),n.control_element.slider({range:!0,min:this.min,max:this.max,step:this.get_slider_step(this.min,this.max),values:[this.low,this.high],slide:function(t,e){n.slide(t,e)},change:function(t,e){n.control_element.slider("option","slide").call(n.control_element,t,e)}}),n.slider=n.control_element,n.slider_label=o,e(l,o,n.control_element);var d=s("<div/>").addClass("display-controls").appendTo(n.parent_div);this.transparency_icon=a("Use filter for data transparency","layer-transparent",function(){n.manager.alpha_filter!==n?(n.manager.alpha_filter=n,n.manager.parent_div.find(".layer-transparent").removeClass("active").hide(),n.transparency_icon.addClass("active").show()):(n.manager.alpha_filter=null,n.transparency_icon.removeClass("active")),n.manager.track.request_draw({force:!0,clear_after:!0})}).appendTo(d).hide(),this.height_icon=a("Use filter for data height","arrow-resize-090",function(){n.manager.height_filter!==n?(n.manager.height_filter=n,n.manager.parent_div.find(".arrow-resize-090").removeClass("active").hide(),n.height_icon.addClass("active").show()):(n.manager.height_filter=null,n.height_icon.removeClass("active")),n.manager.track.request_draw({force:!0,clear_after:!0})}).appendTo(d).hide(),n.parent_div.hover(function(){n.transparency_icon.show(),n.height_icon.show()},function(){n.manager.alpha_filter!==n&&n.transparency_icon.hide(),n.manager.height_filter!==n&&n.height_icon.hide()}),s("<div style='clear: both;'/>").appendTo(n.parent_div)};e(n.prototype,{to_dict:function(){var t=i.prototype.to_dict.call(this);return e(t,{type:"number",min:this.min,max:this.max,low:this.low,high:this.high})},copy:function(){return new n({name:this.name,index:this.index,tool_id:this.tool_id,tool_exp_name:this.tool_exp_name})},get_slider_step:function(t,e){var i=e-t;return i<=2?.01:1},slide:function(t,e){var i=e.values;this.values_span.text(i[0]+"-"+i[1]),this.low=i[0],this.high=i[1];var a=this;setTimeout(function(){i[0]===a.low&&i[1]===a.high&&a.manager.track.request_draw({force:!0,clear_after:!0})},25)},applies_to:function(t){return t.length>this.index},_keep_val:function(t){return isNaN(t)||t>=this.low&&t<=this.high},keep:function(t){if(!this.applies_to(t))return!0;var e=t[this.index];if(e instanceof Array){for(var i=!0,a=0;a<e.length;a++)if(!this._keep_val(e[a])){i=!1;break}return i}return this._keep_val(t[this.index])},update_attrs:function(t){var e=!1;if(!this.applies_to(t))return e;var i=t[this.index];i instanceof Array||(i=[i]);for(var a=0;a<i.length;a++){var n=i[a];n<this.min&&(this.min=Math.floor(n),e=!0),n>this.max&&(this.max=Math.ceil(n),e=!0)}return e},update_ui_elt:function(){this.min<this.max?this.parent_div.show():this.parent_div.hide();var t=this.slider.slider("option","min"),e=this.slider.slider("option","max");(this.min<t||this.max>e)&&(this.slider.slider("option","min",this.min),this.slider.slider("option","max",this.max),this.slider.slider("option","step",this.get_slider_step(this.min,this.max)),this.slider.slider("option","values",[this.min,this.max]))}});var r=function(t,e){if(this.track=t,this.alpha_filter=null,this.height_filter=null,this.filters=[],this.parent_div=s("<div/>").addClass("filters").hide(),this.parent_div.bind("drag",function(t){t.stopPropagation()}).click(function(t){t.stopPropagation()}).bind("dblclick",function(t){t.stopPropagation()}).bind("keydown",function(t){t.stopPropagation()}),e&&"filters"in e){for(var i,a=("alpha_filter"in e?e.alpha_filter:null),r=("height_filter"in e?e.height_filter:null),o=e.filters,l=0;l<o.length;l++)"number"===o[l].type?(i=new n(o[l]),this.add_filter(i),i.name===a&&(this.alpha_filter=i,i.transparency_icon.addClass("active").show()),i.name===r&&(this.height_filter=i,i.height_icon.addClass("active").show())):console.log("ERROR: unsupported filter: ",name,type);"visible"in e&&e.visible&&this.parent_div.show()}if(0!==this.filters.length){var h=s("<div/>").addClass("param-row").appendTo(this.parent_div),d=s("<input type='submit'/>").attr("value","Run on complete dataset").appendTo(h),c=this;d.click(function(){c.run_on_dataset()})}};return e(r.prototype,{show:function(){this.parent_div.show()},hide:function(){this.parent_div.hide()},toggle:function(){this.parent_div.toggle()},visible:function(){return this.parent_div.is(":visible")},to_dict:function(){for(var t,e={},i=[],a=0;a<this.filters.length;a++)t=this.filters[a],i.push(t.to_dict());return e.filters=i,e.alpha_filter=this.alpha_filter?this.alpha_filter.name:null,e.height_filter=this.height_filter?this.height_filter.name:null,e.visible=this.parent_div.is(":visible"),e},copy:function(t){for(var e=new r(t),i=0;i<this.filters.length;i++)e.add_filter(this.filters[i].copy());return e},add_filter:function(t){t.manager=this,this.parent_div.append(t.parent_div),this.filters.push(t)},remove_all:function(){this.filters=[],this.parent_div.children().remove()},init_filters:function(){for(var t=0;t<this.filters.length;t++){var e=this.filters[t];e.update_ui_elt()}},clear_filters:function(){for(var t=0;t<this.filters.length;t++){var e=this.filters[t];e.slider.slider("option","values",[e.min,e.max])}this.alpha_filter=null,this.height_filter=null,this.parent_div.find(".icon-button").hide()},run_on_dataset:function(){for(var t,e,i=(function(t,e,i){return e in t||(t[e]=i),t[e]}),a={},n=0;n<this.filters.length;n++)t=this.filters[n],t.tool_id&&(t.min!==t.low&&(e=i(a,t.tool_id,[]),e[e.length]=t.tool_exp_name+" >= "+t.low),t.max!==t.high&&(e=i(a,t.tool_id,[]),e[e.length]=t.tool_exp_name+" <= "+t.high));var r=[];for(var o in a)r[r.length]=[o,a[o]];!function t(e,i){var a=i[0],n=a[0],r=a[1],o="("+r.join(") and (")+")",l={cond:o,input:e,target_dataset_id:e,tool_id:n};i=i.slice(1),s.getJSON(run_tool_url,l,function(e){e.error?Galaxy.modal.show({title:"Filter Dataset",body:"Error running tool "+n,buttons:{Close:Galaxy.modal.hide()}}):0===i.length?Galaxy.modal.show({title:"Filtering Dataset",body:"Filter(s) are running on the complete dataset. Outputs are in dataset's history.",buttons:{Close:Galaxy.modal.hide()}}):t(e.dataset_id,i)})}(this.track.dataset_id,r)}}),{FiltersManager:r,NumberFilter:n}}.apply(e,a),!(void 0!==n&&(t.exports=n))}).call(e,i(1))},function(t,e,i){var a,n;a=[i(3)],n=function(t){var e=1001,i=1002,a=1003,n=1004,s=1005,r=1006,o=function(t,o){var l,h=t[0],d=t[1],c=o[0],u=o[1];return l=h<c?d<=c?e:d<=u?a:i:h>u?r:d<=u?s:n},l=function(t,i){var a=o(t,i);return a!==e&&a!==r},h=function(t,e,i,a,n,s){void 0===s&&(s=4);var r,o=a-e,l=n-i,h=Math.floor(Math.sqrt(o*o+l*l)/s),d=o/h,c=l/h;for(r=0;r<h;r++,e+=d,i+=c)r%2===0&&t.fillRect(e,i,s,1)},d=function(t,e,i,a){var n=e-a/2,s=e+a/2,r=i-Math.sqrt(3*a/2);t.beginPath(),t.moveTo(n,r),t.lineTo(s,r),t.lineTo(e,i),t.lineTo(n,r),t.strokeStyle=this.fillStyle,t.fill(),t.stroke(),t.closePath()},c=function(t){this.default_val=t?t:1};c.prototype.gen_val=function(t){return this.default_val};var u=function(t){this.incomplete_features=t.incomplete_features,this.feature_mapper=t.feature_mapper},g=function(e,i,a,n,s){this.data=e,this.view_start=i,this.view_end=a,this.prefs=t.extend({},this.default_prefs,n),this.mode=s};g.prototype.default_prefs={},g.prototype.draw=function(t,e,i,a){},g.prototype.get_start_draw_pos=function(t,e){return this._chrom_pos_to_draw_pos(t,e,-.5)},g.prototype.get_end_draw_pos=function(t,e){return this._chrom_pos_to_draw_pos(t,e,.5)},g.prototype.get_draw_pos=function(t,e){return this._chrom_pos_to_draw_pos(t,e,0)},g.prototype._chrom_pos_to_draw_pos=function(t,e,i){return Math.floor(e*(Math.max(0,t-this.view_start)+i))};var f=function(t,e,i,a,n){g.call(this,t,e,i,a,n)};f.prototype.default_prefs={min_value:void 0,max_value:void 0,mode:"Histogram",color:"#000",overflow_color:"#F66"},f.prototype.draw=function(e,i,a,n){var s=!1,r=this.prefs.min_value,o=this.prefs.max_value,l=o-r,h=a,d=this.view_start,c=this.mode,u=this.data;e.save();var g=Math.round(a+r/l*a);"Intensity"!==c&&(e.fillStyle="#aaa",e.fillRect(0,g,i,1)),e.beginPath();var f,_,p;p=u.length>1?t.map(u.slice(0,-1),function(t,e){return Math.ceil((u[e+1][0]-u[e][0])*n)}):[10];for(var v,m=this.prefs.block_color||this.prefs.color,b=parseInt(m.slice(1),16),w=(16711680&b)>>16,y=(65280&b)>>8,x=255&b,k=!1,C=!1,T=0,$=u.length;T<$;T++)if(e.fillStyle=e.strokeStyle=m,k=C=!1,v=p[T],f=Math.floor((u[T][0]-d-.5)*n),_=u[T][1],null!==_){if(_<r?(C=!0,_=r):_>o&&(k=!0,_=o),"Histogram"===c)_=Math.round(_/l*h),e.fillRect(f,g,v,-_);else if("Intensity"===c){var S=(_-r)/l,E=Math.round(w+(255-w)*(1-S)),A=Math.round(y+(255-y)*(1-S)),R=Math.round(x+(255-x)*(1-S));e.fillStyle="rgb("+E+","+A+","+R+")",e.fillRect(f,0,v,h)}else _=Math.round(h-(_-r)/l*h),s?e.lineTo(f,_):(s=!0,"Filled"===c?(e.moveTo(f,h),e.lineTo(f,_)):e.moveTo(f,_));if(e.fillStyle=this.prefs.overflow_color,k||C){var z;"Histogram"===c||"Intensity"===c?z=v:(f-=2,z=4),k&&e.fillRect(f,0,z,3),C&&e.fillRect(f,h-3,z,3)}e.fillStyle=m}else s&&"Filled"===c&&e.lineTo(f,h),s=!1;"Filled"===c?(s&&(e.lineTo(f,g),e.lineTo(0,g)),e.fill()):e.stroke(),e.restore()};var _=function(t){this.feature_positions={},this.slot_height=t,this.translation=0,this.y_translation=0};_.prototype.map_feature_data=function(t,e,i,a){this.feature_positions[e]||(this.feature_positions[e]=[]),this.feature_positions[e].push({data:t,x_start:i,x_end:a})},_.prototype.get_feature_data=function(t,e){var i,a=Math.floor((e-this.y_translation)/this.slot_height);if(!this.feature_positions[a])return null;t+=this.translation;for(var n=0;n<this.feature_positions[a].length;n++)if(i=this.feature_positions[a][n],t>=i.x_start&&t<=i.x_end)return i.data};var p=function(t,e,i,a,n,s,r){g.call(this,t,e,i,a,n),this.alpha_scaler=s?s:new c,this.height_scaler=r?r:new c,this.max_label_length=200};p.prototype.default_prefs={block_color:"#FFF",connector_color:"#FFF"},t.extend(p.prototype,{get_required_height:function(t,e){var i=this.get_row_height(),a=i,n=this.mode;return"no_detail"!==n&&"Squish"!==n&&"Pack"!==n||(i=t*a),i+this.get_top_padding(e)},get_top_padding:function(t){return 0},draw:function(t,e,i,a,n){var s=this.data,r=this.view_start,o=this.view_end;t.save(),t.fillStyle=this.prefs.block_color,t.textAlign="right";for(var l,h=this.get_row_height(),d=new _(h),c=[],g=0,f=s.length;g<f;g++){var p=s[g],v=p[0],m=p[1],b=p[2],w=n&&void 0!==n[v]?n[v].slot:null;("Dense"===this.mode||null!==w)&&m<o&&b>r&&(l=this.draw_element(t,this.mode,p,w,r,o,a,h,e),d.map_feature_data(p,w,l[0],l[1]),(m<r||b>o)&&c.push(p))}return t.restore(),d.y_translation=this.get_top_padding(e),new u({incomplete_features:c,feature_mapper:d})},draw_element:function(t,e,i,a,n,s,r,o,l){return[0,0]}});var v=10,m=3,b=5,w=10,y=1,x=9,k=3,C=9,T=2,$="#ccc",S=function(t,e,i,a,n,s,r){p.call(this,t,e,i,a,n,s,r),this.draw_background_connector=!0,this.draw_individual_connectors=!1};t.extend(S.prototype,p.prototype,{get_row_height:function(){var t,e=this.mode;return t="Dense"===e?v:"no_detail"===e?m:"Squish"===e?b:w},draw_element:function(t,e,i,a,n,s,r,o,l){var h,d=(i[0],i[1]),c=i[2],u=i[3],g=i[4],f=Math.floor(Math.max(0,(d-n-.5)*r)),_=Math.ceil(Math.min(l,Math.max(0,(c-n-.5)*r))),p=f,v=_,h=("Dense"===e?0:0+a)*o+this.get_top_padding(l),m=null,b=null,w=g&&"+"!==g&&"."!==g?this.prefs.reverse_strand_color:this.prefs.block_color,S=this.prefs.label_color;if(t.globalAlpha=this.alpha_scaler.gen_val(i),"Dense"===e&&(a=1),"no_detail"===e)t.fillStyle=w,t.fillRect(f,h+5,_-f,y);else{var E=i[5],A=i[6],R=i[7],z=!0;E&&A&&(m=Math.floor(Math.max(0,(E-n)*r)),b=Math.ceil(Math.min(l,Math.max(0,(A-n)*r))));var M,I;if("Squish"===e?(M=1,I=k,z=!1):"Dense"===e?(M=5,I=x):(M=5,I=C),R){var D,V;"Squish"===e||"Dense"===e?(D=h+Math.floor(k/2)+1,V=1):g?(D=h,V=I):(D+=k/2+1,V=1),this.draw_background_connector&&("Squish"===e||"Dense"===e?t.fillStyle=$:g?"+"===g?t.fillStyle=t.canvas.manager.get_pattern("right_strand"):"-"===g&&(t.fillStyle=t.canvas.manager.get_pattern("left_strand")):t.fillStyle=$,t.fillRect(f,D,_-f,V));for(var O=0,q=R.length;O<q;O++){var N,G,P=R[O],B=Math.floor(Math.max(0,(P[0]-n-.5)*r)),L=Math.ceil(Math.min(l,Math.max((P[1]-n-.5)*r)));if(!(B>L)){if(t.fillStyle=w,t.fillRect(B,h+(I-M)/2+1,L-B,M),void 0!==m&&A>E&&!(B>b||L<m)){var Y=Math.max(B,m),F=Math.min(L,b);t.fillRect(Y,h+1,F-Y,I),1===R.length&&"Pack"===e&&("+"===g?t.fillStyle=t.canvas.manager.get_pattern("right_strand_inv"):"-"===g&&(t.fillStyle=t.canvas.manager.get_pattern("left_strand_inv")),Y+14<F&&(Y+=2,F-=2),t.fillRect(Y,h+1,F-Y,I))}this.draw_individual_connectors&&N&&this.draw_connector(t,N,G,B,L,h),N=B,G=L}}if("Pack"===e){t.globalAlpha=1,t.fillStyle="white";var j=this.height_scaler.gen_val(i),H=Math.ceil(I*j),U=Math.round((I-H)/2);1!==j&&(t.fillRect(f,D+1,_-f,U),t.fillRect(f,D+I-U+1,_-f,U))}}else t.fillStyle=w,t.fillRect(f,h+1,_-f,I),g&&z&&("+"===g?t.fillStyle=t.canvas.manager.get_pattern("right_strand_inv"):"-"===g&&(t.fillStyle=t.canvas.manager.get_pattern("left_strand_inv")),t.fillRect(f,h+1,_-f,I));t.globalAlpha=1,u&&"Pack"===e&&d>n&&(t.fillStyle=S,0===n&&f-t.measureText(u).width<0?(t.textAlign="left",t.fillText(u,_+T,h+8,this.max_label_length),v+=t.measureText(u).width+T):(t.textAlign="right",t.fillText(u,f-T,h+8,this.max_label_length),p-=t.measureText(u).width+T))}return t.globalAlpha=1,[p,v]}});var E=function(t,e,i,a,n,s,r,o,l){p.call(this,t,e,i,a,n,s,r),this.ref_seq=o?o.data:null,this.base_color_fn=l};t.extend(E.prototype,p.prototype,{get_row_height:function(){var t,e=this.mode;return"Dense"===e?t=v:"Squish"===e?t=b:(t=w,this.prefs.show_insertions&&(t*=2)),t},_parse_cigar:function(e){var i="MIDNSHP=X",a=[[0,0]],n=a[0],s=0,r=t.map(e.match(/[0-9]+[MIDNSHP=X]/g),function(t){var e=parseInt(t.slice(0,-1),10),r=t.slice(-1);return"N"===r?0!==n[1]&&(n=[s+e,s+e],a.push(n)):"ISHP".indexOf(r)===-1&&(n[1]+=e,s+=e),[i.indexOf(r),e]});return{blocks:a,cigar:r}},draw_read:function(t,e,r,h,c,u,g,f,_,p){var v=function(t,e,i){return"M=NXD".indexOf(e)!==-1&&(t+=i),t},m=function(t,e,i){return"IX".indexOf(e)!==-1&&(t+=i),t},b=function(t){return Math.floor(Math.max(0,(t-c-.5)*r))};t.textAlign="center";var w,y,T=[c,u],S=0,E=0,A=Math.round(r/2),R=t.canvas.manager.char_width_px,z="+"===_?this.prefs.detail_block_color:this.prefs.reverse_strand_color,M="Pack"===e,I=M?C:k,V=h+1,O=new D(t,I,r,e),q=[],N=[],G=this._parse_cigar(f);f=G.cigar,q=G.blocks;for(var P=0;P<q.length;P++){var B=q[P];l([g+B[0],g+B[1]],T)&&(w=b(g+B[0]),y=b(g+B[1]),w===y&&(y+=1),t.fillStyle=z,t.fillRect(w,V,y-w,I))}for(var L=0,Y=f.length;L<Y;L++){var F=f[L],j="MIDNSHP=X"[F[0]],H=F[1],U=g+S;if(w=b(U),y=b(U+H),l([U,U+H],T))switch(w===y&&(y+=1),j){case"H":case"S":case"P":break;case"M":S+=H;break;case"=":case"X":var K="";"X"===j?K=p.slice(E,E+H):this.ref_seq&&(K=this.ref_seq.slice(Math.max(0,U-c),Math.min(U-c+H,u-c)));for(var J=Math.max(U,c),W=0;W<K.length;W++)if(K&&!this.prefs.show_differences||"X"===j){var X=Math.floor(Math.max(0,(J+W-c)*r));t.fillStyle=this.base_color_fn(K[W]),M&&r>R?t.fillText(K[W],X,h+9):r>.05&&t.fillRect(X-A,V,Math.max(1,Math.round(r)),I)}"X"===j&&(E+=H),S+=H;break;case"N":t.fillStyle=$,t.fillRect(w,V+(I-1)/2,y-w,1),S+=H;break;case"D":O.draw_deletion(w,V,H),S+=H;break;case"I":var Z=w-A;if(l([U,U+H],T)){var Q=p.slice(E,E+H);if(this.prefs.show_insertions){var tt=w-(y-w)/2;if(("Pack"===e||"Auto"===this.mode)&&void 0!==p&&r>R){switch(t.fillStyle="yellow",t.fillRect(tt-A,h-9,y-w,9),N[N.length]={type:"triangle",data:[Z,h+4,5]},t.fillStyle=$,o([U,U+H],T)){case a:Q=Q.slice(c-U);break;case n:Q=Q.slice(0,U-u);break;case s:break;case i:Q=Q.slice(c-U,U-u)}for(var W=0,et=Q.length;W<et;W++){var X=Math.floor(Math.max(0,(U+W-c)*r));t.fillText(Q[W],X-(y-w)/2,h)}}else t.fillStyle="yellow",t.fillRect(tt,h+("Dense"!==this.mode?2:5),y-w,"Dense"!==e?k:x)}else("Pack"===e||"Auto"===this.mode)&&void 0!==p&&r>R&&N.push({type:"text",data:[Q.length,Z,h+9]})}E+=H}else S=v(S,j,H),E=m(E,j,H)}t.fillStyle="yellow";for(var it,at,nt,P=0;P<N.length;P++)it=N[P],at=it.type,nt=it.data,"text"===at?(t.save(),t.font="bold "+t.font,t.fillText(nt[0],nt[1],nt[2]),t.restore()):"triangle"===at&&d(t,nt[0],nt[1],nt[2])},draw_element:function(t,e,i,a,n,s,r,o,l){var d=(i[0],i[1]),c=i[2],u=i[3],g=Math.floor(Math.max(-.5*r,(d-n-.5)*r)),f=Math.ceil(Math.min(l,Math.max(0,(c-n-.5)*r))),_=("Dense"===e?0:0+a)*o,p="Pack"===e?C:k;this.prefs.label_color;if(i[5]instanceof Array){var v=!0;i[4][1]>=n&&i[4][0]<=s&&i[4][2]?this.draw_read(t,e,r,_,n,s,i[4][0],i[4][2],i[4][3],i[4][4]):v=!1,i[5][1]>=n&&i[5][0]<=s&&i[5][2]?this.draw_read(t,e,r,_,n,s,i[5][0],i[5][2],i[5][3],i[5][4]):v=!1;var m=Math.ceil(Math.min(l,Math.max(-.5*r,(i[4][1]-n-.5)*r))),b=Math.floor(Math.max(-.5*r,(i[5][0]-n-.5)*r));if(v&&b>m){t.fillStyle=$;var w=_+1+(p-1)/2;h(t,m,w,b,w)}}else this.draw_read(t,e,r,_,n,s,d,i[4],i[5],i[6]);return"Pack"===e&&d>=n&&"."!==u&&(t.fillStyle=this.prefs.label_color,0===n&&g-t.measureText(u).width<0?(t.textAlign="left",t.fillText(u,f+T,_+9,this.max_label_length)):(t.textAlign="right",t.fillText(u,g-T,_+9,this.max_label_length))),[0,0]}});var A=function(t,e,i,a,n,s,r){S.call(this,t,e,i,a,n,s,r),this.longest_feature_length=this.calculate_longest_feature_length(),this.draw_background_connector=!1,this.draw_individual_connectors=!0};t.extend(A.prototype,p.prototype,S.prototype,{calculate_longest_feature_length:function(){for(var t=0,e=0,i=this.data.length;e<i;e++){var a=this.data[e],n=a[1],s=a[2];t=Math.max(t,s-n)}return t},get_top_padding:function(t){var e=this.view_end-this.view_start,i=t/e;return Math.min(128,Math.ceil(this.longest_feature_length/2*i))},draw_connector:function(t,e,i,a,n,s){var r=(i+a)/2,o=a-r;Math.PI;o>0&&(t.beginPath(),t.arc(r,s,a-r,Math.PI,0),t.stroke())}});var R=function(t,e){Array.isArray(t)?this.rgb=t:6==t.length?this.rgb=t.match(/.{2}/g).map(function(t){return parseInt(t,16)}):7==t.length?this.rgb=t.substring(1,7).match(/.{2}/g).map(function(t){return parseInt(t,16)}):this.rgb=t.split("").map(function(t){return parseInt(t+t,16)}),this.alpha="number"==typeof e?e:1};R.prototype={eval:function(){return this},toCSS:function(){return this.alpha<1?"rgba("+this.rgb.map(function(t){return Math.round(t)}).concat(this.alpha).join(", ")+")":"#"+this.rgb.map(function(t){return t=Math.round(t),t=(t>255?255:t<0?0:t).toString(16),1===t.length?"0"+t:t}).join("")},toHSL:function(){var t,e,i=this.rgb[0]/255,a=this.rgb[1]/255,n=this.rgb[2]/255,s=this.alpha,r=Math.max(i,a,n),o=Math.min(i,a,n),l=(r+o)/2,h=r-o;if(r===o)t=e=0;else{switch(e=l>.5?h/(2-r-o):h/(r+o),r){case i:t=(a-n)/h+(a<n?6:0);break;case a:t=(n-i)/h+2;break;case n:t=(i-a)/h+4}t/=6}return{h:360*t,s:e,l:l,a:s}},toARGB:function(){var t=[Math.round(255*this.alpha)].concat(this.rgb);return"#"+t.map(function(t){return t=Math.round(t),t=(t>255?255:t<0?0:t).toString(16),1===t.length?"0"+t:t}).join("")},mix:function(t,e){var i=this,a=e,n=2*a-1,s=i.toHSL().a-t.toHSL().a,r=((n*s==-1?n:(n+s)/(1+n*s))+1)/2,o=1-r,l=[i.rgb[0]*r+t.rgb[0]*o,i.rgb[1]*r+t.rgb[1]*o,i.rgb[2]*r+t.rgb[2]*o],h=i.alpha*a+t.alpha*(1-a);return new R(l,h)}};var z=function(t,e,i,a){this.start_color=new R(t),this.end_color=new R(e),this.start_value=i,this.end_value=a,this.value_range=a-i};z.prototype.map_value=function(t){return t=Math.max(t,this.start_value),t=Math.min(t,this.end_value),t=(t-this.start_value)/this.value_range,this.start_color.mix(this.end_color,1-t).toCSS()};var M=function(t,e,i,a,n){this.positive_ramp=new z(e,i,0,n),this.negative_ramp=new z(e,t,0,-a),this.start_value=a,this.end_value=n};M.prototype.map_value=function(t){return t=Math.max(t,this.start_value),t=Math.min(t,this.end_value),t>=0?this.positive_ramp.map_value(t):this.negative_ramp.map_value(-t)};var I=function(t,e,i,a,n){g.call(this,t,e,i,a,n);var s,r;if(void 0===this.prefs.min_value){var o=1/0;for(s=0,r=this.data.length;s<r;s++)o=Math.min(o,this.data[s][6]);this.prefs.min_value=o}if(void 0===this.prefs.max_value){var l=-(1/0);for(s=0,r=this.data.length;s<r;s++)l=Math.max(l,this.data[s][6]);this.prefs.max_value=l}};I.prototype.default_prefs={min_value:void 0,max_value:void 0,mode:"Heatmap",pos_color:"#FF8C00",neg_color:"#4169E1"},I.prototype.draw=function(t,e,i,a){var n,s,r,o,l,h,d=this.prefs.min_value,c=this.prefs.max_value,u=this.view_start,g=(this.mode,this.data),f=1/Math.sqrt(2),_=new M(this.prefs.neg_color,"#FFFFFF",this.prefs.pos_color,d,c),p=function(t){return(t-u)*a};t.save(),t.rotate(-45*Math.PI/180),t.scale(f,f);
for(var v=0,m=g.length;v<m;v++)n=g[v],s=p(n[1]),r=p(n[2]),o=p(n[4]),l=p(n[5]),h=n[6],t.fillStyle=_.map_value(h),t.fillRect(s,o,r-s,l-o);t.restore()};var D=function(t,e,i,a){this.ctx=t,this.row_height=e,this.px_per_base=i,this.draw_details=("Pack"===a||"Auto"===a)&&i>=t.canvas.manager.char_width_px,this.delete_details_thickness=.2};t.extend(D.prototype,{draw_deletion:function(t,e,i){this.ctx.fillStyle="black";var a=(this.draw_details?this.delete_details_thickness:1)*this.row_height;e+=.5*(this.row_height-a),this.ctx.fillRect(t,e,i*this.px_per_base,a)}});var V=function(t,e,i,a,n,s){g.call(this,t,e,i,a,n),this.base_color_fn=s,this.divider_height=1};return t.extend(V.prototype,g.prototype,{get_row_height:function(){var t,e=this.mode;return t="Dense"===e?v:"Squish"===e?b:w},get_required_height:function(t){var e=this.prefs.summary_height;return t>1&&this.prefs.show_sample_data&&(e+=this.divider_height+t*this.get_row_height()),e},draw:function(e,i,a,n){e.save();var s,r,o,l,h,d,c,u,g,f,_,p=function(t,e){var i=t.length,a=e.length,n=0,s=1,r=null;return"-"===e?(r="deletion",s=t.length):0===t.indexOf(e)&&i>a?(r="deletion",s=i-a,n=a):0===e.indexOf(t)&&i<a&&(r="insertion",s=a-i,n=a),null!==r?{type:r,start:n,len:s}:{}},v=Math.max(1,Math.floor(n)),m=this.data.length?this.data[0][7].split(",").length:0,y="Squish"===this.mode?b:w,x=n<.1?y:"Squish"===this.mode?k:C,T=!0,$=new D(e,y,n,this.mode);1===m&&(y=x=n<e.canvas.manager.char_width_px?this.prefs.summary_height:y,$.row_height=y,T=!1),this.prefs.show_sample_data&&T&&(e.fillStyle="#F3F3F3",e.globalAlpha=1,e.fillRect(0,this.prefs.summary_height-this.divider_height,i,this.divider_height)),e.textAlign="center";for(var S=0;S<this.data.length;S++)if(s=this.data[S],r=s[1],o=s[3],l=[s[4].split(",")],h=s[7].split(","),d=s.slice(8),l=t.map(t.flatten(l),function(e){var i={type:"snp",value:e,start:0},a=p(o,e);return t.extend(i,a)}),!(r<this.view_start||r>this.view_end)){if(T)for(e.fillStyle="#999999",e.globalAlpha=1,_=0;_<l.length;_++)for(u=this.get_start_draw_pos(r+l[_].start,n),e.fillRect(u,0,v,this.prefs.summary_height),g=this.prefs.summary_height,_=0;_<l.length;_++){e.fillStyle="deletion"===l[_].type?"black":this.base_color_fn(l[_].value);var E=d/h.length,A=Math.ceil(this.prefs.summary_height*E);e.fillRect(u,g-A,v,A),g-=A}if(this.prefs.show_sample_data)for(g=T?this.prefs.summary_height+this.divider_height:0,_=0;_<h.length;_++,g+=y)if(f=h[_]?h[_].split(/\/|\|/):["0","0"],c=null,f[0]===f[1]?"."===f[0]||"0"!==f[0]&&(c=l[parseInt(f[0],10)-1],e.globalAlpha=1):(c="0"!==f[0]?f[0]:f[1],c=l[parseInt(c,10)-1],e.globalAlpha=.5),c)if(u=this.get_start_draw_pos(r+c.start,n),"snp"===c.type){var R=c.value;e.fillStyle=this.base_color_fn(R),$.draw_details?e.fillText(R,this.get_draw_pos(r,n),g+y):e.fillRect(u,g+1,v,x)}else"deletion"===c.type&&$.draw_deletion(u,g+1,c.len)}e.restore()}}),{Scaler:c,LinePainter:f,LinkedFeaturePainter:S,ReadPainter:E,ArcLinkedFeaturePainter:A,DiagonalHeatmapPainter:I,VariantPainter:V}}.apply(e,a),!(void 0!==n&&(t.exports=n))},function(t,e,i){var a,n;a=[i(3)],n=function(t){var e=t.extend,i=2,a=5,n=function(t,e){this.slot=t,this.feature=e},s=function(t,e,i,a){this.slots={},this.start_end_dct={},this.w_scale=t,this.mode=e,this.include_label="Pack"===e,this.max_rows=i,this.measureText=a};return e(s.prototype,{_get_draw_coords:function(t){var e,n=Math.floor(t[1]*this.w_scale),s=Math.ceil(t[2]*this.w_scale),r=t[3];if(void 0!==r&&this.include_label){var o=this.measureText(r).width+(i+a);n-o>=0?(n-=o,e="left"):(s+=o,e="right")}return[n,s]},_find_slot:function(t){for(var e=t[0],i=t[1],a=0;a<=this.max_rows;a++){var n=!1,s=this.start_end_dct[a];if(void 0!==s)for(var r=0,o=s.length;r<o;r++){var l=s[r];if(i>l[0]&&e<l[1]){n=!0;break}}if(!n)return a}return-1},slot_features:function(t){for(var e,i,a=this.start_end_dct,s=[],r=0,o=0,l=t.length;o<l;o++){e=t[o],i=e[0];var h=this.slots[i];if(h){if(e[1]<h.feature[1]||h.feature[2]<e[2])for(var d=this._get_draw_coords(h.feature),c=this._get_draw_coords(e),u=this.start_end_dct[h.slot],g=0;g<u.length;g++){var f=u[g];f[0]===d[0]&&f[1]===d[1]&&(u[g]=c)}r=Math.max(r,this.slots[i].slot)}else s.push(o)}for(var o=0,l=s.length;o<l;o++){e=t[s[o]],i=e[0];var _=this._get_draw_coords(e),p=this._find_slot(_);p>=0&&(void 0===a[p]&&(a[p]=[]),a[p].push(_),this.slots[i]=new n(p,e),r=Math.max(r,p))}return r+1}}),{FeatureSlotter:s}}.apply(e,a),!(void 0!==n&&(t.exports=n))},function(t,e,i){var a,n;(function(s,r){a=[i(3),i(51),i(164),i(27),i(162),i(161),i(160),i(16),i(68),i(71),i(158),i(24)],n=function(t,e,i,a,n,o,l,h,d,c,u){function g(t,e){e||(e=0);var i=Math.pow(10,e);return Math.round(t*i)/i}function f(t){var e=s.Deferred();return s.ajax({type:"HEAD",url:t,beforeSend:function(t){t.setRequestHeader("Range","bytes=0-10")},success:function(t,i,a){e.resolve(206===a.status)}}),e}var _=t.extend,p={},v=function(t,e){p[t.attr("id")]=e},m=function(t,e,i,a){i=".group",p[t.attr("id")]=a,t.bind("drag",{handle:"."+e,relative:!0},function(t,e){var a,n,r,o,l,h=(s(this),s(this).parent()),d=h.children(".track,.group"),c=p[s(this).attr("id")];if(n=s(this).parents(i),0!==n.length){r=n.position().top,o=r+n.outerHeight();var u=p[n.attr("id")];if(e.offsetY<r)return s(this).insertBefore(n),u.remove_drawable(c),void u.container.add_drawable_before(c,u);if(e.offsetY>o)return s(this).insertAfter(n),u.remove_drawable(c),void u.container.add_drawable(c)}for(n=null,l=0;l<d.length;l++)if(a=s(d.get(l)),r=a.position().top,o=r+a.outerHeight(),a.is(i)&&this!==a.get(0)&&e.offsetY>=r&&e.offsetY<=o)return e.offsetY-r<o-e.offsetY?a.find(".content-div").prepend(this):a.find(".content-div").append(this),c.container&&c.container.remove_drawable(c),void p[a.attr("id")].add_drawable(c);for(l=0;l<d.length&&(a=s(d.get(l)),!(e.offsetY<a.position().top)||a.hasClass("reference-track")||a.hasClass("intro"));l++);l===d.length?this!==d.get(l-1)&&(h.append(this),p[h.attr("id")].move_drawable(c,l)):this!==d.get(l)&&(s(this).insertBefore(d.get(l)),p[h.attr("id")].move_drawable(c,e.deltaY>0?l-1:l))}).bind("dragstart",function(){s(this).addClass("dragging")}).bind("dragend",function(){s(this).removeClass("dragging")})},b=20,w=100,y=12e3,x=400,k=5e3,C=100,T="Cannot display dataset due to an error. ",$="A converter for this dataset is not installed. Please check your datatypes_conf.xml file.",S="No data for this chrom/contig.",E="Preparing data. This can take a while for a large dataset. If the visualization is saved and closed, preparation will continue in the background.",A="Tool cannot be rerun: ",R="Ready for display",z=10,M=["Histogram","Line","Filled","Intensity"],I=function(t,e,a){if(I.id_counter||(I.id_counter=0),this.id=I.id_counter++,this.view=t,this.container=e,this.drag_handle_class=a.drag_handle_class,this.is_overview=!1,this.action_icons={},this.config=c.ConfigSettingCollection.from_models_and_saved_values(this.config_params,a.prefs),this.config.get_value("name")||this.config.set_value("name",a.name),this.config_onchange&&this.config.on("change",this.config_onchange,this),this.container_div=this.build_container_div(),this.header_div=null,a.header!==!1){var n=new i.TrackHeaderView({model:this,id:this.id});this.header_div=n.$el,this.container_div.append(this.header_div);var s=n.icons_div;this.action_icons=n.action_icons,this.container_div.hover(function(){s.show()},function(){s.hide()})}};I.prototype.action_icons_def=[{name:"toggle_icon",title:"Hide/show content",css_class:"toggle",on_click_fn:function(t){t.config.get_value("content_visible")?(t.action_icons.toggle_icon.addClass("toggle-expand").removeClass("toggle"),t.hide_contents(),t.config.set_value("content_visible",!1)):(t.action_icons.toggle_icon.addClass("toggle").removeClass("toggle-expand"),t.config.set_value("content_visible",!0),t.show_contents())}},{name:"settings_icon",title:"Edit settings",css_class:"gear",on_click_fn:function(t){var e=new c.ConfigSettingCollectionView({collection:t.config});e.render_in_modal("Configure Track")}},{name:"remove_icon",title:"Remove",css_class:"remove-icon",on_click_fn:function(t){s(".tooltip").remove(),t.remove()}}],_(I.prototype,{config_params:[{key:"name",label:"Name",type:"text",default_value:""},{key:"content_visible",type:"bool",default_value:!0,hidden:!0}],config_onchange:function(){},init:function(){},changed:function(){this.view.changed()},can_draw:function(){return!(!this.enabled||!this.config.get_value("content_visible"))},request_draw:function(){},_draw:function(t){},to_dict:function(){},set_name:function(t){this.old_name=this.config.get_value("name"),this.config.set_value("name",t)},revert_name:function(){this.old_name&&this.config.set_value("name",this.old_name)},remove:function(){this.changed(),this.container.remove_drawable(this);var t=this.view;this.container_div.hide(0,function(){s(this).remove(),t.update_intro_div()})},build_container_div:function(){},update_icons:function(){},hide_contents:function(){},show_contents:function(){},get_drawables:function(){}});var D=function(t,e,i){I.call(this,t,e,i),this.obj_type=i.obj_type,this.drawables=[]};_(D.prototype,I.prototype,{unpack_drawables:function(t){this.drawables=[];for(var e,i=0;i<t.length;i++)e=et(t[i],this.view,this),this.add_drawable(e)},init:function(){for(var t=0;t<this.drawables.length;t++)this.drawables[t].init()},_draw:function(t){for(var e=0;e<this.drawables.length;e++)this.drawables[e]._draw(t)},to_dict:function(){for(var t=[],e=0;e<this.drawables.length;e++)t.push(this.drawables[e].to_dict());return{prefs:this.config.to_key_value_dict(),obj_type:this.obj_type,drawables:t}},add_drawable:function(t){this.drawables.push(t),t.container=this,this.changed()},add_drawable_before:function(t,e){this.changed();var i=this.drawables.indexOf(e);return i!==-1&&(this.drawables.splice(i,0,t),!0)},replace_drawable:function(t,e,i){var a=this.drawables.indexOf(t);return a!==-1&&(this.drawables[a]=e,i&&t.container_div.replaceWith(e.container_div),this.changed()),a},remove_drawable:function(t){var e=this.drawables.indexOf(t);return e!==-1&&(this.drawables.splice(e,1),t.container=null,this.changed(),!0)},move_drawable:function(t,e){var i=this.drawables.indexOf(t);return i!==-1&&(this.drawables.splice(i,1),this.drawables.splice(e,0,t),this.changed(),!0)},get_drawables:function(){return this.drawables},get_tracks:function(t){for(var e,i=this.drawables.slice(0),a=[];0!==i.length;)e=i.shift(),e instanceof t?a.push(e):e.drawables&&(i=i.concat(e.drawables));return a}});var V=function(t,e,i){if(_(i,{obj_type:"DrawableGroup",drag_handle_class:"group-handle"}),D.call(this,t,e,i),this.content_div=s("<div/>").addClass("content-div").attr("id","group_"+this.id+"_content_div").appendTo(this.container_div),v(this.container_div,this),v(this.content_div,this),m(this.container_div,this.drag_handle_class,".group",this),this.filters_manager=new l.FiltersManager(this),this.header_div.after(this.filters_manager.parent_div),this.filters_manager.parent_div.after(s("<div style='clear: both'/>")),this.saved_filters_managers=[],"drawables"in i&&this.unpack_drawables(i.drawables),"filters"in i){var a=this.filters_manager;this.filters_manager=new l.FiltersManager(this,i.filters),a.parent_div.replaceWith(this.filters_manager.parent_div),i.filters.visible&&this.setup_multitrack_filtering()}};_(V.prototype,I.prototype,D.prototype,{action_icons_def:[I.prototype.action_icons_def[0],I.prototype.action_icons_def[1],{name:"composite_icon",title:"Show composite track",css_class:"layers-stack",on_click_fn:function(t){s(".tooltip").remove(),t.show_composite_track()}},{name:"filters_icon",title:"Filters",css_class:"ui-slider-050",on_click_fn:function(t){t.filters_manager.visible()?(t.filters_manager.clear_filters(),t._restore_filter_managers()):(t.setup_multitrack_filtering(),t.request_draw({clear_tile_cache:!0})),t.filters_manager.toggle()}},I.prototype.action_icons_def[2]],build_container_div:function(){var t=s("<div/>").addClass("group").attr("id","group_"+this.id);return this.container&&this.container.content_div.append(t),t},hide_contents:function(){this.tiles_div.hide()},show_contents:function(){this.tiles_div.show(),this.request_draw()},update_icons:function(){var t=this.drawables.length;if(0===t)this.action_icons.composite_icon.hide(),this.action_icons.filters_icon.hide();else if(1===t)this.action_icons.composite_icon.toggle(this.drawables[0]instanceof U),this.action_icons.filters_icon.hide();else{var e,i,a,n=!0,r=this.drawables[0].get_type(),o=0;for(e=0;e<t;e++){if(a=this.drawables[e],a.get_type()!==r){can_composite=!1;break}a instanceof X&&o++}if(n&&this.drawables[0]instanceof J?this.action_icons.composite_icon.show():(this.action_icons.composite_icon.hide(),s(".tooltip").remove()),o>1&&o===this.drawables.length){var h,d={};for(a=this.drawables[0],i=0;i<a.filters_manager.filters.length;i++)h=a.filters_manager.filters[i],d[h.name]=[h];for(e=1;e<this.drawables.length;e++)for(a=this.drawables[e],i=0;i<a.filters_manager.filters.length;i++)h=a.filters_manager.filters[i],h.name in d&&d[h.name].push(h);this.filters_manager.remove_all();var c,u;for(var g in d)c=d[g],c.length===o&&(u=new l.NumberFilter({name:c[0].name,index:c[0].index}),this.filters_manager.add_filter(u));this.action_icons.filters_icon.toggle(this.filters_manager.filters.length>0)}else this.action_icons.filters_icon.hide()}},_restore_filter_managers:function(){for(var t=0;t<this.drawables.length;t++)this.drawables[t].filters_manager=this.saved_filters_managers[t];this.saved_filters_managers=[]},setup_multitrack_filtering:function(){if(this.filters_manager.filters.length>0){this.saved_filters_managers=[];for(var t=0;t<this.drawables.length;t++){var e=this.drawables[t];this.saved_filters_managers.push(e.filters_manager),e.filters_manager=this.filters_manager}}this.filters_manager.init_filters()},show_composite_track:function(){var t=new U(this.view,this.view,{name:this.config.get_value("name"),drawables:this.drawables});this.container.replace_drawable(this,t,!0);t.request_draw()},add_drawable:function(t){D.prototype.add_drawable.call(this,t),this.update_icons()},remove_drawable:function(t){D.prototype.remove_drawable.call(this,t),this.update_icons()},to_dict:function(){this.filters_manager.visible()&&this._restore_filter_managers();var t=_(D.prototype.to_dict.call(this),{filters:this.filters_manager.to_dict()});return this.filters_manager.visible()&&this.setup_multitrack_filtering(),t},request_draw:function(e){t.each(this.drawables,function(t){t.request_draw(e)})}});var O=r.View.extend({initialize:function(t){_(t,{obj_type:"View"}),D.call(this,"View",t.container,t),this.chrom=null,this.vis_id=t.vis_id,this.dbkey=t.dbkey,this.stand_alone=void 0===t.stand_alone||t.stand_alone,this.label_tracks=[],this.tracks_to_be_redrawn=[],this.max_low=0,this.max_high=0,this.zoom_factor=3,this.min_separation=30,this.has_changes=!1,this.load_chroms_deferred=null,this.render(),this.canvas_manager=new e.CanvasManager(this.container.get(0).ownerDocument),this.reset(),this.config=c.ConfigSettingCollection.from_models_and_saved_values([{key:"name",label:"Name",type:"text",default_value:""},{key:"a_color",label:"A Color",type:"color",default_value:"#FF0000"},{key:"c_color",label:"C Color",type:"color",default_value:"#00FF00"},{key:"g_color",label:"G Color",type:"color",default_value:"#0000FF"},{key:"t_color",label:"T Color",type:"color",default_value:"#FF00FF"},{key:"n_color",label:"N Color",type:"color",default_value:"#AAAAAA"}],{name:t.name})},render:function(){this.requested_redraw=!1;var i=this.container,a=this;this.top_container=s("<div/>").addClass("top-container").appendTo(i),this.browser_content_div=s("<div/>").addClass("content").appendTo(i),this.bottom_container=s("<div/>").addClass("bottom-container").appendTo(i),this.top_labeltrack=s("<div/>").addClass("top-labeltrack").appendTo(this.top_container),this.viewport_container=s("<div/>").addClass("viewport-container").attr("id","viewport-container").appendTo(this.browser_content_div),this.content_div=this.viewport_container,v(this.viewport_container,a),this.intro_div=s("<div/>").addClass("intro").appendTo(this.viewport_container);s("<div/>").text("Add Datasets to Visualization").addClass("action-button").appendTo(this.intro_div).click(function(){e.select_datasets({dbkey:a.dbkey},function(e){t.each(e,function(t){a.add_drawable(et(t,a,a))})})});this.nav_container=s("<div/>").addClass("trackster-nav-container").prependTo(this.top_container),this.nav=s("<div/>").addClass("trackster-nav").appendTo(this.nav_container),this.stand_alone&&(this.nav_container.addClass("stand-alone"),this.nav.addClass("stand-alone")),this.overview=s("<div/>").addClass("overview").appendTo(this.bottom_container),this.overview_viewport=s("<div/>").addClass("overview-viewport").appendTo(this.overview),this.overview_close=s("<a/>").attr("title","Close overview").addClass("icon-button overview-close tooltip").hide().appendTo(this.overview_viewport),this.overview_highlight=s("<div/>").addClass("overview-highlight").hide().appendTo(this.overview_viewport),this.overview_box_background=s("<div/>").addClass("overview-boxback").appendTo(this.overview_viewport),this.overview_box=s("<div/>").addClass("overview-box").appendTo(this.overview_viewport),this.default_overview_height=this.overview_box.height(),this.nav_controls=s("<div/>").addClass("nav-controls").appendTo(this.nav),this.chrom_select=s("<select/>").attr({name:"chrom"}).addClass("chrom-nav").append("<option value=''>Loading</option>").appendTo(this.nav_controls);var n=function(t){"focusout"!==t.type&&13!==(t.keyCode||t.which)&&27!==(t.keyCode||t.which)||(27!==(t.keyCode||t.which)&&a.go_to(s(this).val()),s(this).hide(),s(this).val(""),a.location_span.show(),a.chrom_select.show()),t.stopPropagation()};this.nav_input=s("<input/>").addClass("nav-input").hide().bind("keyup focusout",n).appendTo(this.nav_controls),this.location_span=s("<span/>").addClass("location").attr("title","Click to change location").tooltip({placement:"bottom"}).appendTo(this.nav_controls),this.location_span.click(function(){a.location_span.hide(),a.chrom_select.hide(),a.nav_input.val(a.chrom+":"+a.low+"-"+a.high),a.nav_input.css("display","inline-block"),a.nav_input.select(),a.nav_input.focus(),a.nav_input.autocomplete({source:function(t,e){var i=[],n=s.map(a.get_tracks(X),function(e){return e.data_manager.search_features(t.term).success(function(t){i=i.concat(t)})});s.when.apply(s,n).done(function(){e(s.map(i,function(t){return{label:t[0],value:t[1]}}))})},minLength:2})}),void 0!==this.vis_id&&(this.hidden_input=s("<input/>").attr("type","hidden").val(this.vis_id).appendTo(this.nav_controls)),this.zo_link=s("<a/>").attr("id","zoom-out").attr("title","Zoom out").tooltip({placement:"bottom"}).click(function(){a.zoom_out()}).appendTo(this.nav_controls),this.zi_link=s("<a/>").attr("id","zoom-in").attr("title","Zoom in").tooltip({placement:"bottom"}).click(function(){a.zoom_in()}).appendTo(this.nav_controls),this.load_chroms_deferred=this.load_chroms({low:0}),this.chrom_select.bind("change",function(){a.change_chrom(a.chrom_select.val())}),this.browser_content_div.click(function(t){s(this).find("input").trigger("blur")}),this.browser_content_div.bind("dblclick",function(t){a.zoom_in(t.pageX,this.viewport_container)}),this.overview_box.bind("dragstart",function(t,e){this.current_x=e.offsetX}).bind("drag",function(t,e){var i=e.offsetX-this.current_x;this.current_x=e.offsetX;var n=Math.round(i/a.viewport_container.width()*(a.max_high-a.max_low));a.move_delta(-n)}),this.overview_close.click(function(){a.reset_overview()}),this.viewport_container.bind("draginit",function(t,e){if(t.clientX>a.viewport_container.width()-16)return!1}).bind("dragstart",function(t,e){e.original_low=a.low,e.current_height=t.clientY,e.current_x=e.offsetX}).bind("drag",function(t,e){var i=s(this),n=e.offsetX-e.current_x,r=i.scrollTop()-(t.clientY-e.current_height);i.scrollTop(r),e.current_height=t.clientY,e.current_x=e.offsetX;var o=Math.round(n/a.viewport_container.width()*(a.high-a.low));a.move_delta(o)}),this.top_labeltrack.bind("dragstart",function(t,e){return s("<div/>").addClass("zoom-area").css("height",a.browser_content_div.height()+a.top_labeltrack.height()+1).appendTo(s(this))}).bind("drag",function(t,e){s(e.proxy).css({left:Math.min(t.pageX,e.startX)-a.container.offset().left,width:Math.abs(t.pageX-e.startX)});var i=Math.min(t.pageX,e.startX)-a.container.offset().left,n=Math.max(t.pageX,e.startX)-a.container.offset().left,r=a.high-a.low,o=a.viewport_container.width();a.update_location(Math.round(i/o*r)+a.low,Math.round(n/o*r)+a.low)}).bind("dragend",function(t,e){var i=Math.min(t.pageX,e.startX),n=Math.max(t.pageX,e.startX),r=a.high-a.low,o=a.viewport_container.width(),l=a.low;a.low=Math.round(i/o*r)+l,a.high=Math.round(n/o*r)+l,s(e.proxy).remove(),a.request_redraw()}),this.add_label_track(new H(this,{content_div:this.top_labeltrack})),s(window).bind("resize",function(){this.resize_timer&&clearTimeout(this.resize_timer),this.resize_timer=setTimeout(function(){a.resize_window()},500)}),s(document).bind("redraw",function(){a.redraw()}),this.reset(),s(window).trigger("resize")},get_base_color:function(t){return this.config.get_value(t.toLowerCase()+"_color")||this.config.get_value("n_color")}});_(O.prototype,D.prototype,{changed:function(){this.has_changes=!0},update_intro_div:function(){this.intro_div.toggle(0===this.drawables.length)},trigger_navigate:function(t,e,i,a){if(this.timer&&clearTimeout(this.timer),a){var n=this;this.timer=setTimeout(function(){n.trigger("navigate",t+":"+e+"-"+i)},500)}else view.trigger("navigate",t+":"+e+"-"+i)},update_location:function(t,e){this.location_span.text(a.commatize(t)+" - "+a.commatize(e)),this.nav_input.val(this.chrom+":"+a.commatize(t)+"-"+a.commatize(e));var i=this.chrom_select.val();""!==i&&this.trigger_navigate(i,this.low,this.high,!0)},load_chroms:function(t){t.num=C;var e=this,i=s.Deferred();return s.ajax({url:Galaxy.root+"api/genomes/"+this.dbkey,data:t,dataType:"json",success:function(t){if(0!==t.chrom_info.length){if(t.reference){var a=new K(e);e.add_label_track(a),e.reference_track=a}e.chrom_data=t.chrom_info,e.chrom_select.html(""),e.chrom_select.append(s('<option value="">Select Chrom/Contig</option>'));for(var n=0,r=e.chrom_data.length;n<r;n++){var o=e.chrom_data[n].chrom,l=s("<option>");l.text(o),l.val(o),e.chrom_select.append(l)}t.prev_chroms&&e.chrom_select.append(s('<option value="previous">Previous '+C+"</option>")),t.next_chroms&&e.chrom_select.append(s('<option value="next">Next '+C+"</option>")),e.chrom_start_index=t.start_index,i.resolve(t.chrom_info)}},error:function(){alert("Could not load chroms for this dbkey: "+e.dbkey)}}),i},change_chrom:function(t,e,i){var a=this;if(!a.chrom_data)return void a.load_chroms_deferred.then(function(){a.change_chrom(t,e,i)});if(t&&"None"!==t){if("previous"===t)return void a.load_chroms({low:this.chrom_start_index-C});if("next"===t)return void a.load_chroms({low:this.chrom_start_index+C});var n=s.grep(a.chrom_data,function(e,i){return e.chrom===t})[0];if(void 0===n)return void a.load_chroms({chrom:t},function(){a.change_chrom(t,e,i)});if(t!==a.chrom){a.chrom=t,a.chrom_select.val(a.chrom),a.max_high=n.len-1,a.reset();for(var r=0,o=a.drawables.length;r<o;r++){var l=a.drawables[r];l.init&&l.init()}a.reference_track&&a.reference_track.init()}void 0===e&&void 0===i?(a.low=0,a.high=a.max_high):(a.low=void 0!==e?Math.max(e,0):0,void 0===i?(a.low=Math.max(a.low-15,0),a.high=a.low+30):a.high=Math.min(i,a.max_high)),a.request_redraw()}},go_to:function(t){t=t.replace(/,/g,""),t=t.replace(/:|\-/g," ");var e=t.split(/\s+/),i=e[0],a=e[1]?parseInt(e[1],10):void 0,n=e[2]?parseInt(e[2],10):void 0;this.change_chrom(i,a,n)},move_fraction:function(t){var e=this,i=e.high-e.low;this.move_delta(t*i)},move_delta:function(t){var e=this,i=e.high-e.low;e.low-t<e.max_low?(e.low=e.max_low,e.high=e.max_low+i):e.high-t>e.max_high?(e.high=e.max_high,e.low=e.max_high-i):(e.high-=t,e.low-=t),e.request_redraw({data_fetch:!1}),this.redraw_on_move_fn&&clearTimeout(this.redraw_on_move_fn),this.redraw_on_move_fn=setTimeout(function(){e.request_redraw()},200);var a=e.chrom_select.val();this.trigger_navigate(a,e.low,e.high,!0)},add_drawable:function(t){D.prototype.add_drawable.call(this,t),t.init(),this.changed(),this.update_intro_div();var e=this;t.config.on("change",function(){e.changed()})},add_label_track:function(t){t.view=this,t.init(),this.label_tracks.push(t)},remove_drawable:function(t,e){if(D.prototype.remove_drawable.call(this,t),e){var i=this;t.container_div.hide(0,function(){s(this).remove(),i.update_intro_div()})}},reset:function(){this.low=this.max_low,this.high=this.max_high,this.viewport_container.find(".yaxislabel").remove()},request_redraw:function(e,i){var a=this,n=i?[i]:a.drawables;t.each(n,function(i){var n=t.find(a.tracks_to_be_redrawn,function(t){return t[0]===i});n?n[1]=e:a.tracks_to_be_redrawn.push([i,e])}),this.requested_redraw||(requestAnimationFrame(function(){a._redraw()}),this.requested_redraw=!0)},_redraw:function(){this.requested_redraw=!1;var e=this.low,i=this.high;e<this.max_low&&(e=this.max_low),i>this.max_high&&(i=this.max_high);var a=this.high-this.low;0!==this.high&&a<this.min_separation&&(i=e+this.min_separation),this.low=Math.floor(e),this.high=Math.ceil(i),this.update_location(this.low,this.high),this.resolution_px_b=this.viewport_container.width()/(this.high-this.low);var n=this.low/(this.max_high-this.max_low)*this.overview_viewport.width()||0,s=(this.high-this.low)/(this.max_high-this.max_low)*this.overview_viewport.width()||0,r=13;this.overview_box.css({left:n,width:Math.max(r,s)}).show(),s<r&&this.overview_box.css("left",n-(r-s)/2),this.overview_highlight&&this.overview_highlight.css({left:n,width:s}),t.each(this.tracks_to_be_redrawn,function(t){var e=t[0],i=t[1];e&&e._draw(i)}),this.tracks_to_be_redrawn=[],t.each(this.label_tracks,function(t){t._draw()})},zoom_in:function(t,e){if(!(0===this.max_high||this.high-this.low<=this.min_separation)){var i=this.high-this.low,a=i/2+this.low,n=i/this.zoom_factor/2;t&&(a=t/this.viewport_container.width()*(this.high-this.low)+this.low),this.low=Math.round(a-n),this.high=Math.round(a+n),this.changed(),this.request_redraw()}},zoom_out:function(){if(0!==this.max_high){var t=this.high-this.low,e=t/2+this.low,i=t*this.zoom_factor/2;this.low=Math.round(e-i),this.high=Math.round(e+i),this.changed(),this.request_redraw()}},resize_viewport:function(){this.viewport_container.height(this.container.height()-this.top_container.height()-this.bottom_container.height())},resize_window:function(){this.resize_viewport(),this.request_redraw()},set_overview:function(t){if(this.overview_drawable){if(this.overview_drawable.dataset.id===t.dataset.id)return;this.overview_viewport.find(".track").remove()}var e=t.copy({content_div:this.overview_viewport}),i=this;e.header_div.hide(),e.is_overview=!0,i.overview_drawable=e,this.overview_drawable.postdraw_actions=function(){i.overview_highlight.show().height(i.overview_drawable.content_div.height()),i.overview_viewport.height(i.overview_drawable.content_div.height()+i.overview_box.outerHeight()),i.overview_close.show(),i.resize_window()},i.overview_drawable.request_draw(),this.changed()},reset_overview:function(){s(".tooltip").remove(),this.overview_viewport.find(".track-tile").remove(),this.overview_viewport.height(this.default_overview_height),this.overview_box.height(this.default_overview_height),this.overview_close.hide(),this.overview_highlight.hide(),view.resize_window(),view.overview_drawable=null}});var q=d.Tool.extend({defaults:{track:null},initialize:function(t){d.Tool.prototype.initialize.call(this,t);var e=!0;void 0!==t.tool_state&&void 0!==t.tool_state.hidden&&(e=t.tool_state.hidden),this.set("hidden",e),this.remove_inputs(["data","hidden_data","conditional"])},state_dict:function(e){return t.extend(this.get_inputs_dict(),{hidden:!this.is_visible()})}}),N=r.View.extend({events:{"change :input":"update_value"},render:function(){var t=this.$el.addClass("param-row"),e=this.model,i=(s("<div>").addClass("param-label").text(e.get("label")).appendTo(t),s("<div/>").addClass("param-input").html(e.get("html")).appendTo(t));i.find(":input").val(e.get("value")),s("<div style='clear: both;'/>").appendTo(t)},update_value:function(t){this.model.set_value(s(t.target).val())}}),G=r.View.extend({initialize:function(t){this.model.on("change:hidden",this.set_visible,this)},render:function(){var t=this,e=this.model,i=this.$el.addClass("dynamic-tool").hide();i.bind("drag",function(t){t.stopPropagation()}).click(function(t){t.stopPropagation()}).bind("dblclick",function(t){t.stopPropagation()}).keydown(function(t){t.stopPropagation()});s("<div class='tool-name'>").appendTo(i).text(e.get("name"));e.get("inputs").each(function(t){var e=new N({model:t});e.render(),i.append(e.$el)}),i.find("input").click(function(){s(this).select()});var a=s("<div>").addClass("param-row").appendTo(i),n=s("<input type='submit'>").attr("value","Run on complete dataset").appendTo(a),r=s("<input type='submit'>").attr("value","Run on visible region").appendTo(a);r.click(function(){t.run_on_region()}),n.click(function(){t.run_on_dataset()}),e.is_visible()&&this.$el.show()},set_visible:function(){this.$el.toggle(this.model.is_visible())},update_params:function(){for(var t=0;t<this.params.length;t++)this.params[t].update_value()},run_on_dataset:function(){var t=this.model;this.run({target_dataset_id:this.model.get("track").dataset.id,action:"rerun",tool_id:t.id},null,function(e){Galaxy.modal.show({title:t.get("name")+" is Running",body:t.get("name")+" is running on the complete dataset. Tool outputs are in dataset's history.",buttons:{Close:function(){Galaxy.modal.hide()}}})})},run_on_region:function(){var t,i=this.model.get("track"),a=this.model,n=new e.GenomeRegion({chrom:i.view.chrom,start:i.view.low,end:i.view.high}),s={target_dataset_id:i.dataset.id,action:"rerun",tool_id:a.id,regions:[n.toJSON()]},r=i,o=a.get("name")+r.tool_region_and_parameters_str(n);if(r.container===view){var l=new V(view,view,{name:i.config.get_value("name")}),d=r.container.replace_drawable(r,l,!1);l.container_div.insertBefore(r.view.content_div.children()[d]),l.add_drawable(r),r.container_div.appendTo(l.content_div),t=l}else t=r.container;var c=new r.constructor(view,t,{name:o,hda_ldda:"hda"});c.init_for_tool_data(),c.change_mode(r.mode),c.set_filters_manager(r.filters_manager.copy(c)),c.update_icons(),t.add_drawable(c),c.tiles_div.text("Starting job."),this.run(s,c,function(t){c.set_dataset(new h.Dataset(t)),c.tiles_div.text("Running job."),c.init()})},run:function(t,e,i){t.inputs=this.model.get_inputs_dict();var n=new a.ServerStateDeferred({ajax_settings:{url:Galaxy.root+"api/tools",data:JSON.stringify(t),dataType:"json",contentType:"application/json",type:"POST"},interval:2e3,success_fn:function(t){return"pending"!==t}});s.when(n.go()).then(function(t){"no converter"===t?(e.container_div.addClass("error"),e.content_div.text($)):t.error?(e.container_div.addClass("error"),e.content_div.text(A+t.message)):i(t)})}}),P=function(t,e){o.Scaler.call(this,e),this.filter=t};P.prototype.gen_val=function(t){return this.filter.high===Number.MAX_VALUE||this.filter.low===-Number.MAX_VALUE||this.filter.low===this.filter.high?this.default_val:(parseFloat(t[this.filter.index])-this.filter.low)/(this.filter.high-this.filter.low)};var B=function(t,e,i,a,n){this.track=t,this.region=e,this.low=e.get("start"),this.high=e.get("end"),this.w_scale=i,this.canvas=a,this.html_elt=s("<div class='track-tile'/>").append(a),this.data=n,this.stale=!1};B.prototype.predisplay_actions=function(){};var L=function(t,e,i,a,n){B.call(this,t,e,i,a,n)};L.prototype.predisplay_actions=function(){};var Y=function(t,e,i,a,n,s,r,o,l,h,d){B.call(this,t,e,i,a,n),this.mode=s,this.all_slotted=o,this.feature_mapper=l,this.has_icons=!1,this.incomplete_features=h,this.other_tiles_features_drawn={},this.seq_data=d};_(Y.prototype,B.prototype),Y.prototype.predisplay_actions=function(){};var F=function(t,i,a){_(a,{drag_handle_class:"draghandle"}),I.call(this,t,i,a),
this.dataset=null,a.dataset&&(this.dataset=a.dataset instanceof r.Model?a.dataset:new h.Dataset(a.dataset)),this.dataset_check_type="converted_datasets_state",this.data_url_extra_params={},this.data_query_wait="data_query_wait"in a?a.data_query_wait:k,this.data_manager="data_manager"in a?a.data_manager:new e.GenomeDataManager({dataset:this.dataset,genome:new e.Genome({key:t.dbkey,chroms_info:{chrom_info:t.chrom_data}}),data_mode_compatible:this.data_and_mode_compatible,can_subset:this.can_subset}),this.min_height_px=16,this.max_height_px=800,this.visible_height_px=this.config.get_value("height"),this.content_div=s("<div class='track-content'>").appendTo(this.container_div),this.container&&(this.container.content_div.append(this.container_div),"resize"in a&&!a.resize||this.add_resize_handle())};_(F.prototype,I.prototype,{action_icons_def:[{name:"mode_icon",title:"Set display mode",css_class:"chevron-expand",on_click_fn:function(){}},I.prototype.action_icons_def[0],{name:"overview_icon",title:"Set as overview",css_class:"application-dock-270",on_click_fn:function(t){t.view.set_overview(t)}},I.prototype.action_icons_def[1],{name:"filters_icon",title:"Filters",css_class:"ui-slider-050",on_click_fn:function(t){t.filters_manager.visible()?t.filters_manager.clear_filters():t.filters_manager.init_filters(),t.filters_manager.toggle()}},{name:"tools_icon",title:"Tool",css_class:"hammer",on_click_fn:function(t){t.tool.toggle(),t.tool.is_visible()?t.set_name(t.config.get_value("name")+t.tool_region_and_parameters_str()):t.revert_name(),s(".tooltip").remove()}},{name:"param_space_viz_icon",title:"Tool parameter space visualization",css_class:"arrow-split",on_click_fn:function(i){var a="<strong>Tool</strong>:"+i.tool.get("name")+"<br/><strong>Dataset</strong>:"+i.config.get_value("name")+'<br/><strong>Region(s)</strong>: <select name="regions"><option value="cur">current viewing area</option><option value="bookmarks">bookmarks</option><option value="both">current viewing area and bookmarks</option></select>',n=function(){Galaxy.modal.hide(),s(window).unbind("keypress.check_enter_esc")},o=function(){var a,n=s('select[name="regions"] option:selected').val(),o=new e.GenomeRegion({chrom:view.chrom,start:view.low,end:view.high}),l=t.map(s(".bookmark"),function(t){return new e.GenomeRegion({from_str:s(t).children(".position").text()})});a="cur"===n?[o]:"bookmarks"===n?l:[o].concat(l),Galaxy.modal.hide(),window.location.href=Galaxy.root+"visualization/sweepster?"+s.param({dataset_id:i.dataset.id,hda_ldda:i.dataset.get("hda_ldda"),regions:JSON.stringify(new r.Collection(a).toJSON())})};Galaxy.modal.show({title:"Visualize tool parameter space and output from different parameter settings?",body:a,buttons:{No:n,Yes:o}})}},I.prototype.action_icons_def[2]],can_draw:function(){return this.dataset&&I.prototype.can_draw.call(this)},build_container_div:function(){return s("<div/>").addClass("track").attr("id","track_"+this.id)},set_dataset:function(t){this.dataset=t,this.data_manager.set("dataset",t)},on_resize:function(){this.request_draw({clear_tile_cache:!0})},add_resize_handle:function(){var t=this,e=!1,i=!1,a=s("<div class='track-resize'>");s(t.container_div).hover(function(){t.config.get_value("content_visible")&&(e=!0,a.show())},function(){e=!1,i||a.hide()}),a.hide().bind("dragstart",function(e,a){i=!0,a.original_height=s(t.content_div).height()}).bind("drag",function(e,i){var a=Math.min(Math.max(i.original_height+i.deltaY,t.min_height_px),t.max_height_px);s(t.tiles_div).css("height",a),t.visible_height_px=t.max_height_px===a?0:a,t.on_resize()}).bind("dragend",function(n,s){t.tile_cache.clear(),i=!1,e||a.hide(),t.config.set_value("height",t.visible_height_px),t.changed()}).appendTo(t.container_div)},hide_contents:function(){this.tiles_div.hide(),this.container_div.find(".yaxislabel, .track-resize").hide()},show_contents:function(){this.tiles_div.show(),this.container_div.find(".yaxislabel, .track-resize").show(),this.request_draw()},get_type:function(){return this instanceof H?"LabelTrack":this instanceof K?"ReferenceTrack":this instanceof J?"LineTrack":this instanceof Q?"ReadTrack":this instanceof Z?"VariantTrack":this instanceof U?"CompositeTrack":this instanceof X?"FeatureTrack":""},show_message:function(t){return this.tiles_div.remove(),s("<span/>").addClass("message").html(t).appendTo(this.content_div)},init:function(t){var e=this;if(e.enabled=!1,e.tile_cache.clear(),e.data_manager.clear(),e.content_div.children().remove(),e.container_div.removeClass("nodata error pending"),e.tiles_div=s("<div/>").addClass("tiles").appendTo(e.content_div),e.dataset.id){var i=s.Deferred(),a={hda_ldda:e.dataset.get("hda_ldda"),data_type:this.dataset_check_type,chrom:e.view.chrom,retry:t};return s.getJSON(this.dataset.url(),a,function(t){if(t&&"error"!==t&&"error"!==t.kind)"no converter"===t?(e.container_div.addClass("error"),e.show_message($)):"no data"===t||void 0!==t.data&&(null===t.data||0===t.data.length)?(e.container_div.addClass("nodata"),e.show_message(S)):"pending"===t?(e.container_div.addClass("pending"),e.show_message(E),setTimeout(function(){e.init()},e.data_query_wait)):"data"!==t&&"data"!==t.status||(t.valid_chroms&&(e.valid_chroms=t.valid_chroms,e.update_icons()),e.tiles_div.text(R),e.view.chrom?(e.tiles_div.text(""),e.tiles_div.css("height",e.visible_height_px+"px"),e.enabled=!0,s.when.apply(s,e.predraw_init()).done(function(){i.resolve(),e.container_div.removeClass("nodata error pending"),e.request_draw()})):i.resolve());else{e.container_div.addClass("error");var a=e.show_message(T);t.message&&(a.append(s("<a href='javascript:void(0);'></a>").text("View error").click(function(){Galaxy.modal.show({title:"Trackster Error",body:"<pre>"+t.message+"</pre>",buttons:{Close:function(){Galaxy.modal.hide()}}})})),a.append(s("<span/>").text(" ")),a.append(s("<a href='javascript:void(0);'></a>").text("Try again").click(function(){e.init(!0)})))}}),this.update_icons(),i}},predraw_init:function(){var t=this;return s.getJSON(t.dataset.url(),{data_type:"data",stats:!0,chrom:t.view.chrom,low:0,high:t.view.max_high,hda_ldda:t.dataset.get("hda_ldda")},function(e){var i=e.data;if(i&&void 0!==i.min&&void 0!==i.max){var a=i.min,n=i.max;a=Math.floor(Math.min(0,Math.max(a,i.mean-2*i.sd))),n=Math.ceil(Math.max(0,Math.min(n,i.mean+2*i.sd))),t.config.set_default_value("min_value",a),t.config.set_default_value("max_value",n),t.config.set_value("min_value",a),t.config.set_value("max_value",n)}})},get_drawables:function(){return this}});var j=function(i,a,n){F.call(this,i,a,n);var r=this;if(m(r.container_div,r.drag_handle_class,".group",r),this.filters_manager=new l.FiltersManager(this,"filters"in n?n.filters:null),this.data_manager.set("filters_manager",this.filters_manager),this.filters_available=!1,this.tool=n.tool?new q(t.extend(n.tool,{track:this,tool_state:n.tool_state})):null,this.tile_cache=new e.Cache(z),this.left_offset=0,this.header_div&&(this.set_filters_manager(this.filters_manager),this.tool)){var o=new G({model:this.tool});o.render(),this.dynamic_tool_div=o.$el,this.header_div.after(this.dynamic_tool_div)}this.tiles_div=s("<div/>").addClass("tiles").appendTo(this.content_div),this.config.get_value("content_visible")||this.tiles_div.hide(),this.overlay_div=s("<div/>").addClass("overlay").appendTo(this.content_div),n.mode&&this.change_mode(n.mode)};_(j.prototype,I.prototype,F.prototype,{action_icons_def:F.prototype.action_icons_def.concat([{name:"show_more_rows_icon",title:"To minimize track height, not all feature rows are displayed. Click to display more rows.",css_class:"exclamation",on_click_fn:function(t){s(".tooltip").remove(),t.slotters[t.view.resolution_px_b].max_rows*=2,t.request_draw({clear_tile_cache:!0})},hide:!0}]),copy:function(t){var e=this.to_dict();_(e,{data_manager:this.data_manager});var i=new this.constructor(this.view,t,e);return i.change_mode(this.mode),i.enabled=this.enabled,i},set_filters_manager:function(t){this.filters_manager=t,this.header_div.after(this.filters_manager.parent_div)},to_dict:function(){return{track_type:this.get_type(),dataset:{id:this.dataset.id,hda_ldda:this.dataset.get("hda_ldda")},prefs:this.config.to_key_value_dict(),mode:this.mode,filters:this.filters_manager.to_dict(),tool_state:this.tool?this.tool.state_dict():{}}},set_min_max:function(){var t=this;return s.getJSON(t.dataset.url(),{data_type:"data",stats:!0,chrom:t.view.chrom,low:0,high:t.view.max_high,hda_ldda:t.dataset.get("hda_ldda")},function(e){var i=e.data;if(isNaN(parseFloat(t.config.get_value("min_value")))||isNaN(parseFloat(t.config.get_value("max_value")))){var a=i.min,n=i.max;a=Math.floor(Math.min(0,Math.max(a,i.mean-2*i.sd))),n=Math.ceil(Math.max(0,Math.min(n,i.mean+2*i.sd))),t.config.set_value("min_value",a),t.config.set_value("max_value",n)}})},change_mode:function(t){var e=this;return e.mode=t,e.config.set_value("mode",t),"Auto"===t&&this.data_manager.clear(),e.request_draw({clear_tile_cache:!0}),this.action_icons.mode_icon.attr("title","Set display mode (now: "+e.mode+")"),e},update_icons:function(){var t=this;t.action_icons.filters_icon.toggle(t.filters_available),t.action_icons.tools_icon.toggle(null!==t.tool),t.action_icons.param_space_viz_icon.toggle(null!==t.tool)},_gen_tile_cache_key:function(t,e){return t+"_"+e},request_draw:function(t){t&&t.clear_tile_cache&&this.tile_cache.clear(),this.view.request_redraw(t,this)},before_draw:function(){this.max_height_px=0},_draw:function(i){if(this.can_draw()){var a=i&&i.clear_after,n=this.view.low,r=this.view.high,o=this.view.container.width(),l=this.view.resolution_px_b,h=1/l;this.is_overview&&(n=this.view.max_low,r=this.view.max_high,l=o/(view.max_high-view.max_low),h=1/l),this.before_draw(),this.tiles_div.children().addClass("remove");for(var d,c,u=Math.floor(x*h),g=Math.floor(n/u),f=[],_=[];g*u<r;)d=new e.GenomeRegion({chrom:this.view.chrom,start:g*u,end:Math.min((g+1)*u,this.view.max_high)}),c=this.draw_helper(d,l,i),f.push(c),s.when(c).then(function(t){_.push(t)}),g+=1;a||this.tiles_div.children(".remove").removeClass("remove").remove();var p=this;s.when.apply(s,f).then(function(){p.tiles_div.children(".remove").remove(),_=t.filter(_,function(t){return null!==t}),0!==_.length&&p.postdraw_actions(_,o,l,a)})}},_add_yaxis_label:function(t,e){var i=this,a="max"===t?"top":"bottom",n="max"===t?"max":"min",r="max"===t?"max_value":"min_value",o=this.container_div.find(".yaxislabel."+a),l=g(i.config.get_value(r),1);e=e||function(){i.request_draw({clear_tile_cache:!0})},0!==o.length?o.text(l):(o=s("<div/>").text(l).make_text_editable({num_cols:12,on_finish:function(t){s(".tooltip").remove(),i.config.set_value(r,g(t,1)),e()},help_text:"Set "+n+" value"}).addClass("yaxislabel "+a).css("color",this.config.get_value("label_color")),this.container_div.prepend(o))},postdraw_actions:function(e,i,a,n){var s=t.filter(e,function(t){return t instanceof L});if(s.length>0){this.max_height_px=0;var r=this;t.each(e,function(t){t instanceof L||(t.html_elt.remove(),r.draw_helper(t.region,a,{force:!0,mode:"Coverage"}))}),r._add_yaxis_label("max")}else{this.container_div.find(".yaxislabel").remove();var o=t.find(e,function(t){return t.has_icons});o&&t.each(e,function(t){t.has_icons||t.html_elt.css("padding-top",b)})}},get_mode:function(t){return this.mode},update_auto_mode:function(t){},_get_drawables:function(){return[this]},draw_helper:function(e,i,n){n||(n={});var r=n.force,o=n.mode||this.mode,l=1/i,h=this,d=this._get_drawables(),c=this._gen_tile_cache_key(i,e),u=function(t){return t&&"track"in t},g=r?void 0:h.tile_cache.get_elt(c);if(g)return u(g)&&h.show_tile(g,i),g;if(n.data_fetch===!1)return null;var f=function(){var i=t.find(M,function(t){return t===o})?"Coverage":o,a=t.map(d,function(t){return t.data_manager.get_data(e,i,l,h.data_url_extra_params)});return view.reference_track&&a.push(view.reference_track.data_manager.get_data(e,o,l,view.reference_track.data_url_extra_params)),a},_=s.Deferred();return h.tile_cache.set_elt(c,_),s.when.apply(s,f()).then(function(){var r,o=f(),l=o;if(t.find(o,function(t){return a.is_deferred(t)}))return h.tile_cache.set_elt(c,void 0),void s.when(h.draw_helper(e,i,n)).then(function(t){_.resolve(t)});view.reference_track&&(r=view.reference_track.data_manager.subset_entry(o.pop(),e));var u=[],g=[];t.each(d,function(t,e){var a=t.mode,n=l[e];"Auto"===a&&(a=t.get_mode(n),t.update_auto_mode(a)),u.push(a),g.push(t.get_canvas_height(n,a,i,w))});var p,v=h.view.canvas_manager.new_canvas(),m=e.get("start"),b=e.get("end"),w=Math.ceil((b-m)*i)+h.left_offset,y=t.max(g);v.width=w,v.height=n.height||y;var x=v.getContext("2d");x.translate(h.left_offset,0),d.length>1&&(x.globalAlpha=.5,x.globalCompositeOperation="source-over"),t.each(d,function(t,a){p=t.draw_tile(l[a],x,u[a],e,i,r)}),void 0!==p&&(h.tile_cache.set_elt(c,p),h.show_tile(p,i)),_.resolve(p)}),_},get_canvas_height:function(t,e,i,a){return this.visible_height_px},_draw_line_track_tile:function(e,i,a,n,s){[void 0,null].indexOf(this.config.get_value("min_value"))!==-1&&this.config.set_value("min_value",0),[void 0,null,0].indexOf(this.config.get_value("max_value"))!==-1&&this.config.set_value("max_value",t.max(t.map(e.data,function(t){return t[1]}))||0);var r=i.canvas,l=new o.LinePainter(e.data,n.get("start"),n.get("end"),this.config.to_key_value_dict(),a);return l.draw(i,r.width,r.height,s),new L(this,n,s,r,e.data)},draw_tile:function(t,e,i,a,n,s){},show_tile:function(t,e){var i=t.html_elt;t.predisplay_actions();var a=Math.round((t.low-(this.is_overview?this.view.max_low:this.view.low))*e);this.left_offset&&(a-=this.left_offset),i.css("left",a),i.hasClass("remove")?i.removeClass("remove"):this.tiles_div.append(i),i.css("height","auto"),this.max_height_px=Math.max(this.max_height_px,i.height()-2),i.parent().children().css("height",this.max_height_px+"px");var n=this.max_height_px;0!==this.visible_height_px&&(n=Math.min(this.max_height_px,this.visible_height_px)),this.tiles_div.css("height",n+"px")},tool_region_and_parameters_str:function(e){var i=this,a=void 0!==e?e.toString():"all",n=t.values(i.tool.get_inputs_dict()).join(", ");return" - region=["+a+"], parameters=["+n+"]"},data_and_mode_compatible:function(t,e){return"Auto"===e||("Coverage"===e?"bigwig"===t.dataset_type:"bigwig"!==t.dataset_type&&"no_detail"!==t.extra_info)},can_subset:function(t){return!t.message&&"no_detail"!==t.extra_info&&("bigwig"!==t.dataset_type||t.data[1][0]-t.data[0][0]===1)},init_for_tool_data:function(){this.data_manager.set("data_type","raw_data"),this.data_query_wait=1e3,this.dataset_check_type="state"}});var H=function(t,e){F.call(this,t,e,{resize:!1,header:!1}),this.container_div.addClass("label-track")};_(H.prototype,F.prototype,{init:function(){this.enabled=!0},predraw_init:function(){},_draw:function(t){for(var e=this.view,i=e.high-e.low,n=Math.floor(Math.pow(10,Math.floor(Math.log(i)/Math.log(10)))),r=Math.floor(e.low/n)*n,o=this.view.container.width(),l=s("<div/>").addClass("label-container");r<e.high;){var h=Math.floor((r-e.low)/i*o);l.append(s("<div/>").addClass("pos-label").text(a.commatize(r)).css({left:h})),r+=n}this.content_div.children(":first").remove(),this.content_div.append(l)}});var U=function(e,i,a){if(j.call(this,e,i,a),this.drawables=[],"drawables"in a){for(var n,s=0;s<a.drawables.length;s++)n=a.drawables[s],this.drawables[s]=et(n,e,null),n.left_offset>this.left_offset&&(this.left_offset=n.left_offset);this.enabled=!0}t.each(this.drawables,function(t){(t instanceof X||t instanceof Q)&&t.change_mode("Coverage")}),this.update_icons(),this.obj_type="CompositeTrack"};_(U.prototype,j.prototype,{display_modes:M,config_params:t.union(I.prototype.config_params,[{key:"min_value",label:"Min Value",type:"float",default_value:void 0},{key:"max_value",label:"Max Value",type:"float",default_value:void 0},{key:"mode",type:"string",default_value:this.mode,hidden:!0},{key:"height",type:"int",default_value:30,hidden:!0}]),action_icons_def:[{name:"composite_icon",title:"Show individual tracks",css_class:"layers-stack",on_click_fn:function(t){s(".tooltip").remove(),t.show_group()}}].concat(j.prototype.action_icons_def),to_dict:D.prototype.to_dict,add_drawable:D.prototype.add_drawable,unpack_drawables:D.prototype.unpack_drawables,config_onchange:function(){this.set_name(this.config.get_value("name")),this.request_draw({clear_tile_cache:!0})},on_resize:function(){var e=this.visible_height_px;t.each(this.drawables,function(t){t.visible_height_px=e}),F.prototype.on_resize.call(this)},change_mode:function(t){j.prototype.change_mode.call(this,t);for(var e=0;e<this.drawables.length;e++)this.drawables[e].change_mode(t)},init:function(){for(var t=[],e=0;e<this.drawables.length;e++)t.push(this.drawables[e].init());var i=this;s.when.apply(s,t).then(function(){i.enabled=!0,i.request_draw()})},update_icons:function(){this.action_icons.filters_icon.hide(),this.action_icons.tools_icon.hide(),this.action_icons.param_space_viz_icon.hide()},can_draw:I.prototype.can_draw,_get_drawables:function(){return this.drawables},show_group:function(){for(var t,e=new V(this.view,this.container,{name:this.config.get_value("name")}),i=0;i<this.drawables.length;i++)t=this.drawables[i],t.update_icons(),e.add_drawable(t),t.container=e,e.content_div.append(t.container_div);this.container.replace_drawable(this,e,!0);e.request_draw({clear_tile_cache:!0})},before_draw:function(){var e=t.min(t.map(this.drawables,function(t){return t.config.get_value("min_value")})),i=t.max(t.map(this.drawables,function(t){return t.config.get_value("max_value")}));this.config.set_value("min_value",e),this.config.set_value("max_value",i),t.each(this.drawables,function(t){t.config.set_value("min_value",e),t.config.set_value("max_value",i)})},update_all_min_max:function(){var e=this.config.get_value("min_value"),i=this.config.get_value("max_value");t.each(this.drawables,function(t){t.config.set_value("min_value",e),t.config.set_value("max_value",i)}),this.request_draw({clear_tile_cache:!0})},postdraw_actions:function(t,e,i,a){var n,s=-1;for(n=0;n<t.length;n++){var r=t[n].html_elt.find("canvas").height();r>s&&(s=r)}for(n=0;n<t.length;n++){var o=t[n];o.html_elt.find("canvas").height()!==s&&(this.draw_helper(o.region,i,{force:!0,height:s}),o.html_elt.remove())}var l=this,h=function(){l.update_all_min_max()};this._add_yaxis_label("min",h),this._add_yaxis_label("max",h)}});var K=function(t){j.call(this,t,{content_div:t.top_labeltrack},{resize:!1,header:!1}),this.left_offset=t.canvas_manager.char_width_px,this.container_div.addClass("reference-track"),this.data_url=Galaxy.root+"api/genomes/"+this.view.dbkey,this.data_url_extra_params={reference:!0},this.data_manager=new e.GenomeReferenceDataManager({data_url:this.data_url,can_subset:this.can_subset}),this.hide_contents()};_(K.prototype,I.prototype,j.prototype,{config_params:t.union(I.prototype.config_params,[{key:"height",type:"int",default_value:13,hidden:!0}]),init:function(){this.data_manager.clear(),this.enabled=!0},predraw_init:function(){},can_draw:I.prototype.can_draw,draw_helper:function(t,e,i){var a,n=this.tiles_div.is(":visible"),s=null;return e>this.view.canvas_manager.char_width_px?(this.tiles_div.show(),a=!0,s=j.prototype.draw_helper.call(this,t,e,i)):(a=!1,this.tiles_div.hide()),n!==a&&this.view.resize_viewport(),s},can_subset:function(t){return!0},draw_tile:function(t,e,i,a,n){var s=this.data_manager.subset_entry(t,a),r=s.data,o=e.canvas;e.font=e.canvas.manager.default_font,e.textAlign="center";for(var l=0,h=r.length;l<h;l++)e.fillStyle=this.view.get_base_color(r[l]),e.fillText(r[l],Math.floor(l*n),10);return new B(this,a,n,o,s)}});var J=function(t,e,i){this.mode="Histogram",j.call(this,t,e,i),this.left_offset=30;var a=this;s.when(f(Galaxy.root+"datasets/"+this.dataset.id+"/display")).then(function(t){t&&(a.data_manager=new u.BBIDataManager({dataset:a.dataset}))})};_(J.prototype,I.prototype,j.prototype,{display_modes:M,config_params:t.union(I.prototype.config_params,[{key:"color",label:"Color",type:"color"},{key:"min_value",label:"Min Value",type:"float",default_value:void 0},{key:"max_value",label:"Max Value",type:"float",default_value:void 0},{key:"mode",type:"string",default_value:this.mode,hidden:!0},{key:"height",type:"int",default_value:30,hidden:!0}]),config_onchange:function(){this.set_name(this.config.get_value("name")),this.request_draw({clear_tile_cache:!0})},before_draw:function(){},draw_tile:function(t,e,i,a,n){return this._draw_line_track_tile(t,e,i,a,n)},can_subset:function(t){return t.data[1][0]-t.data[0][0]===1},postdraw_actions:function(t,e,i,a){this._add_yaxis_label("max"),this._add_yaxis_label("min")}});var W=function(t,e,i){this.mode="Heatmap",j.call(this,t,e,i)};_(W.prototype,I.prototype,j.prototype,{display_modes:["Heatmap"],config_params:t.union(I.prototype.config_params,[{key:"pos_color",label:"Positive Color",type:"color",default_value:"#FF8C00"},{key:"neg_color",label:"Negative Color",type:"color",default_value:"#4169E1"},{key:"min_value",label:"Min Value",type:"int",default_value:void 0},{key:"max_value",label:"Max Value",type:"int",default_value:void 0},{key:"mode",type:"string",default_value:this.mode,hidden:!0},{key:"height",type:"int",default_value:500,hidden:!0}]),config_onchange:function(){this.set_name(this.config.get_value("name")),this.request_draw({clear_tile_cache:!0})},predraw_init:function(){var t=this;return s.getJSON(t.dataset.url(),{data_type:"data",stats:!0,chrom:t.view.chrom,low:0,high:t.view.max_high,hda_ldda:t.dataset.get("hda_ldda")},function(t){t.data})},draw_tile:function(t,e,i,a,n){var s=e.canvas,r=new o.DiagonalHeatmapPainter(t.data,a.get("start"),a.get("end"),this.config.to_key_value_dict(),i);return r.draw(e,s.width,s.height,n),new B(this,a,n,s,t.data)}});var X=function(t,e,i){j.call(this,t,e,i),this.container_div.addClass("feature-track"),this.summary_draw_height=30,this.slotters={},this.start_end_dct={},this.left_offset=200,this.set_painter_from_config()};_(X.prototype,I.prototype,j.prototype,{display_modes:["Auto","Coverage","Dense","Squish","Pack"],config_params:t.union(I.prototype.config_params,[{key:"block_color",label:"Block color",type:"color"},{key:"reverse_strand_color",label:"Antisense strand color",type:"color"},{key:"label_color",label:"Label color",type:"color",default_value:"black"},{key:"show_counts",label:"Show summary counts",type:"bool",default_value:!0,help:"Show the number of items in each bin when drawing summary histogram"},{key:"min_value",label:"Histogram minimum",type:"float",default_value:void 0,help:"clear value to set automatically"},{key:"max_value",label:"Histogram maximum",type:"float",default_value:void 0,help:"clear value to set automatically"},{key:"connector_style",label:"Connector style",type:"select",default_value:"fishbones",options:[{label:"Line with arrows",value:"fishbone"},{label:"Arcs",value:"arcs"}]},{key:"mode",type:"string",default_value:this.mode,hidden:!0},{key:"height",type:"int",default_value:0,hidden:!0}]),config_onchange:function(){this.set_name(this.config.get_value("name")),this.set_painter_from_config(),this.request_draw({clear_tile_cache:!0})},set_painter_from_config:function(){"arcs"===this.config.get_value("connector_style")?this.painter=o.ArcLinkedFeaturePainter:this.painter=o.LinkedFeaturePainter},postdraw_actions:function(e,i,a,n){j.prototype.postdraw_actions.call(this,e,i,a,n);var r,o=this,l=t.filter(e,function(t){return t instanceof L});if(0===l.length){var h={};t.each(t.pluck(e,"incomplete_features"),function(e){t.each(e,function(t){h[t[0]]=t})});var d=this;t.each(e,function(e){var i=t.omit(h,t.map(e.incomplete_features,function(t){return t[0]}));if(i=t.omit(i,t.keys(e.other_tiles_features_drawn)),0!==t.size(i)){var a={data:t.values(i)},n=d.view.canvas_manager.new_canvas(),r=n.getContext("2d");n.height=Math.max(e.canvas.height,d.get_canvas_height(a,e.mode,e.w_scale,100)),n.width=e.canvas.width,r.drawImage(e.canvas,0,0),r.translate(o.left_offset,0);var l=d.draw_tile(a,r,e.mode,e.region,e.w_scale,e.seq_data);s(e.canvas).replaceWith(s(l.canvas)),e.canvas=n,t.extend(e.other_tiles_features_drawn,h)}})}if(o.filters_manager){var c,u=o.filters_manager.filters;for(c=0;c<u.length;c++)u[c].update_ui_elt();var g,f,_=!1;for(r=0;r<e.length;r++)if(e[r].data.length)for(g=e[r].data[0],c=0;c<u.length;c++)if(f=u[c],f.applies_to(g)&&f.min!==f.max){_=!0;break}o.filters_available!==_&&(o.filters_available=_,o.filters_available||o.filters_manager.hide(),o.update_icons())}if(e[0]instanceof Y){var p=!0;for(r=0;r<e.length;r++)if(!e[r].all_slotted){p=!1;break}this.action_icons.show_more_rows_icon.toggle(!p)}else this.action_icons.show_more_rows_icon.hide()},update_auto_mode:function(t){"Auto"===this.mode&&("no_detail"===t&&(t="feature spans"),this.action_icons.mode_icon.attr("title","Set display mode (now: Auto/"+t+")"))},incremental_slots:function(t,e,i){var a=this.view.canvas_manager.dummy_context,s=this.slotters[t];return s&&s.mode===i||(s=new n.FeatureSlotter(t,i,w,function(t){return a.measureText(t)}),this.slotters[t]=s),s.slot_features(e)},get_mode:function(t){var e;return e="no_detail"===t.extra_info||this.is_overview?"no_detail":this.view.high-this.view.low>y?"Squish":"Pack"},get_canvas_height:function(t,e,i,a){if("Coverage"===e||"bigwig"===t.dataset_type)return this.summary_draw_height;var n=this.incremental_slots(i,t.data,e),s=new this.painter(null,null,null,this.config.to_key_value_dict(),e);return Math.max(this.min_height_px,s.get_required_height(n,a))},draw_tile:function(t,e,i,a,n,s,r){var o=this,l=e.canvas,h=a.get("start"),d=a.get("end"),c=this.left_offset;if("bigwig"===t.dataset_type)return this._draw_line_track_tile(t,e,i,a,n);var u=[],g=this.slotters[n].slots,f=!0;if(t.data)for(var _=this.filters_manager.filters,p=0,v=t.data.length;p<v;p++){for(var m,b=t.data[p],w=!1,y=0,x=_.length;y<x;y++)if(m=_[y],m.update_attrs(b),!m.keep(b)){w=!0;break}w||(u.push(b),b[0]in g||(f=!1))}var k=this.filters_manager.alpha_filter?new P(this.filters_manager.alpha_filter):null,C=this.filters_manager.height_filter?new P(this.filters_manager.height_filter):null,T=new this.painter(u,h,d,this.config.to_key_value_dict(),i,k,C,s,function(t){return o.view.get_base_color(t)}),$=null;if(e.fillStyle=this.config.get_value("block_color"),e.font=e.canvas.manager.default_font,e.textAlign="right",t.data){var S=T.draw(e,l.width,l.height,n,g);$=S.feature_mapper,incomplete_features=S.incomplete_features,$.translation=-c}return r?void 0:new Y(o,a,n,l,t.data,i,t.message,f,$,incomplete_features,s)}});var Z=function(t,e,i){j.call(this,t,e,i),this.painter=o.VariantPainter,this.summary_draw_height=30,this.left_offset=30};_(Z.prototype,I.prototype,j.prototype,{display_modes:["Auto","Coverage","Dense","Squish","Pack"],config_params:t.union(I.prototype.config_params,[{key:"color",label:"Histogram color",type:"color"},{key:"show_sample_data",label:"Show sample data",type:"bool",default_value:!0},{key:"show_labels",label:"Show summary and sample labels",type:"bool",default_value:!0},{key:"summary_height",label:"Locus summary height",type:"float",default_value:20},{key:"mode",type:"string",default_value:this.mode,hidden:!0},{key:"height",type:"int",default_value:0,hidden:!0}]),config_onchange:function(){this.set_name(this.config.get_value("name")),this.request_draw({clear_tile_cache:!0})},draw_tile:function(t,e,i,a,n){if("bigwig"===t.dataset_type)return this._draw_line_track_tile(t,e,"Histogram",a,n);var s=this.view,r=new this.painter(t.data,a.get("start"),a.get("end"),this.config.to_key_value_dict(),i,function(t){return s.get_base_color(t)});return r.draw(e,e.canvas.width,e.canvas.height,n),new B(this,a,n,e.canvas,t.data)},get_canvas_height:function(t,e,i,a){if("bigwig"===t.dataset_type)return this.summary_draw_height;var n=this.dataset.get_metadata("sample_names")?this.dataset.get_metadata("sample_names").length:0;0===n&&0!==t.data.length&&(n=t.data[0][7].match(/,/g),n=null===n?1:n.length+1);var s=new this.painter(null,null,null,this.config.to_key_value_dict(),e);return s.get_required_height(n)},predraw_init:function(){var t=[F.prototype.predraw_init.call(this)];return this.dataset.get_metadata("sample_names")||t.push(this.dataset.fetch()),t},postdraw_actions:function(e,i,a,n){j.prototype.postdraw_actions.call(this,e,i,a,n);var r=t.filter(e,function(t){return t instanceof L}),o=this.dataset.get_metadata("sample_names");if(0===r.length&&this.config.get_value("show_labels")&&o&&o.length>1){var l;if(0===this.container_div.find(".yaxislabel.variant").length&&(l=this.config.get_value("summary_height")/2,this.tiles_div.prepend(s("<div/>").text("Summary").addClass("yaxislabel variant top").css({"font-size":l+"px",top:(this.config.get_value("summary_height")-l)/2+"px"})),this.config.get_value("show_sample_data"))){var h=o.join("<br/>");this.tiles_div.prepend(s("<div/>").html(h).addClass("yaxislabel variant top sample").css({top:this.config.get_value("summary_height")}))}l=("Squish"===this.mode?5:10)+"px",s(this.tiles_div).find(".sample").css({"font-size":l,"line-height":l}),s(this.tiles_div).find(".yaxislabel").css("color",this.config.get_value("label_color"))}else this.container_div.find(".yaxislabel.variant").remove()}});var Q=function(t,e,i){X.call(this,t,e,i),this.painter=o.ReadPainter,this.update_icons()};_(Q.prototype,I.prototype,j.prototype,X.prototype,{config_params:t.union(I.prototype.config_params,[{key:"block_color",label:"Histogram color",type:"color"},{key:"detail_block_color",label:"Sense strand block color",type:"color",default_value:"#AAAAAA"},{key:"reverse_strand_color",label:"Antisense strand block color",type:"color",default_value:"#DDDDDD"},{key:"label_color",label:"Label color",type:"color",default_value:"black"},{key:"show_insertions",label:"Show insertions",type:"bool",default_value:!1},{key:"show_differences",label:"Show differences only",type:"bool",default_value:!0},{key:"show_counts",label:"Show summary counts",type:"bool",default_value:!0},{key:"mode",type:"string",default_value:this.mode,hidden:!0},{key:"min_value",label:"Histogram minimum",type:"float",default_value:void 0,help:"clear value to set automatically"},{key:"max_value",label:"Histogram maximum",type:"float",default_value:void 0,help:"clear value to set automatically"},{key:"height",type:"int",default_value:0,hidden:!0}]),config_onchange:function(){this.set_name(this.config.get_value("name")),this.request_draw({clear_tile_cache:!0})}});var tt={CompositeTrack:U,DrawableGroup:V,DiagonalHeatmapTrack:W,FeatureTrack:X,LineTrack:J,ReadTrack:Q,VariantTrack:Z,VcfTrack:Z},et=function(t,e,i){if("copy"in t)return t.copy(i);var a=t.obj_type;return a||(a=t.track_type),new tt[a](e,i,t)};return{TracksterView:O,DrawableGroup:V,LineTrack:J,FeatureTrack:X,DiagonalHeatmapTrack:W,ReadTrack:Q,VariantTrack:Z,CompositeTrack:U,object_from_template:et}}.apply(e,a),!(void 0!==n&&(t.exports=n))}).call(e,i(1),i(2))},function(t,e,i){var a,n;(function(s,r){a=[i(3)],n=function(t){var e=s.View.extend({className:"track-header",initialize:function(){this.model.config.get("name").on("change:value",this.update_name,this),this.render()},render:function(){this.$el.append(r("<div/>").addClass(this.model.drag_handle_class)),this.$el.append(r("<div/>").addClass("track-name").text(this.model.config.get_value("name"))),this.action_icons={},this.render_action_icons(),this.$el.dblclick(function(t){t.stopPropagation()}),this.$el.append(r("<div style='clear: both'/>"))},update_name:function(){this.$el.find(".track-name").text(this.model.config.get_value("name"))},render_action_icons:function(){var e=this;this.icons_div=r("<div/>").addClass("track-icons").hide().appendTo(this.$el),t.each(this.model.action_icons_def,function(t){e.add_action_icon(t.name,t.title,t.css_class,t.on_click_fn,t.prepend,t.hide)}),this.set_display_modes(this.model.display_modes)},add_action_icon:function(t,e,i,a,n,s){var o=this;this.action_icons[t]=r("<a/>").attr("title",e).addClass("icon-button").addClass(i).tooltip().click(function(){a(o.model)}).appendTo(this.icons_div),s&&this.action_icons[t].hide()},set_display_modes:function(t,e){if(t){this.model.display_modes=t,
this.model.mode=e||this.model.config.get_value("mode")||this.model.display_modes[0],this.action_icons.mode_icon.attr("title","Set display mode (now: "+this.mode+")");for(var i=this.model,a={},n=0,s=i.display_modes.length;n<s;n++){var r=i.display_modes[n];a[r]=function(t){return function(){i.change_mode(t)}}(r)}make_popupmenu(this.action_icons.mode_icon,a)}}});return{TrackHeaderView:e}}.apply(e,a),!(void 0!==n&&(t.exports=n))}).call(e,i(2),i(1))}]);
//# sourceMappingURL=0.0.bundled.js.map